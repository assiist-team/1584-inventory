{"version":3,"file":"EditBusinessInventoryTransaction.js","sources":["../../src/pages/EditBusinessInventoryTransaction.tsx"],"sourcesContent":["import { useState, useEffect, useMemo } from 'react'\nimport { useParams, useNavigate, Link, useLocation } from 'react-router-dom'\nimport { ArrowLeft, Save, X } from 'lucide-react'\nimport { Transaction, Project, TaxPreset } from '@/types'\nimport { transactionService, projectService } from '@/services/inventoryService'\nimport { toDateOnlyString } from '@/utils/dateUtils'\nimport { TRANSACTION_SOURCES } from '@/constants/transactionSources'\nimport { CLIENT_OWES_COMPANY, COMPANY_OWES_CLIENT } from '@/constants/company'\nimport { getTaxPresets } from '@/services/taxPresetsService'\nimport { useAccount } from '@/contexts/AccountContext'\n\nexport default function EditBusinessInventoryTransaction() {\n  const { projectId, transactionId } = useParams<{ projectId: string; transactionId: string }>()\n  const navigate = useNavigate()\n  const location = useLocation()\n  const { currentAccountId } = useAccount()\n  const [isLoading, setIsLoading] = useState(true)\n  const [isSubmitting, setIsSubmitting] = useState(false)\n  const [projects, setProjects] = useState<Project[]>([])\n  const [transaction, setTransaction] = useState<Transaction | null>(null)\n  const [formData, setFormData] = useState({\n    projectId: '',\n    transactionDate: '',\n    source: '',\n    transactionType: 'Purchase',\n    paymentMethod: 'Pending',\n    amount: '',\n    budgetCategory: 'Furnishings',\n    notes: '',\n    status: 'pending' as 'pending' | 'completed' | 'canceled',\n    reimbursementType: '' as '' | typeof CLIENT_OWES_COMPANY | typeof COMPANY_OWES_CLIENT | null | undefined,\n    triggerEvent: 'Manual' as 'Inventory allocation' | 'Inventory return' | 'Inventory sale' | 'Purchase from client' | 'Manual',\n    receiptEmailed: false\n  })\n  const [formErrors, setFormErrors] = useState<Record<string, string>>({})\n  const [isCustomSource, setIsCustomSource] = useState(false)\n\n  // Tax form state\n  const [taxRatePreset, setTaxRatePreset] = useState<string | undefined>(undefined)\n  const [subtotal, setSubtotal] = useState<string>('')\n  const [taxPresets, setTaxPresets] = useState<TaxPreset[]>([])\n  const [selectedPresetRate, setSelectedPresetRate] = useState<number | undefined>(undefined)\n\n  // Navigation context logic\n  const backDestination = useMemo(() => {\n    // Check if we have a returnTo parameter\n    const searchParams = new URLSearchParams(location.search)\n    const returnTo = searchParams.get('returnTo')\n    if (returnTo) return returnTo\n\n    // Default fallback\n    return '/business-inventory'\n  }, [location.search])\n\n  // Load tax presets on mount\n  useEffect(() => {\n    const loadPresets = async () => {\n      if (!currentAccountId) return\n      try {\n        const presets = await getTaxPresets(currentAccountId)\n        setTaxPresets(presets)\n      } catch (error) {\n        console.error('Error loading tax presets:', error)\n      }\n    }\n    loadPresets()\n  }, [currentAccountId])\n\n  // Update selected preset rate when preset changes\n  useEffect(() => {\n    if (taxRatePreset && taxRatePreset !== 'Other') {\n      const preset = taxPresets.find(p => p.id === taxRatePreset)\n      setSelectedPresetRate(preset?.rate)\n    } else {\n      setSelectedPresetRate(undefined)\n    }\n    // Clear general error when tax preset changes\n    if (formErrors.general) {\n      setFormErrors(prev => ({ ...prev, general: '' }))\n    }\n  }, [taxRatePreset, taxPresets])\n\n  // Clear general error when subtotal changes\n  useEffect(() => {\n    if (formErrors.general) {\n      setFormErrors(prev => ({ ...prev, general: '' }))\n    }\n  }, [subtotal])\n\n  // Load projects and transaction data\n  useEffect(() => {\n    const loadData = async () => {\n      if (!currentAccountId || !transactionId) return\n      try {\n        const [projectsData, transactionData] = await Promise.all([\n          projectService.getProjects(currentAccountId),\n          transactionService.getTransaction(currentAccountId, projectId || '', transactionId)\n        ])\n\n        setProjects(projectsData)\n\n        if (transactionData) {\n          setTransaction(transactionData)\n          const resolvedSource = transactionData.source || ''\n          // Check if source is custom (not in predefined list)\n          const sourceIsCustom = Boolean(resolvedSource && !TRANSACTION_SOURCES.includes(resolvedSource as any))\n          \n          setFormData({\n            projectId: transactionData.projectId || '',\n            transactionDate: toDateOnlyString(transactionData.transactionDate) || '',\n            source: resolvedSource,\n            transactionType: transactionData.transactionType || 'Purchase',\n            paymentMethod: transactionData.paymentMethod || 'Pending',\n            amount: transactionData.amount,\n            budgetCategory: transactionData.budgetCategory || 'Furnishings',\n            notes: transactionData.notes || '',\n            status: transactionData.status || 'pending',\n            reimbursementType: transactionData.reimbursementType || '',\n            triggerEvent: transactionData.triggerEvent || 'Manual',\n            receiptEmailed: transactionData.receiptEmailed || false\n          })\n\n          // Populate tax fields if present\n          if (transactionData.taxRatePreset) {\n            setTaxRatePreset(transactionData.taxRatePreset)\n          }\n          setSubtotal(transactionData.subtotal || '')\n          \n          setIsCustomSource(sourceIsCustom)\n        }\n      } catch (error) {\n        console.error('Error loading data:', error)\n      } finally {\n        setIsLoading(false)\n      }\n    }\n\n    loadData()\n  }, [projectId, transactionId, currentAccountId])\n\n  const handleInputChange = (field: keyof typeof formData, value: string | boolean) => {\n    setFormData(prev => ({ ...prev, [field]: value }))\n    // Clear error when user starts typing\n    if (formErrors[field]) {\n      setFormErrors(prev => ({ ...prev, [field]: '' }))\n    }\n    // Clear general error when any field changes\n    if (formErrors.general) {\n      setFormErrors(prev => ({ ...prev, general: '' }))\n    }\n  }\n\n  const validateForm = () => {\n    const errors: Record<string, string> = {}\n\n    // Project selection is optional\n    // Transaction date is optional\n\n    if (!formData.source.trim()) {\n      errors.source = 'Source is required'\n    }\n\n    if (!formData.budgetCategory?.trim()) {\n      errors.budgetCategory = 'Budget category is required'\n    }\n\n    if (!formData.amount.trim()) {\n      errors.amount = 'Amount is required'\n    } else if (isNaN(Number(formData.amount)) || Number(formData.amount) <= 0) {\n      errors.amount = 'Amount must be a positive number'\n    }\n\n    // Tax validation for Other\n    if (taxRatePreset === 'Other') {\n      if (!subtotal.trim() || isNaN(Number(subtotal)) || Number(subtotal) <= 0) {\n        errors.general = 'Subtotal must be provided and greater than 0 when Tax Rate Preset is Other.'\n      } else if (Number(formData.amount) < Number(subtotal)) {\n        errors.general = 'Subtotal cannot exceed the total amount.'\n      }\n    }\n\n    setFormErrors(errors)\n    return Object.keys(errors).length === 0\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n\n    if (!projectId || !transactionId || !validateForm()) {\n      return\n    }\n\n    setIsSubmitting(true)\n\n    try {\n      // Determine project_id based on selection\n      const actualProjectId = formData.projectId === 'business-inventory' ? null : formData.projectId\n\n      const updateData: Partial<Transaction> = {\n        ...formData,\n        projectId: actualProjectId,\n        // Include tax fields only when a tax rate preset is explicitly selected.\n        ...(taxRatePreset ? { taxRatePreset: taxRatePreset, subtotal: taxRatePreset === 'Other' ? subtotal : '' } : { subtotal: '' })\n      }\n\n      if (!currentAccountId) {\n        setFormErrors({ general: 'Account ID is required' })\n        setIsSubmitting(false)\n        return\n      }\n      await transactionService.updateTransaction(currentAccountId, actualProjectId || '', transactionId, updateData)\n      navigate(`/business-inventory`)\n    } catch (error) {\n      console.error('Error updating transaction:', error)\n      setFormErrors({ general: 'Error updating transaction. Please try again.' })\n    } finally {\n      setIsSubmitting(false)\n    }\n  }\n\n  const handleCancel = () => {\n    navigate(backDestination)\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"flex justify-center items-center h-32\">\n        <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600\"></div>\n      </div>\n    )\n  }\n\n  if (!transaction) {\n    return (\n      <div className=\"text-center py-12 px-4\">\n        <div className=\"mx-auto h-16 w-16 text-gray-400 -mb-1\">ðŸ§¾</div>\n        <h3 className=\"text-lg font-medium text-gray-900 mb-1\">\n          Transaction not found\n        </h3>\n        <p className=\"text-sm text-gray-500 mb-4\">\n          The transaction you're looking for doesn't exist or has been deleted.\n        </p>\n        <Link\n          to={backDestination}\n          className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700\"\n        >\n          Back to Business Inventory\n        </Link>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"space-y-4\">\n        {/* Back button row */}\n        <div className=\"flex items-center justify-between\">\n          <Link\n            to={backDestination}\n            className=\"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700\"\n          >\n            <ArrowLeft className=\"h-4 w-4 mr-1\" />\n            Back\n          </Link>\n        </div>\n      </div>\n\n      {/* Form */}\n      <div className=\"bg-white shadow rounded-lg\">\n        <div className=\"px-6 py-4 border-b border-gray-200\">\n          <h1 className=\"text-2xl font-bold text-gray-900\">Edit Transaction</h1>\n        </div>\n        <form onSubmit={handleSubmit} className=\"space-y-6 p-6\">\n          {/* General Error Display */}\n          {formErrors.general && (\n            <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n              <div className=\"flex\">\n                <div className=\"ml-3\">\n                  <h3 className=\"text-sm font-medium text-red-800\">Error</h3>\n                  <div className=\"mt-2 text-sm text-red-700\">\n                    <p>{formErrors.general}</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Project Selection */}\n          <div>\n            <label htmlFor=\"projectId\" className=\"block text-sm font-medium text-gray-700\">\n              Project\n            </label>\n            <select\n              id=\"projectId\"\n              value={formData.projectId}\n              onChange={(e) => handleInputChange('projectId', e.target.value)}\n              className={`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${\n                formErrors.projectId ? 'border-red-300' : 'border-gray-300'\n              }`}\n            >\n              <option value=\"\">Select a project...</option>\n              <option value=\"business-inventory\">Business Inventory (No Project)</option>\n              {projects.map((project) => (\n                <option key={project.id} value={project.id}>\n                  {project.name} - {project.clientName}\n                </option>\n              ))}\n            </select>\n            {formErrors.projectId && (\n              <p className=\"mt-1 text-sm text-red-600\">{formErrors.projectId}</p>\n            )}\n          </div>\n\n          {/* Source */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n              Source/Vendor *\n            </label>\n            <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3 mb-3\">\n              {TRANSACTION_SOURCES.map((source) => (\n                <div key={source} className=\"flex items-center\">\n                  <input\n                    type=\"radio\"\n                    id={`source_${source.toLowerCase().replace(/\\s+/g, '_')}`}\n                    name=\"source\"\n                    value={source}\n                    checked={formData.source === source}\n                    onChange={(e) => {\n                      handleInputChange('source', e.target.value)\n                      setIsCustomSource(false)\n                    }}\n                    className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                  />\n                  <label htmlFor={`source_${source.toLowerCase().replace(/\\s+/g, '_')}`} className=\"ml-2 block text-sm text-gray-900\">\n                    {source}\n                  </label>\n                </div>\n              ))}\n            </div>\n            <div className=\"flex items-center\">\n              <input\n                type=\"radio\"\n                id=\"source_custom\"\n                name=\"source\"\n                value=\"custom\"\n                checked={isCustomSource}\n                onChange={() => {\n                  setIsCustomSource(true)\n                  handleInputChange('source', '')\n                }}\n                className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n              />\n              <label htmlFor=\"source_custom\" className=\"ml-2 block text-sm text-gray-900\">\n                Other\n              </label>\n            </div>\n            {isCustomSource && (\n              <input\n                type=\"text\"\n                id=\"source_custom_input\"\n                value={formData.source}\n                onChange={(e) => handleInputChange('source', e.target.value)}\n                placeholder=\"Enter custom source...\"\n                className={`mt-3 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${\n                  formErrors.source ? 'border-red-300' : 'border-gray-300'\n                }`}\n              />\n            )}\n            {formErrors.source && (\n              <p className=\"mt-1 text-sm text-red-600\">{formErrors.source}</p>\n            )}\n          </div>\n\n          {/* Budget Category */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n              Budget Category *\n            </label>\n            <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                  id=\"budget_design_fee\"\n                  name=\"budgetCategory\"\n                  value=\"Design Fee\"\n                  checked={formData.budgetCategory === 'Design Fee'}\n                  onChange={(e) => handleInputChange('budgetCategory', e.target.value)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"budget_design_fee\" className=\"ml-2 block text-sm text-gray-900\">\n                  Design Fee\n                </label>\n              </div>\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                  id=\"budget_furnishings\"\n                  name=\"budgetCategory\"\n                  value=\"Furnishings\"\n                  checked={formData.budgetCategory === 'Furnishings'}\n                  onChange={(e) => handleInputChange('budgetCategory', e.target.value)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"budget_furnishings\" className=\"ml-2 block text-sm text-gray-900\">\n                  Furnishings\n                </label>\n              </div>\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                  id=\"budget_property_management\"\n                  name=\"budgetCategory\"\n                  value=\"Property Management\"\n                  checked={formData.budgetCategory === 'Property Management'}\n                  onChange={(e) => handleInputChange('budgetCategory', e.target.value)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"budget_property_management\" className=\"ml-2 block text-sm text-gray-900\">\n                  Property Management\n                </label>\n              </div>\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                  id=\"budget_kitchen\"\n                  name=\"budgetCategory\"\n                  value=\"Kitchen\"\n                  checked={formData.budgetCategory === 'Kitchen'}\n                  onChange={(e) => handleInputChange('budgetCategory', e.target.value)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"budget_kitchen\" className=\"ml-2 block text-sm text-gray-900\">\n                  Kitchen\n                </label>\n              </div>\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                  id=\"budget_install\"\n                  name=\"budgetCategory\"\n                  value=\"Install\"\n                  checked={formData.budgetCategory === 'Install'}\n                  onChange={(e) => handleInputChange('budgetCategory', e.target.value)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"budget_install\" className=\"ml-2 block text-sm text-gray-900\">\n                  Install\n                </label>\n              </div>\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                  id=\"budget_storage_receiving\"\n                  name=\"budgetCategory\"\n                  value=\"Storage & Receiving\"\n                  checked={formData.budgetCategory === 'Storage & Receiving'}\n                  onChange={(e) => handleInputChange('budgetCategory', e.target.value)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"budget_storage_receiving\" className=\"ml-2 block text-sm text-gray-900\">\n                  Storage & Receiving\n                </label>\n              </div>\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                  id=\"budget_fuel\"\n                  name=\"budgetCategory\"\n                  value=\"Fuel\"\n                  checked={formData.budgetCategory === 'Fuel'}\n                  onChange={(e) => handleInputChange('budgetCategory', e.target.value)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"budget_fuel\" className=\"ml-2 block text-sm text-gray-900\">\n                  Fuel\n                </label>\n              </div>\n            </div>\n            {formErrors.budgetCategory && (\n              <p className=\"mt-1 text-sm text-red-600\">{formErrors.budgetCategory}</p>\n            )}\n          </div>\n\n          {/* Transaction Type */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n              Transaction Type\n            </label>\n            <div className=\"flex items-center space-x-6\">\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                  id=\"type_purchase\"\n                  name=\"transactionType\"\n                  value=\"Purchase\"\n                  checked={formData.transactionType === 'Purchase'}\n                  onChange={(e) => handleInputChange('transactionType', e.target.value)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"type_purchase\" className=\"ml-2 block text-sm text-gray-900\">\n                  Purchase\n                </label>\n              </div>\n              {/* 'Reimbursement' option removed */}\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                  id=\"type_return\"\n                  name=\"transactionType\"\n                  value=\"Return\"\n                  checked={formData.transactionType === 'Return'}\n                  onChange={(e) => handleInputChange('transactionType', e.target.value)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"type_return\" className=\"ml-2 block text-sm text-gray-900\">\n                  Return\n                </label>\n              </div>\n            </div>\n            {formErrors.transactionType && (\n              <p className=\"mt-1 text-sm text-red-600\">{formErrors.transactionType}</p>\n            )}\n          </div>\n\n          {/* Reimbursement Type */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n              Reimbursement Type\n            </label>\n            <p className=\"mb-3 text-xs text-gray-500\">Flags transactions that require reimbursement</p>\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                id=\"reimbursement_none\"\n                  name=\"reimbursementType\"\n                  value=\"\"\n                  checked={!formData.reimbursementType}\n                  onChange={(e) => handleInputChange('reimbursementType', e.target.value)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"reimbursement_none\" className=\"ml-2 block text-sm text-gray-900\">\n                  None\n                </label>\n              </div>\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                  id=\"reimbursement_client_owes\"\n                  name=\"reimbursementType\"\n                  value={CLIENT_OWES_COMPANY}\n                  checked={formData.reimbursementType === CLIENT_OWES_COMPANY}\n                  onChange={(e) => handleInputChange('reimbursementType', e.target.value)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"reimbursement_client_owes\" className=\"ml-2 block text-sm text-gray-900\">\n                  {CLIENT_OWES_COMPANY}\n                </label>\n              </div>\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                  id=\"reimbursement_we_owe\"\n                  name=\"reimbursementType\"\n                  value={COMPANY_OWES_CLIENT}\n                  checked={formData.reimbursementType === COMPANY_OWES_CLIENT}\n                  onChange={(e) => handleInputChange('reimbursementType', e.target.value)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"reimbursement_we_owe\" className=\"ml-2 block text-sm text-gray-900\">\n                  {COMPANY_OWES_CLIENT}\n                </label>\n              </div>\n            </div>\n            {formErrors.reimbursementType && (\n              <p className=\"mt-1 text-sm text-red-600\">{formErrors.reimbursementType}</p>\n            )}\n          </div>\n\n          {/* Receipt Email Copy */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n              Receipt Email Copy\n            </label>\n            <div className=\"flex items-center space-x-6\">\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                id=\"receipt_yes\"\n                  name=\"receiptEmailed\"\n                  checked={formData.receiptEmailed === true}\n                  onChange={() => handleInputChange('receiptEmailed', true)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"receipt_yes\" className=\"ml-2 block text-sm text-gray-900\">\n                  Yes\n                </label>\n              </div>\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                id=\"receipt_no\"\n                  name=\"receiptEmailed\"\n                  checked={formData.receiptEmailed === false}\n                  onChange={() => handleInputChange('receiptEmailed', false)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"receipt_no\" className=\"ml-2 block text-sm text-gray-900\">\n                  No\n                </label>\n              </div>\n            </div>\n          </div>\n\n          {/* Amount */}\n          <div>\n            <label htmlFor=\"amount\" className=\"block text-sm font-medium text-gray-700\">\n              Amount *\n            </label>\n            <div className=\"mt-1 relative rounded-md shadow-sm\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <span className=\"text-gray-500 sm:text-sm\">$</span>\n              </div>\n              <input\n                type=\"text\"\n                id=\"amount\"\n                value={formData.amount}\n                onChange={(e) => handleInputChange('amount', e.target.value)}\n                placeholder=\"0.00\"\n                className={`block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${\n                  formErrors.amount ? 'border-red-300' : 'border-gray-300'\n                }`}\n              />\n            </div>\n            {formErrors.amount && (\n              <p className=\"mt-1 text-sm text-red-600\">{formErrors.amount}</p>\n            )}\n          </div>\n\n          {/* Tax Rate Presets */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-3\">Tax Rate Preset</label>\n            <div className=\"space-y-2\">\n              {taxPresets.map((preset) => (\n                <div key={preset.id} className=\"flex items-center\">\n                  <input\n                    type=\"radio\"\n                    id={`tax_preset_${preset.id}`}\n                    name=\"taxRatePreset\"\n                    value={preset.id}\n                    checked={taxRatePreset === preset.id}\n                    onChange={(e) => setTaxRatePreset(e.target.value)}\n                    className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                  />\n                  <label htmlFor={`tax_preset_${preset.id}`} className=\"ml-2 block text-sm text-gray-900\">\n                    {preset.name} ({preset.rate.toFixed(2)}%)\n                  </label>\n                </div>\n              ))}\n              <div className=\"flex items-center\">\n                <input\n                  type=\"radio\"\n                  id=\"tax_preset_other\"\n                  name=\"taxRatePreset\"\n                  value=\"Other\"\n                  checked={taxRatePreset === 'Other'}\n                  onChange={(e) => setTaxRatePreset(e.target.value)}\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\"\n                />\n                <label htmlFor=\"tax_preset_other\" className=\"ml-2 block text-sm text-gray-900\">\n                  Other\n                </label>\n              </div>\n            </div>\n            {/* Show selected tax rate for presets */}\n            {taxRatePreset && taxRatePreset !== 'Other' && selectedPresetRate !== undefined && (\n              <div className=\"mt-3 p-3 bg-gray-50 rounded-md\">\n                <p className=\"text-sm text-gray-700\">\n                  <span className=\"font-medium\">Tax Rate:</span> {selectedPresetRate.toFixed(2)}%\n                </p>\n              </div>\n            )}\n          </div>\n\n          {/* Subtotal (shown only for Other) */}\n          {taxRatePreset === 'Other' && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700\">Subtotal</label>\n              <div className=\"mt-1 relative rounded-md shadow-sm\">\n                <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                  <span className=\"text-gray-500 sm:text-sm\">$</span>\n                </div>\n                <input\n                  type=\"text\"\n                  id=\"subtotal\"\n                  value={subtotal}\n                  onChange={(e) => setSubtotal(e.target.value)}\n                  placeholder=\"0.00\"\n                  className={`block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 border-gray-300`}\n                />\n              </div>\n              <p className=\"mt-1 text-sm text-gray-500\">This will be used to calculate the tax rate.</p>\n            </div>\n          )}\n\n          {/* Transaction Date */}\n          <div>\n            <label htmlFor=\"transactionDate\" className=\"block text-sm font-medium text-gray-700\">\n              Transaction Date\n            </label>\n            <input\n              type=\"date\"\n              id=\"transactionDate\"\n              value={formData.transactionDate}\n              onChange={(e) => handleInputChange('transactionDate', e.target.value)}\n              className={`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${\n                formErrors.transactionDate ? 'border-red-300' : 'border-gray-300'\n              }`}\n            />\n            {formErrors.transactionDate && (\n              <p className=\"mt-1 text-sm text-red-600\">{formErrors.transactionDate}</p>\n            )}\n          </div>\n\n          {/* Notes */}\n          <div>\n            <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700\">\n              Notes\n            </label>\n            <textarea\n              id=\"notes\"\n              rows={3}\n              value={formData.notes}\n              onChange={(e) => handleInputChange('notes', e.target.value)}\n              placeholder=\"Additional notes about this transaction...\"\n              className={`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${\n                formErrors.notes ? 'border-red-300' : 'border-gray-300'\n              }`}\n            />\n            {formErrors.notes && (\n              <p className=\"mt-1 text-sm text-red-600\">{formErrors.notes}</p>\n            )}\n          </div>\n\n          {/* Form Actions - Normal on desktop, hidden on mobile (replaced by sticky bar) */}\n          <div className=\"hidden sm:flex justify-end sm:space-x-3 pt-4\">\n            <button\n              onClick={handleCancel}\n              className=\"inline-flex justify-center items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n            >\n              <X className=\"h-4 w-4 mr-2\" />\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              disabled={isSubmitting}\n              className=\"inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              <Save className=\"h-4 w-4 mr-2\" />\n              {isSubmitting ? 'Updating...' : 'Update'}\n            </button>\n          </div>\n        </form>\n      </div>\n\n      {/* Sticky mobile action bar */}\n      <div className=\"sm:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 z-50\">\n        <div className=\"flex space-x-3\">\n          <button\n            onClick={handleCancel}\n            className=\"flex-1 inline-flex justify-center items-center px-4 py-3 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n          >\n            <X className=\"h-4 w-4 mr-2\" />\n            Cancel\n          </button>\n          <button\n            type=\"submit\"\n            disabled={isSubmitting}\n            onClick={(e) => {\n              // Find the form and submit it\n              const form = e.currentTarget.closest('.space-y-6')?.querySelector('form') as HTMLFormElement\n              if (form) {\n                form.requestSubmit()\n              }\n            }}\n            className=\"flex-1 inline-flex justify-center items-center px-4 py-3 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            <Save className=\"h-4 w-4 mr-2\" />\n            {isSubmitting ? 'Updating...' : 'Update'}\n          </button>\n        </div>\n      </div>\n\n      {/* Add bottom padding to account for sticky bar on mobile */}\n      <div className=\"sm:hidden h-20\"></div>\n    </div>\n  )\n}\n"],"names":["EditBusinessInventoryTransaction","projectId","transactionId","useParams","navigate","useNavigate","location","useLocation","currentAccountId","useAccount","isLoading","setIsLoading","useState","isSubmitting","setIsSubmitting","projects","setProjects","transaction","setTransaction","formData","setFormData","formErrors","setFormErrors","isCustomSource","setIsCustomSource","taxRatePreset","setTaxRatePreset","subtotal","setSubtotal","taxPresets","setTaxPresets","selectedPresetRate","setSelectedPresetRate","backDestination","useMemo","returnTo","useEffect","presets","getTaxPresets","error","preset","p","prev","projectsData","transactionData","projectService","transactionService","resolvedSource","sourceIsCustom","TRANSACTION_SOURCES","toDateOnlyString","handleInputChange","field","value","validateForm","errors","_a","handleSubmit","e","actualProjectId","updateData","handleCancel","jsx","jsxs","Link","ArrowLeft","project","source","CLIENT_OWES_COMPANY","COMPANY_OWES_CLIENT","X","Save","form"],"mappings":"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"}