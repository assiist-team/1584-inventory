import{j as e}from"./index-CX_-pvtV.js";import{u as S,b as I,L as v}from"./router-Bad1IJif.js";import{r as i}from"./vendor-Gm9i_4Ku.js";import{t as T,i as $}from"./inventoryService-DVKkbR7H.js";import{T as j}from"./transactionSources-Bmq7Rv82.js";import{b as F,a as D,l as P}from"./ui-eaT6kZG0.js";import"./firebase-DTZupgGV.js";function U(){const{id:n}=S(),N=I(),[s,p]=i.useState({description:"",source:"",sku:"",price:"",resale_price:"",market_value:"",payment_method:"",disposition:"",notes:"",selectedTransactionId:""}),[x,c]=i.useState(!1),[h,l]=i.useState(!1),[y,_]=i.useState([]),[m,f]=i.useState(!1);i.useEffect(()=>{(async()=>{if(n){f(!0);try{const a=await T.getTransactions(n);_(a)}catch(a){console.error("Error fetching transactions:",a)}finally{f(!1)}}})()},[n]),i.useEffect(()=>{const t=j;s.source&&!t.includes(s.source)?c(!0):s.source&&t.includes(s.source)&&c(!1)},[s.source]),i.useEffect(()=>{const t=["Client Card","1584 Card","Split","Store Credit"];s.payment_method&&!t.includes(s.payment_method)?l(!0):s.payment_method&&t.includes(s.payment_method)&&l(!1)},[s.payment_method]);const[r,d]=i.useState({}),[b,g]=i.useState(!1),k=()=>{const t={};return s.description.trim()||(t.description="Description is required"),s.source.trim()||(t.source="Source is required"),s.payment_method.trim()||(t.payment_method="Payment method is required"),s.disposition.trim()||(t.disposition="Disposition is required"),s.price.trim()?(isNaN(Number(s.price))||Number(s.price)<=0)&&(t.price="Price must be a positive number"):t.price="Price is required",s.market_value.trim()&&(isNaN(Number(s.market_value))||Number(s.market_value)<=0)&&(t.market_value="Market value must be a positive number"),d(t),Object.keys(t).length===0},w=async t=>{if(t.preventDefault(),!(!k()||!n)){g(!0);try{const a={...s,project_id:n,qr_key:`qr_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,bookmark:!1,transaction_id:s.selectedTransactionId||"",date_created:new Date().toISOString(),last_updated:new Date().toISOString()};await $.createItem(n,a),N(`/project/${n}?tab=inventory`)}catch(a){console.error("Error creating item:",a),d({submit:"Failed to create item. Please try again."})}finally{g(!1)}}},o=(t,a)=>{p(u=>({...u,[t]:a})),r[t]&&d(u=>({...u,[t]:""}))},C=t=>{p(a=>({...a,selectedTransactionId:t})),r.selectedTransactionId&&d(a=>({...a,selectedTransactionId:""}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(v,{to:`/project/${n}?tab=inventory`,className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700",children:[e.jsx(F,{className:"h-4 w-4 mr-1"}),"Back"]})})}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Add Item"})}),e.jsxs("form",{onSubmit:w,className:"space-y-8 p-8",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description *"}),e.jsx("input",{type:"text",id:"description",value:s.description,onChange:t=>o("description",t.target.value),placeholder:"e.g., Wooden dining table, 6 chairs",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${r.description?"border-red-300":"border-gray-300"}`}),r.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Source *"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-3",children:j.map(t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:`source_${t.toLowerCase().replace(/\s+/g,"_")}`,name:"source",value:t,checked:s.source===t,onChange:a=>{o("source",a.target.value),c(!1)},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:`source_${t.toLowerCase().replace(/\s+/g,"_")}`,className:"ml-2 block text-sm text-gray-900",children:t})]},t))}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"source_custom",name:"source",value:"custom",checked:x,onChange:()=>{c(!0),o("source","")},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"source_custom",className:"ml-2 block text-sm text-gray-900",children:"Other"})]}),x&&e.jsx("input",{type:"text",id:"source_custom_input",value:s.source,onChange:t=>o("source",t.target.value),placeholder:"Enter custom source...",className:`mt-3 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${r.source?"border-red-300":"border-gray-300"}`}),r.source&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.source})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sku",className:"block text-sm font-medium text-gray-700",children:"SKU"}),e.jsx("input",{type:"text",id:"sku",value:s.sku,onChange:t=>o("sku",t.target.value),placeholder:"Product SKU or model number",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:"Purchase Price *"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"text",id:"price",value:s.price,onChange:t=>o("price",t.target.value),placeholder:"0.00",className:`block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${r.price?"border-red-300":"border-gray-300"}`})]}),r.price&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.price})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"market_value",className:"block text-sm font-medium text-gray-700",children:"Market Value"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"text",id:"market_value",value:s.market_value,onChange:t=>o("market_value",t.target.value),placeholder:"0.00",className:`block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${r.market_value?"border-red-300":"border-gray-300"}`})]}),r.market_value&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.market_value})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"resale_price",className:"block text-sm font-medium text-gray-700",children:"1584 Resale Price"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"text",id:"resale_price",value:s.resale_price,onChange:t=>o("resale_price",t.target.value),placeholder:"0.00",className:"block w-full pl-8 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Payment Method *"}),e.jsx("div",{className:"flex items-center space-x-6 mb-3",children:["Client Card","1584 Card","Split","Store Credit"].map(t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:`payment_${t.toLowerCase().replace(/\s+/g,"_")}`,name:"payment_method",value:t,checked:s.payment_method===t,onChange:a=>{o("payment_method",a.target.value),l(!1)},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:`payment_${t.toLowerCase().replace(/\s+/g,"_")}`,className:"ml-2 block text-sm text-gray-900",children:t})]},t))}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"payment_custom",name:"payment_method",value:"custom",checked:h,onChange:()=>{l(!0),o("payment_method","")},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"payment_custom",className:"ml-2 block text-sm text-gray-900",children:"Other"})]}),h&&e.jsx("input",{type:"text",id:"payment_custom_input",value:s.payment_method,onChange:t=>o("payment_method",t.target.value),placeholder:"Enter custom payment method...",className:`mt-3 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${r.payment_method?"border-red-300":"border-gray-300"}`}),r.payment_method&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.payment_method})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Disposition *"}),e.jsx("div",{className:"flex items-center space-x-6",children:["keep","return","inventory"].map(t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:`disposition_${t.toLowerCase()}`,name:"disposition",value:t,checked:s.disposition===t,onChange:a=>o("disposition",a.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:`disposition_${t.toLowerCase()}`,className:"ml-2 block text-sm text-gray-900",children:t.charAt(0).toUpperCase()+t.slice(1)})]},t))}),r.disposition&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.disposition})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"selectedTransactionId",className:"block text-sm font-medium text-gray-700 mb-3",children:"Associate with Transaction (Optional)"}),e.jsxs("select",{id:"selectedTransactionId",value:s.selectedTransactionId,onChange:t=>C(t.target.value),className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${r.selectedTransactionId?"border-red-300":"border-gray-300"}`,disabled:m,children:[e.jsx("option",{value:"",children:"Select a transaction (optional)"}),m?e.jsx("option",{disabled:!0,children:"Loading transactions..."}):y.map(t=>e.jsxs("option",{value:t.transaction_id,children:[new Date(t.transaction_date).toLocaleDateString()," - ",t.source," - $",t.amount]},t.transaction_id))]}),r.selectedTransactionId&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.selectedTransactionId}),!m&&y.length===0&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No transactions available for this project"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notes"}),e.jsx("textarea",{id:"notes",rows:3,value:s.notes,onChange:t=>o("notes",t.target.value),placeholder:"Additional notes about this item...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"})]}),r.submit&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsx("p",{className:"text-sm text-red-600",children:r.submit})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsxs(v,{to:`/project/${n}?tab=inventory`,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs("button",{type:"submit",disabled:b,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),b?"Creating...":"Create Item"]})]})]})]})]})}export{U as default};
//# sourceMappingURL=AddItem-sUOaxfcI.js.map
