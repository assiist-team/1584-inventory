{"version":3,"file":"ClientSummary.js","sources":["../../src/pages/ClientSummary.tsx"],"sourcesContent":["import { useEffect, useMemo, useState } from 'react'\nimport { useNavigate, useParams, Link } from 'react-router-dom'\nimport { Button } from '@/components/ui/Button'\nimport type { Item, Project, Transaction } from '@/types'\nimport { projectService, transactionService, unifiedItemsService } from '@/services/inventoryService'\nimport { useAccount } from '@/contexts/AccountContext'\nimport { useBusinessProfile } from '@/contexts/BusinessProfileContext'\nimport { CLIENT_OWES_COMPANY, COMPANY_OWES_CLIENT } from '@/constants/company'\n\nconst usd = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' })\n\nfunction toNumber(value: string | number | null | undefined): number {\n  if (typeof value === 'number') return isNaN(value) ? 0 : value\n  if (typeof value === 'string') {\n    const n = parseFloat(value || '0')\n    return isNaN(n) ? 0 : n\n  }\n  return 0\n}\n\nexport default function ClientSummary() {\n  const { id: projectId } = useParams<{ id: string }>()\n  const navigate = useNavigate()\n  const { currentAccountId } = useAccount()\n  const { businessName, businessLogoUrl } = useBusinessProfile()\n\n  const [project, setProject] = useState<Project | null>(null)\n  const [items, setItems] = useState<Item[]>([])\n  const [transactions, setTransactions] = useState<Transaction[]>([])\n  const [isLoading, setIsLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n\n  const today = useMemo(() => new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' }), [])\n\n  useEffect(() => {\n    const load = async () => {\n      if (!projectId || !currentAccountId) {\n        if (!currentAccountId) return // Wait for account to load\n        navigate('/projects')\n        return\n      }\n\n      setIsLoading(true)\n      setError(null)\n      try {\n        const [proj, projectItems, projectTransactions] = await Promise.all([\n          projectService.getProject(currentAccountId, projectId),\n          unifiedItemsService.getItemsByProject(currentAccountId, projectId),\n          transactionService.getTransactions(currentAccountId, projectId)\n        ])\n\n        if (!proj) {\n          navigate('/projects')\n          return\n        }\n\n        setProject(proj)\n        setItems(projectItems)\n        setTransactions(projectTransactions)\n      } catch (e: any) {\n        console.error('Failed to load client summary:', e)\n        setError('Failed to load client summary. Please try again.')\n      } finally {\n        setIsLoading(false)\n      }\n    }\n\n    load()\n  }, [projectId, currentAccountId, navigate])\n\n  // Calculate summary values\n  const summary = useMemo(() => {\n    // Total spent overall (sum of projectPrice for all items)\n    const totalSpent = items.reduce((sum, item) => {\n      const projectPrice = toNumber(item.projectPrice)\n      return sum + projectPrice\n    }, 0)\n\n    // Breakdown by budget categories (sum of item project prices by budgetCategory from their transactions)\n    const categoryBreakdown: Record<string, number> = {}\n    // Create a map of transactionId -> budgetCategory for quick lookup\n    const transactionCategoryMap = new Map<string, string>()\n    transactions.forEach(transaction => {\n      if (transaction.budgetCategory && transaction.transactionId) {\n        transactionCategoryMap.set(transaction.transactionId, transaction.budgetCategory)\n      }\n    })\n    // Sum item project prices by their transaction's budget category\n    items.forEach(item => {\n      if (item.transactionId) {\n        const budgetCategory = transactionCategoryMap.get(item.transactionId)\n        if (budgetCategory) {\n          const projectPrice = toNumber(item.projectPrice)\n          categoryBreakdown[budgetCategory] = (categoryBreakdown[budgetCategory] || 0) + projectPrice\n        }\n      }\n    })\n\n    // Value of furnishings in home (sum of marketValue for all items)\n    const totalMarketValue = items.reduce((sum, item) => {\n      const marketValue = toNumber(item.marketValue)\n      return sum + marketValue\n    }, 0)\n\n    // What they saved (sum of differences between marketValue and projectPrice for each item)\n    // If marketValue is not set, difference is zero\n    const totalSaved = items.reduce((sum, item) => {\n      const marketValue = toNumber(item.marketValue)\n      const projectPrice = toNumber(item.projectPrice)\n      // Only count savings if marketValue is set (greater than 0)\n      if (marketValue > 0) {\n        return sum + (marketValue - projectPrice)\n      }\n      return sum\n    }, 0)\n\n    return {\n      totalSpent,\n      categoryBreakdown,\n      totalMarketValue,\n      totalSaved\n    }\n  }, [items, transactions])\n\n  const handlePrint = () => window.print()\n  const handleBack = () => {\n    if (!projectId) return navigate('/projects')\n    navigate(`/project/${projectId}?tab=inventory`)\n  }\n\n  // Helper to get receipt link for an item.\n  // Behavior:\n  // - If the item has a transactionId, prefer linking to that transaction page.\n  // - If that transaction is canonical/invoiceable (INV_* canonical id or invoiceable reimbursementType),\n  //   use the project invoice as the receipt link instead of the transaction page.\n  // - No fallback searching other transactions for this item ‚Äî return null when no transactionId.\n  const getReceiptLink = (item: Item): { href: string; isInternal: boolean } | null => {\n    if (!projectId) return null\n\n    if (item.transactionId) {\n      const tx = transactions.find((t) => t.transactionId === item.transactionId)\n\n      if (!tx) {\n        return null\n      }\n\n      const isCanonicalById = tx.transactionId?.startsWith('INV_SALE_') || tx.transactionId?.startsWith('INV_PURCHASE_')\n\n      const isInvoiceableByType =\n        tx.reimbursementType === CLIENT_OWES_COMPANY || tx.reimbursementType === COMPANY_OWES_CLIENT\n\n      if (isCanonicalById || isInvoiceableByType) {\n        return { href: `/project/${projectId}/invoice`, isInternal: true }\n      }\n\n      const receiptImageUrl = tx.receiptImages?.[0]?.url\n\n      if (receiptImageUrl) {\n        return { href: receiptImageUrl, isInternal: false }\n      }\n\n      return null\n    }\n\n    // No transactionId -> no receipt link (no fallback)\n    return null\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"flex justify-center items-center h-64\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto\"></div>\n          <p className=\"mt-2 text-sm text-gray-600\">Loading client summary...</p>\n        </div>\n      </div>\n    )\n  }\n\n  if (error) {\n    return (\n      <div className=\"text-center py-12\">\n        <div className=\"mx-auto h-12 w-12 text-red-400\">‚ö†Ô∏è</div>\n        <h3 className=\"mt-2 text-sm font-medium text-gray-900\">Error</h3>\n        <p className=\"mt-1 text-sm text-gray-500\">{error}</p>\n        <div className=\"mt-6\">\n          <Button onClick={handleBack}>Back</Button>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"max-w-4xl mx-auto bg-white shadow rounded-lg p-8 print:shadow-none print:p-0\">\n      {/* Action bar */}\n      <div className=\"flex justify-end space-x-3 mb-6 print:hidden\">\n        <Button variant=\"secondary\" onClick={handleBack}>Back</Button>\n        <Button onClick={handlePrint}>Print</Button>\n      </div>\n\n      {/* Header */}\n      <div className=\"border-b pb-4 mb-6\">\n        <div className=\"flex items-start gap-4\">\n          {businessLogoUrl && (\n            <img\n              src={businessLogoUrl}\n              alt={businessName}\n              className=\"h-24 w-auto object-contain\"\n            />\n          )}\n          <div>\n            <h1 className=\"text-2xl font-bold text-gray-900\">Client Summary</h1>\n            <div className=\"mt-1 text-sm text-gray-600\">\n              <div className=\"font-medium text-gray-800\">{project?.name || 'Project'}</div>\n              {project?.clientName && <div>Client: {project.clientName}</div>}\n              <div>Date: {today}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {items.length === 0 && (\n        <div className=\"text-center py-12\">\n          <div className=\"mx-auto h-12 w-12 text-gray-400\">üì¶</div>\n          <h3 className=\"mt-2 text-sm font-medium text-gray-900\">No items found</h3>\n          <p className=\"mt-1 text-sm text-gray-500\">There are no items associated with this project.</p>\n        </div>\n      )}\n\n      {items.length > 0 && (\n        <div className=\"space-y-6\">\n          {/* Summary Fields */}\n          <section>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {/* Total Spend Card */}\n              <div className=\"rounded-lg border border-gray-100 overflow-hidden\">\n                <div className=\"px-4 py-3 bg-gray-50 border-b border-gray-100\">\n                  <h2 className=\"text-lg font-semibold text-gray-900\">Project Overview</h2>\n                </div>\n                <div className=\"px-4 py-4 space-y-4\">\n                  {/* Total Spent Overall */}\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-base font-medium text-gray-700\">Total Spent Overall</span>\n                    <span className=\"text-base font-semibold text-gray-900\">{usd.format(summary.totalSpent)}</span>\n                  </div>\n\n                  {/* Breakdown by Budget Categories */}\n                  {Object.keys(summary.categoryBreakdown).length > 0 && (\n                    <div className=\"pt-3 border-t border-gray-100\">\n                      <div className=\"space-y-2\">\n                        {Object.entries(summary.categoryBreakdown)\n                          .sort(([a], [b]) => a.localeCompare(b))\n                          .map(([category, amount]) => (\n                            <div key={category} className=\"flex items-center justify-between text-sm\">\n                              <span className=\"text-gray-600\">{category}</span>\n                              <span className=\"text-gray-900 font-medium\">{usd.format(amount)}</span>\n                            </div>\n                          ))}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* Savings Card */}\n              <div className=\"rounded-lg border border-gray-100 overflow-hidden\">\n                <div className=\"px-4 py-3 bg-gray-50 border-b border-gray-100\">\n                  <h2 className=\"text-lg font-semibold text-gray-900\">Furnishing Savings</h2>\n                </div>\n                <div className=\"px-4 py-4 space-y-4\">\n                  {/* Market Value */}\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-base font-medium text-gray-700\">Market Value</span>\n                    <span className=\"text-base font-semibold text-gray-900\">{usd.format(summary.totalMarketValue)}</span>\n                  </div>\n\n                  {/* What They Spent */}\n                  <div className=\"pt-3 border-t border-gray-100\">\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-base font-medium text-gray-700\">What You Spent</span>\n                      <span className=\"text-base font-semibold text-gray-900\">{usd.format(summary.totalSpent)}</span>\n                    </div>\n                  </div>\n\n                  {/* What They Saved */}\n                  <div className=\"pt-3 border-t border-gray-100\">\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-base font-medium text-green-600\">What You Saved</span>\n                      <span className=\"text-base font-semibold text-green-600\">{usd.format(summary.totalSaved)}</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </section>\n\n          {/* Items List */}\n          <section>\n            <div className=\"flex items-baseline justify-between mb-3\">\n              <h2 className=\"text-lg font-semibold text-gray-900\">Furnishings</h2>\n            </div>\n\n            <div className=\"rounded-lg border border-gray-100 overflow-hidden\">\n              <div className=\"divide-y\">\n                {items.map((item) => {\n                  const projectPrice = toNumber(item.projectPrice)\n                  const receiptLink = getReceiptLink(item)\n                  \n                  return (\n                    <div key={item.itemId} className=\"py-2 px-4\">\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex-1\">\n                          <div className=\"text-sm text-gray-900 font-medium\">\n                            {item.description || 'Item'}\n                          </div>\n                          <div className=\"flex items-center gap-2 flex-wrap mt-0.5\">\n                            {item.source && (\n                              <span className=\"text-xs text-gray-500\">Source: {item.source}</span>\n                            )}\n                            {receiptLink && (\n                              <>\n                                {item.source && <span className=\"text-xs text-gray-400\">‚Ä¢</span>}\n                                {receiptLink.isInternal ? (\n                                  <Link\n                                    to={receiptLink.href}\n                                    className=\"text-xs text-primary-600 hover:text-primary-700 underline print:hidden\"\n                                  >\n                                    View Receipt\n                                  </Link>\n                                ) : (\n                                  <a\n                                    href={receiptLink.href}\n                                    target=\"_blank\"\n                                    rel=\"noopener noreferrer\"\n                                    className=\"text-xs text-primary-600 hover:text-primary-700 underline print:hidden\"\n                                  >\n                                    View Receipt\n                                  </a>\n                                )}\n                                <span className=\"text-xs text-primary-600 print:inline hidden\">\n                                  Receipt available\n                                </span>\n                              </>\n                            )}\n                          </div>\n                          {item.space && (\n                            <div className=\"text-xs text-gray-500 mt-0.5\">Space: {item.space}</div>\n                          )}\n                        </div>\n                        <div className=\"text-right ml-4\">\n                          <div className=\"text-sm text-gray-700 font-medium\">\n                            {usd.format(projectPrice)}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  )\n                })}\n              </div>\n              <div className=\"flex items-center justify-between px-4 py-2 bg-white border-t border-gray-100\">\n                <span className=\"text-sm font-semibold text-gray-900\">Furnishings Total</span>\n                <span className=\"text-sm font-semibold text-gray-900\">{usd.format(summary.totalSpent)}</span>\n              </div>\n            </div>\n          </section>\n        </div>\n      )}\n    </div>\n  )\n}\n\n"],"names":["usd","toNumber","value","n","ClientSummary","projectId","useParams","navigate","useNavigate","currentAccountId","useAccount","businessName","businessLogoUrl","useBusinessProfile","project","setProject","useState","items","setItems","transactions","setTransactions","isLoading","setIsLoading","error","setError","today","useMemo","useEffect","proj","projectItems","projectTransactions","projectService","unifiedItemsService","transactionService","e","summary","totalSpent","sum","item","projectPrice","categoryBreakdown","transactionCategoryMap","transaction","budgetCategory","totalMarketValue","marketValue","totalSaved","handlePrint","handleBack","getReceiptLink","tx","t","isCanonicalById","_a","_b","isInvoiceableByType","CLIENT_OWES_COMPANY","COMPANY_OWES_CLIENT","receiptImageUrl","_d","_c","jsxs","jsx","Button","a","b","category","amount","receiptLink","Fragment","Link"],"mappings":"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"}