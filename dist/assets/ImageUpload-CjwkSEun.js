import{j as r}from"./index-DRwKqTma.js";import{r as l}from"./vendor-Gm9i_4Ku.js";import{I as v}from"./imageService-De3eSBgy.js";import{U as F,p as $,A as B,a as R}from"./ui-DKDhksGx.js";function O({onImagesChange:m,maxImages:c=5,acceptedTypes:p=["image/jpeg","image/jpg","image/png","image/gif","image/webp"],maxFileSize:d=10,disabled:o=!1,className:N=""}){const[n,y]=l.useState([]),[f,h]=l.useState(!1),j=l.useRef(null),b=l.useRef(null),k=l.useRef(null),w=l.useCallback(e=>{if(!p.includes(e.type))return`Invalid file type. Please upload: ${p.join(", ")}`;const t=d*1024*1024;return e.size>t?`File too large. Maximum size: ${d}MB`:null},[p,d]),u=l.useCallback(e=>{const t=Array.from(e),i=[],s=[];if(t.forEach(a=>{const g=w(a);g?s.push({file:a,previewUrl:"",error:g}):(i.push(a),s.push({file:a,previewUrl:v.createPreviewUrl(a)}))}),i.length+n.length>c){const a=c-n.length;a>0?(i.splice(a),s.splice(a)):(i.length=0,s.length=0),s.push({file:new File([],""),previewUrl:"",error:`Maximum ${c} images allowed. Additional images were skipped.`})}y(a=>[...a,...s]),m(i)},[n.length,c,w,m]),U=l.useCallback(e=>{const t=n[e];t.previewUrl&&v.revokePreviewUrl(t.previewUrl),y(s=>s.filter((a,g)=>g!==e));const i=n.filter((s,a)=>a!==e).filter(s=>!s.error).map(s=>s.file);m(i)},[n,m]),x=e=>{const t=e.target.files;t&&t.length>0&&u(t)},D=async()=>{try{const e=await v.selectFromGallery();e.length>0&&u(e)}catch(e){console.error("Error selecting from gallery:",e)}},P=l.useCallback(e=>{e.preventDefault(),e.stopPropagation(),o||h(!0)},[o]),C=l.useCallback(e=>{e.preventDefault(),e.stopPropagation(),h(!1)},[]),I=l.useCallback(e=>{if(e.preventDefault(),e.stopPropagation(),h(!1),o)return;const t=e.dataTransfer.files;t&&t.length>0&&u(t)},[o,u]),M=e=>{if(e===0)return"0 Bytes";const t=1024,i=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(e)/Math.log(t));return(e/Math.pow(t,s)).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})+" "+i[s]};return r.jsxs("div",{className:`space-y-4 ${N}`,children:[r.jsxs("div",{className:`relative border-2 border-dashed rounded-lg p-6 sm:p-8 text-center transition-colors touch-manipulation ${f?"border-primary-500 bg-primary-50":"border-gray-300 hover:border-gray-400"} ${o?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,onDragOver:P,onDragLeave:C,onDrop:I,onClick:()=>{var e;return!o&&((e=j.current)==null?void 0:e.click())},children:[r.jsx("input",{ref:j,type:"file",multiple:!0,accept:p.join(","),onChange:x,disabled:o,className:"hidden"}),r.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[r.jsx("div",{className:`p-3 rounded-full ${f?"bg-primary-100":"bg-gray-100"}`,children:r.jsx(F,{className:`h-6 w-6 ${f?"text-primary-600":"text-gray-600"}`})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Drop images here, or click to browse"}),r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Supports: JPEG, PNG, GIF, WebP (max ",d,"MB each, up to ",c," images)"]})]}),r.jsxs("button",{type:"button",onClick:e=>{e.stopPropagation(),D()},disabled:o,className:"inline-flex items-center justify-center px-4 py-2.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 mt-3 touch-manipulation",title:"Add images from gallery or camera",children:[r.jsx($,{className:"h-4 w-4 mr-2"}),"Add Images"]})]})]}),r.jsx("input",{ref:b,type:"file",accept:"image/*",capture:"environment",onChange:x,className:"hidden"}),r.jsx("input",{ref:k,type:"file",accept:"image/*",multiple:!0,onChange:x,className:"hidden"}),n.length>0&&r.jsxs("div",{className:"space-y-3",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Transaction Images"}),r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:n.map((e,t)=>r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"aspect-w-4 aspect-h-3 rounded-lg overflow-hidden bg-gray-100",children:e.error?r.jsx("div",{className:"flex items-center justify-center h-full",children:r.jsxs("div",{className:"text-center p-4",children:[r.jsx(B,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),r.jsx("p",{className:"text-xs text-red-600",children:e.error})]})}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:e.previewUrl,alt:e.file.name,className:"w-full h-full object-cover"}),e.isUploading&&r.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-white text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white mx-auto mb-2"}),r.jsx("p",{className:"text-xs",children:e.uploadProgress?`${Math.round(e.uploadProgress)}%`:"Uploading..."})]})}),r.jsx("button",{type:"button",onClick:()=>U(t),className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",children:r.jsx(R,{className:"h-3 w-3"})})]})}),r.jsxs("div",{className:"mt-1",children:[r.jsx("p",{className:"text-xs text-gray-500 truncate",title:e.file.name,children:e.file.name}),r.jsx("p",{className:"text-xs text-gray-400",children:M(e.file.size)})]})]},t))})]})]})}export{O as I};
//# sourceMappingURL=ImageUpload-CjwkSEun.js.map
