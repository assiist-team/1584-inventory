import{m as he,u as ge,d as ye,U as fe,j as e,l as L,f as W,C as q}from"./index.js";import{u as be}from"./useStackedNavigate.js";import{r as d}from"./vendor.js";import{t as _,p as je,b as Ne,u as B}from"./inventoryService.js";import{I as ee}from"./imageService.js";import{I as ve}from"./ImageUpload.js";import{C as we}from"./ContextLink.js";import{u as Ie}from"./useNavigationContext.js";import{a as ke}from"./taxPresetsService.js";import{g as _e}from"./vendorDefaultsService.js";import{C as Ce}from"./CategorySelect.js";import{b as Te,u as Se}from"./router.js";import{d as Pe,g as Ee,b as te,t as se}from"./ui.js";import"./supabase.js";function Ke(){const{id:p,transactionId:m}=Te(),C=be(),F=he(),N=Se(),{hasRole:ae}=ge(),{currentAccountId:c}=ye(),{buildContextUrl:T}=Ie();if(!ae(fe.USER))return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 text-center",children:[e.jsx("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-red-100",children:e.jsx(Pe,{className:"h-6 w-6 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600",children:"You don't have permission to edit transactions. Please contact an administrator if you need access."}),e.jsx(we,{to:T(`/project/${p}`),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700",children:"Back to Project"})]})});const[re,ne]=d.useState(""),[n,$]=d.useState({transactionDate:"",source:"",transactionType:"Purchase",paymentMethod:"",amount:"",categoryId:"",notes:"",status:"completed",reimbursementType:"",triggerEvent:"Manual",receiptImages:[],otherImages:[],receiptEmailed:!1}),[h,D]=d.useState(void 0),[Y,K]=d.useState(""),[O,oe]=d.useState([]),[z,Q]=d.useState(void 0),[i,w]=d.useState({}),[I,R]=d.useState(!1),[ie,ce]=d.useState(!0),[k,le]=d.useState(!1),[M,de]=d.useState([]),[A,X]=d.useState([]),S=d.useRef(null),[G,U]=d.useState(!1),[V,H]=d.useState([]);d.useEffect(()=>{(async()=>{if(c)try{const s=await _e(c);H(s)}catch(s){console.error("Error loading vendor defaults:",s),H([])}})()},[c]),d.useEffect(()=>{(async()=>{if(c)try{const s=await ke(c);oe(s)}catch(s){console.error("Error loading tax presets:",s)}})()},[c]),d.useEffect(()=>{if(h&&h!=="Other"){const t=O.find(s=>s.id===h);Q(t==null?void 0:t.rate)}else Q(void 0)},[h,O]),d.useEffect(()=>{(async()=>{if(!(!p||!m||!c))try{const[s,o]=await Promise.all([_.getTransaction(c,p,m),je.getProject(c,p)]);if(o&&ne(o.name),s){const b=s.source==="Other"||s.source==="",P=b&&o?o.name:s.source,J=!!(P&&!V.includes(P));if($({transactionDate:Ne(s.transactionDate)||"",source:P,transactionType:s.transactionType,paymentMethod:s.paymentMethod,amount:s.amount,categoryId:s.categoryId||"",notes:s.notes||"",status:s.status||"completed",reimbursementType:s.reimbursementType||"",triggerEvent:s.triggerEvent||"Manual",receiptImages:[],otherImages:[],receiptEmailed:s.receiptEmailed}),s.taxRatePreset&&D(s.taxRatePreset),K(s.subtotal||""),U(J),b&&o&&p&&m&&c)try{await _.updateTransaction(c,p,m,{source:o.name})}catch(f){console.warn("Failed to auto-correct source to project name:",f)}const E=s.otherImages||[];de(Array.isArray(E)?E:[]);try{const f=await B.getItemsForTransaction(c,p,m);console.log("Loaded transaction items:",f);const x=f.map(r=>r.itemId);console.log("Transaction item IDs:",x);const y=await Promise.all(f.map(async r=>{var v,j;return console.log(`Loaded item ${r.itemId}:`,{id:r.itemId,description:(r==null?void 0:r.description)||"",hasValidFormat:r.itemId.startsWith("I-")&&r.itemId.length>10}),{id:r.itemId,description:(r==null?void 0:r.description)||"",purchasePrice:((v=r==null?void 0:r.purchasePrice)==null?void 0:v.toString())||"",sku:(r==null?void 0:r.sku)||"",marketValue:((j=r==null?void 0:r.marketValue)==null?void 0:j.toString())||"",notes:(r==null?void 0:r.notes)||"",imageFiles:[],images:(r==null?void 0:r.images)||[]}}));console.log("Loaded transaction items:",f.map(r=>({id:r.itemId,description:r.description,isTempId:r.itemId.startsWith("temp-")}))),X(y);try{S.current=y.map(r=>({id:r.id,description:r.description,purchasePrice:r.purchasePrice,sku:r.sku,marketValue:r.marketValue,notes:r.notes}))}catch{S.current=null}}catch(f){console.error("Error loading transaction items:",f)}}}catch(s){console.error("Error loading transaction:",s)}finally{ce(!1)}})()},[p,m,c,V]);const me=()=>{var s;const t={};return n.source.trim()||(t.source="Source is required"),(s=n.categoryId)!=null&&s.trim()||(t.categoryId="Budget category is required"),n.amount.trim()?(isNaN(Number(n.amount))||Number(n.amount)<=0)&&(t.amount="Amount must be a positive number"):t.amount="Amount is required",w(t),Object.keys(t).length===0},ue=async t=>{if(t.preventDefault(),!me()||!p||!m||!c)return;R(!0);let s=!1;try{if(c&&m)try{_.beginNeedsReviewBatch(c,m),s=!0}catch(x){console.warn("Failed to begin needs review batch:",x)}if(A.length>0){console.log("All items before processing:",A.map(a=>({id:a.id,description:a.description,price:a.purchasePrice,sku:a.sku,isTempId:a.id.startsWith("temp-"),idFormat:a.id.startsWith("I-")?"database":a.id.startsWith("temp-")?"temp":"unknown"})));const x=[],y=[];A.forEach(a=>{a.id.startsWith("temp-")?y.push(a):a.id.startsWith("I-")&&a.id.length>10?x.push(a):a.id.length>5&&!a.id.includes("_")?(console.warn(`Item with ambiguous ID treated as existing: ${a.id} - ${a.description}`),x.push(a)):(console.warn(`Item with unclear ID format treated as new: ${a.id} - ${a.description}`),y.push(a))}),console.log(`Separated ${x.length} existing items and ${y.length} new items`);const r=new Map;if(S.current)for(const a of S.current)r.set(a.id,a);const v=[];for(const a of x){const u=r.get(a.id),g={};(!u||u.description!==a.description)&&(g.description=a.description),(!u||String(u.purchasePrice||"")!==String(a.purchasePrice||""))&&(g.purchasePrice=a.purchasePrice),(!u||String(u.marketValue||"")!==String(a.marketValue||""))&&(g.marketValue=a.marketValue),(!u||(u.sku||"")!==(a.sku||""))&&(g.sku=a.sku),(!u||(u.notes||"")!==(a.notes||""))&&(g.notes=a.notes),g.transactionId=m,Object.keys(g).filter(xe=>xe!=="transactionId").length>0&&v.push({id:a.id,updates:g})}console.log(`Preparing to update ${v.length} of ${x.length} existing items`);for(const a of v)await B.updateItem(c,a.id,a.updates);let j=[];y.length>0&&(j=await Promise.all(y.map(async a=>{const u={...a,projectId:p,transactionId:m,dateCreated:n.transactionDate,source:n.source,inventoryStatus:"available",paymentMethod:"Unknown",qrKey:`QR-${Date.now()}-${Math.random().toString(36).substr(2,4)}`,bookmark:!1,sku:a.sku||"",purchasePrice:a.purchasePrice||"",projectPrice:a.projectPrice||"",marketValue:a.marketValue||"",notes:a.notes||"",space:a.space||"",disposition:"keep"};return await B.createItem(c,u)})),console.log("Created new items:",j),X(a=>a.map(u=>{const g=y.findIndex(Z=>Z.id===u.id);return g>=0&&g<j.length?{...u,id:j[g]}:u})))}let o=[...M];if(n.otherImages&&n.otherImages.length>0)try{const x=await ee.uploadMultipleOtherImages(n.otherImages,re,m,pe),y=ee.convertFilesToOtherImages(x);o=[...M,...y]}catch(x){console.error("Error uploading other images:",x),w({otherImages:"Failed to upload other images. Please try again."}),R(!1),le(!1);return}else o=M;const{otherImages:b,receiptImages:P,transactionImages:J,...E}=n,f={...E,otherImages:o,...h?{taxRatePreset:h,subtotal:h==="Other"?Y:""}:{subtotal:""}};await _.updateTransaction(c,p,m,f),C(`/project/${p}/transaction/${m}`)}catch(o){console.error("Error updating transaction:",o),w({general:o instanceof Error?o.message:"Failed to update transaction. Please try again."})}finally{if(s&&c&&m)try{await _.flushNeedsReviewBatch(c,m,{flushImmediately:!0})}catch(o){console.warn("Failed to flush needs review batch:",o)}R(!1)}},l=(t,s)=>{if(t==="categoryId"){$(o=>({...o,categoryId:s})),i.categoryId&&w(o=>({...o,categoryId:void 0}));return}$(o=>{const b={...o,[t]:s};return t==="status"&&s==="completed"&&o.reimbursementType?b.reimbursementType="":t==="reimbursementType"&&s&&o.status==="completed"&&(b.status="pending"),b}),i[t]&&w(o=>({...o,[t]:void 0}))},pe=(t,s)=>{console.log(`Upload progress for file ${t}: ${s.percentage}%`)};return ie?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Loading transaction..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("button",{onClick:()=>{const t=F.pop(N.pathname+N.search)||T(`/project/${p}`);C(t)},className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700",children:[e.jsx(Ee,{className:"h-4 w-4 mr-1"}),"Back"]})})}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Transaction"})}),e.jsxs("form",{onSubmit:ue,className:"space-y-6 p-6",children:[i.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsx("p",{children:i.general})})]})})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Source/Vendor *"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-3",children:V.map(t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:`source_${t.toLowerCase().replace(/\s+/g,"_")}`,name:"source",value:t,checked:n.source===t,onChange:s=>{l("source",s.target.value),U(!1)},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:`source_${t.toLowerCase().replace(/\s+/g,"_")}`,className:"ml-2 block text-sm text-gray-900",children:t})]},t))}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"source_custom",name:"source",value:"custom",checked:G,onChange:()=>{U(!0),l("source","")},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"source_custom",className:"ml-2 block text-sm text-gray-900",children:"Other"})]}),G&&e.jsx("input",{type:"text",id:"source_custom_input",value:n.source,onChange:t=>l("source",t.target.value),placeholder:"Enter custom source...",className:`mt-3 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${i.source?"border-red-300":"border-gray-300"}`}),i.source&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.source})]}),e.jsx("div",{children:e.jsx(Ce,{value:n.categoryId,onChange:t=>{l("categoryId",t)},label:"Budget Category",error:i.categoryId,required:!0})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Transaction Type"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"type_purchase",name:"transactionType",value:"Purchase",checked:n.transactionType==="Purchase",onChange:t=>l("transactionType",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"type_purchase",className:"ml-2 block text-sm text-gray-900",children:"Purchase"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"type_return",name:"transactionType",value:"Return",checked:n.transactionType==="Return",onChange:t=>l("transactionType",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"type_return",className:"ml-2 block text-sm text-gray-900",children:"Return"})]})]}),i.transactionType&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.transactionType})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Status"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"status_pending",name:"status",value:"pending",checked:n.status==="pending",onChange:t=>l("status",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"status_pending",className:"ml-2 block text-sm text-gray-900",children:"Pending"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"status_completed",name:"status",value:"completed",checked:n.status==="completed",onChange:t=>l("status",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"status_completed",className:"ml-2 block text-sm text-gray-900",children:"Completed"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"status_cancelled",name:"status",value:"canceled",checked:n.status==="canceled",onChange:t=>l("status",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"status_cancelled",className:"ml-2 block text-sm text-gray-900",children:"Canceled"})]})]}),i.status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Transaction Method"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"method_client_card",name:"paymentMethod",value:"Client Card",checked:n.paymentMethod==="Client Card",onChange:t=>l("paymentMethod",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"method_client_card",className:"ml-2 block text-sm text-gray-900",children:"Client Card"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"method_1584_card",name:"paymentMethod",value:L,checked:n.paymentMethod===L,onChange:t=>l("paymentMethod",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"method_1584_card",className:"ml-2 block text-sm text-gray-900",children:L})]})]}),i.paymentMethod&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.paymentMethod})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Reimbursement Type"}),e.jsx("p",{className:"mb-3 text-xs text-gray-500",children:"Flags transactions that require reimbursement"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"reimbursement_none",name:"reimbursementType",value:"",checked:!n.reimbursementType,onChange:t=>l("reimbursementType",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"reimbursement_none",className:"ml-2 block text-sm text-gray-900",children:"None"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"reimbursement_client_owes",name:"reimbursementType",value:W,checked:n.reimbursementType===W,onChange:t=>l("reimbursementType",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"reimbursement_client_owes",className:"ml-2 block text-sm text-gray-900",children:W})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"reimbursement_we_owe",name:"reimbursementType",value:q,checked:n.reimbursementType===q,onChange:t=>l("reimbursementType",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"reimbursement_we_owe",className:"ml-2 block text-sm text-gray-900",children:q})]})]}),i.reimbursementType&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.reimbursementType})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Receipt Email Copy"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"receipt_yes",name:"receiptEmailed",checked:n.receiptEmailed===!0,onChange:()=>l("receiptEmailed",!0),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"receipt_yes",className:"ml-2 block text-sm text-gray-900",children:"Yes"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"receipt_no",name:"receiptEmailed",checked:n.receiptEmailed===!1,onChange:()=>l("receiptEmailed",!1),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"receipt_no",className:"ml-2 block text-sm text-gray-900",children:"No"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700",children:"Amount *"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"text",id:"amount",value:n.amount,onChange:t=>l("amount",t.target.value),placeholder:"0.00",className:`block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${i.amount?"border-red-300":"border-gray-300"}`})]}),i.amount&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Tax Rate Preset"}),e.jsxs("div",{className:"space-y-2",children:[O.map(t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:`tax_preset_${t.id}`,name:"tax_rate_preset",value:t.id,checked:h===t.id,onChange:s=>D(s.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsxs("label",{htmlFor:`tax_preset_${t.id}`,className:"ml-2 block text-sm text-gray-900",children:[t.name," (",t.rate.toFixed(2),"%)"]})]},t.id)),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"tax_preset_other",name:"tax_rate_preset",value:"Other",checked:h==="Other",onChange:t=>D(t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"tax_preset_other",className:"ml-2 block text-sm text-gray-900",children:"Other"})]})]}),h&&h!=="Other"&&z!==void 0&&e.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded-md",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Tax Rate:"})," ",z.toFixed(2),"%"]})})]}),h==="Other"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subtotal"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"text",id:"subtotal",value:Y,onChange:t=>K(t.target.value),placeholder:"0.00",className:"block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 border-gray-300"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"This will be used to calculate the tax rate."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"transactionDate",className:"block text-sm font-medium text-gray-700",children:"Transaction Date"}),e.jsx("input",{type:"date",id:"transactionDate",value:n.transactionDate,onChange:t=>{l("transactionDate",t.target.value)},className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${i.transactionDate?"border-red-300":"border-gray-300"}`}),i.transactionDate&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.transactionDate})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notes"}),e.jsx("textarea",{id:"notes",rows:3,value:n.notes,onChange:t=>l("notes",t.target.value),placeholder:"Additional notes about this transaction...",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${i.notes?"border-red-300":"border-gray-300"}`}),i.notes&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.notes})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Other Images"}),e.jsx(ve,{onImagesChange:t=>l("otherImages",t),maxImages:5,maxFileSize:10,disabled:I||k,className:"mb-2"}),i.otherImages&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.otherImages})]}),e.jsxs("div",{className:"hidden sm:flex justify-end sm:space-x-3 pt-4",children:[e.jsxs("button",{onClick:()=>{const t=F.pop(N.pathname+N.search)||T(`/project/${p}`);C(t)},className:"inline-flex justify-center items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs("button",{type:"submit",disabled:I||k,className:"inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),I?"Updating...":k?"Uploading Images...":"Update"]})]})]})]}),e.jsx("div",{className:"sm:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 z-50",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>{const t=F.pop(N.pathname+N.search)||T(`/project/${p}`);C(t)},className:"flex-1 inline-flex justify-center items-center px-4 py-3 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs("button",{type:"submit",disabled:I||k,onClick:t=>{var o;const s=(o=t.currentTarget.closest(".space-y-6"))==null?void 0:o.querySelector("form");s&&s.requestSubmit()},className:"flex-1 inline-flex justify-center items-center px-4 py-3 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),I?"Updating...":k?"Uploading Images...":"Update"]})]})}),e.jsx("div",{className:"sm:hidden h-20"})]})}export{Ke as default};
//# sourceMappingURL=EditTransaction.js.map
