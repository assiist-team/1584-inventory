import{u as ce,j as e}from"./index-DRwKqTma.js";import{u as de,b as me,L as Y}from"./router-Bad1IJif.js";import{r as u}from"./vendor-Gm9i_4Ku.js";import{T as V}from"./transactionSources-Bmq7Rv82.js";import{p as ue,t as te,i as se}from"./inventoryService-CSqmAljY.js";import{I as q}from"./imageService-De3eSBgy.js";import{I as pe}from"./ImageUpload-CjwkSEun.js";import{I as ge}from"./ImagePreview-7Z3AOnud.js";import{a as G,i as xe,P as ae,d as he,b as re,l as ye}from"./ui-DKDhksGx.js";import"./firebase-DTZupgGV.js";function fe({item:s,onSave:F,onCancel:_,isEditing:P=!1,onImageFilesChange:n}){const[g,b]=u.useState(s||{id:`temp_${Date.now()}`,description:"",sku:"",price:"",market_value:"",notes:""}),[j,N]=u.useState((s==null?void 0:s.images)||[]),[w,I]=u.useState((s==null?void 0:s.imageFiles)||[]),[k,o]=u.useState(!1),[l,S]=u.useState({}),{showError:C}=ce();u.useEffect(()=>{var r,y;s&&(console.log("TransactionItemForm: Editing item with images:",((r=s.images)==null?void 0:r.length)||0,"imageFiles:",((y=s.imageFiles)==null?void 0:y.length)||0),N(s.images||[]),I(s.imageFiles||[]),b({id:s.id,description:s.description,sku:s.sku||"",price:s.price,market_value:s.market_value||"",notes:s.notes||""}))},[s]);const a=async()=>{var r,y;try{o(!0);const t=await q.selectFromGallery();if(t&&t.length>0){console.log("Selected",t.length,"files from gallery"),I(c=>[...c,...t]);const i=t.map((c,v)=>({url:"",alt:c.name,isPrimary:j.length===0&&v===0,uploadedAt:new Date,fileName:c.name,size:c.size,mimeType:c.type}));N(c=>[...c,...i]),console.log("Added",i.length,"preview images")}else console.log("No files selected from gallery")}catch(t){if(console.error("Error selecting from gallery:",t),(r=t.message)!=null&&r.includes("timeout")||(y=t.message)!=null&&y.includes("canceled")){console.log("User canceled image selection or selection timed out");return}C("Failed to select images from gallery. Please try again.")}finally{o(!1)}},x=r=>{const y=j.findIndex(t=>t.url===r);y!==-1&&y<w.length&&(N(t=>t.filter(i=>i.url!==r)),I(t=>t.filter((i,c)=>c!==y)))},f=r=>{N(y=>y.map(t=>({...t,isPrimary:t.url===r})))},z=()=>{const r={};return g.description.trim()||(r.description="Description is required"),g.price.trim()?(isNaN(Number(g.price))||Number(g.price)<=0)&&(r.price="Price must be a positive number"):r.price="Price is required",S(r),Object.keys(r).length===0},p=()=>{if(!z())return;const r={...g,images:j,imageFiles:w};n&&w.length>0&&n(g.id,w),F(r)},$=(r,y)=>{b(t=>({...t,[r]:y})),l[r]&&S(t=>({...t,[r]:void 0}))};return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:P?"Edit Item":"Add Item"}),e.jsx("button",{onClick:_,className:"text-gray-400 hover:text-gray-600",type:"button",children:e.jsx(G,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description *"}),e.jsx("input",{type:"text",id:"description",value:g.description,onChange:r=>$("description",r.target.value),placeholder:"Item description",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${l.description?"border-red-300":"border-gray-300"}`}),l.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.description})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sku",className:"block text-sm font-medium text-gray-700",children:"SKU"}),e.jsx("input",{type:"text",id:"sku",value:g.sku,onChange:r=>$("sku",r.target.value),placeholder:"Stock keeping unit",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${l.sku?"border-red-300":"border-gray-300"}`}),l.sku&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.sku})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:"Price *"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"text",id:"price",value:g.price,onChange:r=>$("price",r.target.value),placeholder:"0.00",className:`block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${l.price?"border-red-300":"border-gray-300"}`})]}),l.price&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.price})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"market_value",className:"block text-sm font-medium text-gray-700",children:"Market Value"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"text",id:"market_value",value:g.market_value,onChange:r=>$("market_value",r.target.value),placeholder:"0.00",className:`block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${l.market_value?"border-red-300":"border-gray-300"}`})]}),l.market_value&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.market_value})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notes"}),e.jsx("textarea",{id:"notes",rows:2,value:g.notes,onChange:r=>$("notes",r.target.value),placeholder:"Additional notes about this item",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${l.notes?"border-red-300":"border-gray-300"}`}),l.notes&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.notes})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Item Images"}),e.jsxs("button",{type:"button",onClick:a,disabled:k,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 mb-3",title:"Add images from gallery or camera",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),k?"Uploading...":"Add Images"]}),e.jsx(ge,{images:j,onRemoveImage:x,onSetPrimary:f,maxImages:3,size:"md"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:r=>{r.preventDefault(),r.stopPropagation(),_()},className:"px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Cancel"}),e.jsx("button",{type:"button",onClick:r=>{r.preventDefault(),r.stopPropagation(),p()},className:"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:P?"Update Item":"Add Item"})]})]})]})}function be({items:s,onItemsChange:F,projectId:_,projectName:P,onImageFilesChange:n}){const[g,b]=u.useState(!1),[j,N]=u.useState(null),w=()=>{b(!0),N(null)},I=a=>{if(j){const x=s.map(f=>f.id===j?a:f);F(x)}else F([...s,a]);a.imageFiles&&a.imageFiles.length>0&&n&&n(a.id,a.imageFiles),b(!1),N(null)},k=()=>{b(!1),N(null)},o=a=>{N(a),b(!1)},l=a=>{const x=s.filter(f=>f.id!==a);F(x)},S=()=>j&&s.find(a=>a.id===j)||null,C=a=>{const x=parseFloat(a);return isNaN(x)?"$0.00":`$${x.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`};if(g||j){const a=S();return e.jsx(fe,{item:a||void 0,onSave:I,onCancel:k,isEditing:!!a,projectId:_,projectName:P,onImageFilesChange:n})}return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Transaction Items"}),e.jsxs("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),w()},className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Add Item"]})]}),s.length===0?e.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg",children:[e.jsx("p",{className:"text-gray-500",children:"No items added to this transaction yet."}),e.jsxs("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),w()},className:"mt-4 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Add Item"]})]}):e.jsxs("div",{className:"space-y-3",children:[s.map((a,x)=>e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800",children:["Item ",x+1]}),e.jsx("span",{className:"text-sm text-gray-500",children:C(a.price)})]}),e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:a.description||"No description"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[a.sku&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"SKU:"})," ",a.sku]}),a.market_value&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Market Value:"})," $",a.market_value]})]}),a.notes&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Notes:"})," ",a.notes]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:f=>{f.preventDefault(),f.stopPropagation(),o(a.id)},className:"text-primary-600 hover:text-primary-900 p-1",title:"Edit item",children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx("button",{onClick:f=>{f.preventDefault(),f.stopPropagation(),l(a.id)},className:"text-red-600 hover:text-red-900 p-1",title:"Delete item",children:e.jsx(G,{className:"h-4 w-4"})})]})]})},a.id)),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Total Items: ",s.length]}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["Total: ",C(s.reduce((a,x)=>a+(parseFloat(x.price)||0),0).toString())]})]})]})]})}function $e(){const{id:s}=de(),F=me(),[_,P]=u.useState("");u.useEffect(()=>{(async()=>{if(s)try{const i=await ue.getProject(s);i&&P(i.name)}catch(i){console.error("Failed to fetch project:",i)}})()},[s]);const[n,g]=u.useState({transaction_date:(()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`})(),source:"",transaction_type:"Purchase",payment_method:"",amount:"",notes:"",transaction_images:[],receipt_emailed:!1,items:[]}),[b,j]=u.useState([]),[N,w]=u.useState(new Map),[I,k]=u.useState(!1);u.useEffect(()=>{n.source&&!V.includes(n.source)?k(!0):n.source&&V.includes(n.source)&&k(!1)},[n.source]);const[o,l]=u.useState({}),[S,C]=u.useState(!1),[a,x]=u.useState(!1),f=()=>{const t={};return n.source.trim()||(t.source="Source is required"),n.transaction_type.trim()||(t.transaction_type="Transaction type is required"),n.payment_method.trim()||(t.payment_method="Payment method is required"),n.amount.trim()?(isNaN(Number(n.amount))||Number(n.amount)<=0)&&(t.amount="Amount must be a positive number"):t.amount="Amount is required",n.transaction_date||(t.transaction_date="Transaction date is required"),l(t),Object.keys(t).length===0},z=async t=>{var i,c,v,K,W,B,X,H,J;if(t.preventDefault(),!(!f()||!s)){C(!0);try{const{transaction_images:A,...ne}=n,U={...ne,project_id:s,project_name:_,created_by:"system"};console.log("Attempting to create transaction with data:",U),console.log("Transaction date value:",U.transaction_date),console.log("Transaction date type:",typeof U.transaction_date),console.log("Transaction items:",b);const L=await te.createTransaction(s,U,b);if(n.transaction_images&&n.transaction_images.length>0){x(!0);try{const d=await q.uploadMultipleTransactionImages(n.transaction_images,_,L,y),m=q.convertFilesToTransactionImages(d);if(console.log("Transaction images uploaded successfully:",m.length,"images"),console.log("Transaction images to save:",m),m&&m.length>0){console.log("Updating transaction with transaction images...");try{await te.updateTransaction(s,L,{transaction_images:m}),console.log("Transaction updated successfully with transaction images")}catch(T){console.error("Failed to update transaction with transaction images:",T)}}await new Promise(T=>setTimeout(T,500))}catch(d){console.error("Error uploading images:",d);let m="Failed to upload transaction images. Please try again.";(i=d.message)!=null&&i.includes("Storage service is not available")?m="Storage service is unavailable. Please check your internet connection.":(c=d.message)!=null&&c.includes("Network error")||(v=d.message)!=null&&v.includes("offline")?m="Network connection issue. Please check your internet and try again.":(K=d.message)!=null&&K.includes("quota exceeded")?m="Storage quota exceeded. Please contact support.":(W=d.message)!=null&&W.includes("Unauthorized")?m="Permission denied. Please check your account permissions.":((B=d.message)!=null&&B.includes("CORS")||(X=d.message)!=null&&X.includes("Access-Control")||(H=d.message)!=null&&H.includes("ERR_FAILED")||(J=d.message)!=null&&J.includes("preflight"))&&(m="Upload blocked by browser security policy. Please check Firebase Storage configuration or try refreshing the page."),l({transaction_images:m}),C(!1),x(!1);return}x(!1)}if(N.size>0)try{console.log("Starting image upload process...");const d=await se.getTransactionItems(s,L);console.log("Created item IDs:",d);for(let m=0;m<b.length&&m<d.length;m++){const T=b[m],R=d[m],D=N.get(T.id);if(D&&D.length>0){console.log(`Uploading ${D.length} images for item ${R}`);const oe=D.map(async(h,ie)=>{var Q,Z;try{console.log(`Uploading file ${ie+1}/${D.length}: ${h.name}`);const E=await q.uploadItemImage(h,_,R);console.log(`Upload successful for ${h.name}:`,E),console.log(`Upload result URL: ${E.url}`);const ee={url:E.url,alt:h.name,isPrimary:((Z=(Q=T.images)==null?void 0:Q.find(le=>le.fileName===h.name))==null?void 0:Z.isPrimary)||!1,uploadedAt:new Date,fileName:h.name,size:h.size,mimeType:h.type};return console.log("Created ItemImage object:",ee),ee}catch(E){return console.error(`Failed to upload ${h.name}:`,E),{url:"",alt:h.name,isPrimary:!1,uploadedAt:new Date,fileName:h.name,size:h.size,mimeType:h.type}}}),O=await Promise.all(oe);console.log("All uploads completed, updating item with images:",O);const M=O.filter(h=>h.url&&h.url.trim()!=="");console.log(`Valid images to save: ${M.length}/${O.length}`),M.length>0&&(await se.updateItemImages(s,R,M),console.log(`Successfully updated item ${R} with ${M.length} images`))}}}catch(d){console.error("Error in image upload process:",d)}F(`/project/${s}?tab=transactions`)}catch(A){console.error("Error creating transaction:",A),l({general:A instanceof Error?A.message:"Failed to create transaction. Please try again."})}finally{C(!1)}}},p=(t,i)=>{g(c=>({...c,[t]:i})),o[t]&&l(c=>({...c,[t]:void 0}))},$=t=>{g(i=>({...i,transaction_images:t})),o.transaction_images&&l(i=>({...i,transaction_images:void 0}))},r=(t,i)=>{w(c=>{const v=new Map(c);return v.set(t,i),v}),j(c=>c.map(v=>v.id===t?{...v,imageFiles:i}:v))},y=(t,i)=>{console.log(`Upload progress for file ${t}: ${i.percentage}%`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Y,{to:`/project/${s}?tab=transactions`,className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700",children:[e.jsx(re,{className:"h-4 w-4 mr-1"}),"Back"]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs(Y,{to:`/project/${s}?tab=inventory`,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"View Inventory"]})})]})}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Add Transaction"})}),e.jsxs("form",{onSubmit:z,className:"space-y-8 p-8",children:[o.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsx("p",{children:o.general})})]})})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Transaction Date *"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"date_today",name:"transaction_date_option",checked:n.transaction_date===(()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`})(),onChange:()=>p("transaction_date",(()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`})()),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"date_today",className:"ml-2 block text-sm text-gray-900",children:"Today"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"date_different",name:"transaction_date_option",checked:n.transaction_date!==(()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`})(),onChange:()=>{},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"date_different",className:"ml-2 block text-sm text-gray-900",children:"Different Date"})]})]}),e.jsx("input",{type:"date",id:"transaction_date",value:n.transaction_date,onChange:t=>{p("transaction_date",t.target.value)},className:`mt-3 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${o.transaction_date?"border-red-300":"border-gray-300"}`}),o.transaction_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.transaction_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Transaction Source *"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-3",children:V.map(t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:`source_${t.toLowerCase().replace(/\s+/g,"_")}`,name:"source",value:t,checked:n.source===t,onChange:i=>{p("source",i.target.value),k(!1)},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:`source_${t.toLowerCase().replace(/\s+/g,"_")}`,className:"ml-2 block text-sm text-gray-900",children:t})]},t))}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"source_custom",name:"source",value:"custom",checked:I,onChange:()=>{k(!0),p("source","")},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"source_custom",className:"ml-2 block text-sm text-gray-900",children:"Other"})]}),I&&e.jsx("input",{type:"text",id:"source_custom_input",value:n.source,onChange:t=>p("source",t.target.value),placeholder:"Enter custom source...",className:`mt-3 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${o.source?"border-red-300":"border-gray-300"}`}),o.source&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.source})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Transaction Type *"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"type_purchase",name:"transaction_type",value:"Purchase",checked:n.transaction_type==="Purchase",onChange:t=>p("transaction_type",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"type_purchase",className:"ml-2 block text-sm text-gray-900",children:"Purchase"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"type_return",name:"transaction_type",value:"Return",checked:n.transaction_type==="Return",onChange:t=>p("transaction_type",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"type_return",className:"ml-2 block text-sm text-gray-900",children:"Return"})]})]}),o.transaction_type&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.transaction_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Transaction Method *"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"method_client_card",name:"payment_method",value:"Client Card",checked:n.payment_method==="Client Card",onChange:t=>p("payment_method",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"method_client_card",className:"ml-2 block text-sm text-gray-900",children:"Client Card"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"method_1584_card",name:"payment_method",value:"1584 Card",checked:n.payment_method==="1584 Card",onChange:t=>p("payment_method",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"method_1584_card",className:"ml-2 block text-sm text-gray-900",children:"1584 Card"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"method_split",name:"payment_method",value:"Split",checked:n.payment_method==="Split",onChange:t=>p("payment_method",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"method_split",className:"ml-2 block text-sm text-gray-900",children:"Split"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"method_store_credit",name:"payment_method",value:"Store Credit",checked:n.payment_method==="Store Credit",onChange:t=>p("payment_method",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"method_store_credit",className:"ml-2 block text-sm text-gray-900",children:"Store Credit"})]})]}),o.payment_method&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.payment_method})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700",children:"Amount *"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"text",id:"amount",value:n.amount,onChange:t=>p("amount",t.target.value),placeholder:"0.00",className:`block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${o.amount?"border-red-300":"border-gray-300"}`})]}),o.amount&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Receipt Email Copy"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"receipt_yes",name:"receipt_emailed",checked:n.receipt_emailed===!0,onChange:()=>p("receipt_emailed",!0),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"receipt_yes",className:"ml-2 block text-sm text-gray-900",children:"Yes"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"receipt_no",name:"receipt_emailed",checked:n.receipt_emailed===!1,onChange:()=>p("receipt_emailed",!1),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"receipt_no",className:"ml-2 block text-sm text-gray-900",children:"No"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notes"}),e.jsx("textarea",{id:"notes",rows:3,value:n.notes,onChange:t=>p("notes",t.target.value),placeholder:"Additional notes about this transaction...",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${o.notes?"border-red-300":"border-gray-300"}`}),o.notes&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.notes})]}),e.jsxs("div",{children:[e.jsx(be,{items:b,onItemsChange:t=>{j(t),o.items&&t.length>0&&l(i=>({...i,items:void 0}))},projectId:s,projectName:_,onImageFilesChange:r}),o.items&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.items})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Transaction Images"}),e.jsx(pe,{onImagesChange:$,maxImages:5,maxFileSize:10,disabled:S||a,className:"mb-2"}),o.transaction_images&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.transaction_images})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsxs(Y,{to:`/project/${s}?tab=transactions`,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs("button",{type:"submit",disabled:S||a,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),S?"Creating...":a?"Uploading Images...":"Create Transaction"]})]})]})]})]})}export{$e as default};
//# sourceMappingURL=AddTransaction-CMB-L-Es.js.map
