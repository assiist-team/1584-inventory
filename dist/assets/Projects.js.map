{"version":3,"file":"Projects.js","sources":["../../src/pages/Projects.tsx"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport { Plus, FolderOpen } from 'lucide-react'\nimport { Link } from 'react-router-dom'\nimport { Project, Transaction } from '@/types'\nimport { projectService, transactionService } from '@/services/inventoryService'\nimport { useAuth } from '@/contexts/AuthContext'\nimport ProjectForm from '@/components/ProjectForm'\nimport { CompactBudgetProgress } from '@/components/ui/BudgetProgress'\n\nexport default function Projects() {\n  const { user } = useAuth()\n  const [projects, setProjects] = useState<Project[]>([])\n  const [transactions, setTransactions] = useState<Record<string, Transaction[]>>({})\n  const [isLoading, setIsLoading] = useState(true)\n  const [showCreateForm, setShowCreateForm] = useState(false)\n\n  useEffect(() => {\n    loadProjectsData()\n  }, [])\n\n  const handleCreateProject = async (projectData: any) => {\n    if (!user?.email) {\n      throw new Error('User must be authenticated to create projects')\n    }\n\n    try {\n      await projectService.createProject({\n        ...projectData,\n        createdBy: user.email\n      })\n\n      // Reload projects and transactions\n      await loadProjectsData()\n      setShowCreateForm(false)\n    } catch (error) {\n      console.error('Error creating project:', error)\n      throw error // Let the form handle the error\n    }\n  }\n\n  const loadProjectsData = async () => {\n    setIsLoading(true)\n    try {\n      const projectsData = await projectService.getProjects()\n      setProjects(projectsData)\n\n      // Load transactions for each project\n      const transactionsData: Record<string, Transaction[]> = {}\n      for (const project of projectsData) {\n        try {\n          const projectTransactions = await transactionService.getTransactions(project.id)\n          transactionsData[project.id] = projectTransactions\n        } catch (error) {\n          console.error(`Error loading transactions for project ${project.id}:`, error)\n          transactionsData[project.id] = []\n        }\n      }\n      setTransactions(transactionsData)\n    } catch (error) {\n      console.error('Error loading projects:', error)\n      setProjects([])\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const handleShowCreateForm = () => {\n    setShowCreateForm(true)\n  }\n\n  const handleCloseCreateForm = () => {\n    setShowCreateForm(false)\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Projects</h1>\n        </div>\n        <div className=\"flex space-x-3\">\n          <button\n            onClick={handleShowCreateForm}\n            className=\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n          >\n            <Plus className=\"h-4 w-4 mr-2\" />\n            New\n          </button>\n        </div>\n      </div>\n\n      {/* Projects Grid */}\n      {isLoading ? (\n        <div className=\"flex justify-center items-center h-64\">\n          <div className=\"text-center\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto\"></div>\n            <p className=\"mt-2 text-sm text-gray-600\">Loading projects...</p>\n          </div>\n        </div>\n      ) : projects.length === 0 ? (\n        <div className=\"bg-white shadow rounded-lg\">\n          <div className=\"px-4 py-5 sm:p-6\">\n            <div className=\"text-center py-12\">\n              <FolderOpen className=\"mx-auto h-12 w-12 text-gray-400\" />\n              <h3 className=\"mt-2 text-sm font-medium text-gray-900\">\n                No projects yet\n              </h3>\n              <p className=\"mt-1 text-sm text-gray-500\">\n                Create your first project to start organizing your inventory.\n              </p>\n              <div className=\"mt-6\">\n                <button\n                  onClick={handleShowCreateForm}\n                  className=\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n                >\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  Create Project\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      ) : (\n        <div className=\"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3\">\n          {projects.map((project) => (\n            <div key={project.id} className=\"bg-white shadow rounded-lg border border-gray-200\">\n              <div className=\"p-6\">\n                {/* Project Header */}\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center\">\n                    <FolderOpen className=\"h-8 w-8 text-primary-600 mr-3\" />\n                    <h3 className=\"text-lg font-semibold text-gray-900\">\n                      {project.name}\n                    </h3>\n                  </div>\n                </div>\n\n                {/* Project Client */}\n                <div className=\"mb-4\">\n                  <div className=\"text-sm font-normal text-gray-900 ml-11\">\n                    {project.clientName}\n                  </div>\n                </div>\n\n                {/* Budget Progress */}\n                <div className=\"mb-4\">\n                  <CompactBudgetProgress\n                    budget={project.budget}\n                    designFee={project.designFee}\n                    budgetCategories={project.budgetCategories}\n                    transactions={transactions[project.id] || []}\n                  />\n                </div>\n\n\n\n\n                {/* Action Button */}\n                <div className=\"flex justify-center\">\n                  <Link\n                    to={`/project/${project.id}`}\n                    className=\"flex-1 inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\n                  >\n                    <FolderOpen className=\"h-4 w-4 mr-2\" />\n                    Open Project\n                  </Link>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Project Creation Form */}\n      {showCreateForm && (\n        <ProjectForm\n          onSubmit={handleCreateProject}\n          onCancel={handleCloseCreateForm}\n        />\n      )}\n\n    </div>\n  )\n}\n"],"names":["Projects","user","useAuth","projects","setProjects","useState","transactions","setTransactions","isLoading","setIsLoading","showCreateForm","setShowCreateForm","useEffect","loadProjectsData","handleCreateProject","projectData","projectService","error","projectsData","transactionsData","project","projectTransactions","transactionService","handleShowCreateForm","handleCloseCreateForm","jsxs","jsx","Plus","FolderOpen","CompactBudgetProgress","Link","ProjectForm"],"mappings":"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"}