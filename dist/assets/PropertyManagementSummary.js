import{d as k,l as I,j as e,B as d}from"./index.js";import{r as i}from"./vendor.js";import{p as P,u as B}from"./inventoryService.js";import{c as M,b as V}from"./router.js";import"./supabase.js";import"./ui.js";import"./taxPresetsService.js";const p=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});function y(t){if(typeof t=="number")return isNaN(t)?0:t;if(typeof t=="string"){const r=parseFloat(t||"0");return isNaN(r)?0:r}return 0}function A(){const{id:t}=M(),r=V(),{currentAccountId:l}=k(),{businessName:N,businessLogoUrl:o}=I(),[n,f]=i.useState(null),[c,g]=i.useState([]),[v,x]=i.useState(!0),[u,h]=i.useState(null),b=i.useMemo(()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),[]);i.useEffect(()=>{(async()=>{if(!t||!l){if(!l)return;r("/projects");return}x(!0),h(null);try{const[a,m]=await Promise.all([P.getProject(l,t),B.getItemsByProject(l,t)]);if(!a){r("/projects");return}f(a),g(m)}catch(a){console.error("Failed to load property management summary:",a),h("Failed to load property management summary. Please try again.")}finally{x(!1)}})()},[t,l,r]);const w=i.useMemo(()=>c.reduce((s,a)=>{const m=y(a.marketValue);return s+m},0),[c]),S=()=>window.print(),j=()=>{if(!t)return r("/projects");r(`/project/${t}?tab=inventory`)};return v?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Loading property management summary..."})]})}):u?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto h-12 w-12 text-red-400",children:"âš ï¸"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Error"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:u}),e.jsx("div",{className:"mt-6",children:e.jsx(d,{onClick:j,children:"Back"})})]}):e.jsxs("div",{className:"max-w-4xl mx-auto bg-white shadow rounded-lg p-8 print:shadow-none print:p-0",children:[e.jsxs("div",{className:"flex justify-end space-x-3 mb-6 print:hidden",children:[e.jsx(d,{variant:"secondary",onClick:j,children:"Back"}),e.jsx(d,{onClick:S,children:"Print"})]}),e.jsx("div",{className:"border-b pb-4 mb-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[o&&e.jsx("img",{src:o,alt:N,className:"h-24 w-auto object-contain"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Property Management Summary"}),e.jsxs("div",{className:"mt-1 text-sm text-gray-600",children:[e.jsx("div",{className:"font-medium text-gray-800",children:(n==null?void 0:n.name)||"Project"}),(n==null?void 0:n.clientName)&&e.jsxs("div",{children:["Client: ",n.clientName]}),e.jsxs("div",{children:["Date: ",b]})]})]})]})}),c.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto h-12 w-12 text-gray-400",children:"ðŸ“¦"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No items found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"There are no items associated with this project."})]}),c.length>0&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("section",{children:e.jsxs("div",{className:"rounded-lg border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-100",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Summary"})}),e.jsx("div",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:gap-4",children:[e.jsxs("div",{className:"flex items-center sm:flex-initial",children:[e.jsx("span",{className:"text-base font-medium text-gray-700",children:"Total Items:"}),e.jsx("span",{className:"ml-2 text-base font-semibold text-gray-900",children:c.length})]}),e.jsxs("div",{className:"flex items-center sm:flex-1 sm:border-l sm:border-gray-100 sm:pl-4",children:[e.jsx("span",{className:"text-base font-medium text-gray-700",children:"Total Market Value:"}),e.jsx("span",{className:"ml-2 text-base font-semibold text-gray-900",children:p.format(w)})]})]})})]})}),e.jsxs("section",{children:[e.jsx("div",{className:"flex items-baseline justify-between mb-3",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Items"})}),e.jsx("div",{className:"rounded-lg border border-gray-100 overflow-hidden",children:e.jsx("div",{className:"divide-y",children:c.map(s=>{const a=y(s.marketValue);return e.jsx("div",{className:"py-2 px-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-gray-900 font-medium",children:s.description||"Item"}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mt-0.5",children:[s.source&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Source: ",s.source]}),s.sku&&e.jsxs(e.Fragment,{children:[s.source&&e.jsx("span",{className:"text-xs text-gray-400",children:"â€¢"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["SKU: ",s.sku]})]})]}),s.space&&e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:["Space: ",s.space]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsx("div",{className:"text-sm text-gray-700 font-medium",children:p.format(a)}),a===0&&e.jsx("div",{className:"text-xs text-gray-400 mt-0.5",children:"No market value set"})]})]})},s.itemId)})})})]})]})]})}export{A as default};
//# sourceMappingURL=PropertyManagementSummary.js.map
