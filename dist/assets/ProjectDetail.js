import{a as ee,j as e}from"./index.js";import{L as N,b as te,c as ne,d as ie}from"./router.js";import{r as l}from"./vendor.js";import{i as _,t as A,p as L}from"./inventoryService.js";import{I as J}from"./imageService.js";import{u as oe}from"./useBookmark.js";import{d as se,m as le,n as ce,Q as de,l as re,R as me,B as xe,f as ae,g as ue,o as ge,p as Y,C as he,X as pe,e as G,i as Z,D as ye,P as fe}from"./ui.js";import{a as be,f as je}from"./dateUtils.js";import{B as we,P as Ne}from"./BudgetProgress.js";import"./firebase.js";function ve({projectId:o,projectName:p}){const[m,f]=l.useState(""),[a,b]=l.useState(new Set),[x,g]=l.useState([]),[v,y]=l.useState(!0),[i,u]=l.useState(null),[B,k]=l.useState(new Set),[S,C]=l.useState(null),[j,D]=l.useState("all"),[P,w]=l.useState(!1),{showSuccess:E,showError:O}=ee();l.useEffect(()=>{(async()=>{try{y(!0),u(null),console.log("Fetching items for project:",o);const n=await _.getItems(o);console.log("Fetched items:",n.length,n),g(n)}catch(n){console.error("Failed to fetch items:",n),u("Failed to load inventory items. Please try again.")}finally{y(!1)}})();const s=_.subscribeToItems(o,n=>{console.log("Real-time items update:",n.length,n),g(n)});return()=>{s()}},[o]),l.useEffect(()=>()=>{k(new Set)},[]),l.useEffect(()=>{const t=s=>{if(S&&!s.target)return;const n=s.target;!n.closest(".disposition-menu")&&!n.closest(".disposition-badge")&&C(null),P&&!n.closest(".filter-menu")&&!n.closest(".filter-button")&&w(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[S,P]);const z=t=>{b(t?new Set(x.map(s=>s.item_id)):new Set)},R=(t,s)=>{const n=new Set(a);s?n.add(t):n.delete(t),b(n)},{toggleBookmark:M}=oe({items:x,setItems:g,updateItemService:(t,s)=>_.updateItem(o,t,s),projectId:o}),U=async(t,s)=>{try{if(!x.find(d=>d.item_id===t))return;await _.updateItem(o,t,{disposition:s}),g(x.map(d=>d.item_id===t?{...d,disposition:s}:d)),C(null)}catch(n){console.error("Failed to update disposition:",n),u("Failed to update item disposition. Please try again.")}},Q=t=>{C(S===t?null:t)},$=t=>{const s="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium cursor-pointer transition-colors hover:opacity-80";switch(t){case"keep":return`${s} bg-green-100 text-green-800`;case"to return":case"return":return`${s} bg-red-100 text-red-700`;case"returned":return`${s} bg-red-800 text-red-100`;case"inventory":return`${s} bg-blue-100 text-blue-800`;default:return`${s} bg-gray-100 text-gray-800`}},W=async t=>{var s,n;try{k(h=>new Set(h).add(t));const d=await J.selectFromGallery();if(d.length>0)for(let h=0;h<d.length;h++){const T=d[h];await X(t,T,d)}}catch(d){if(console.error("Error adding image:",d),(s=d.message)!=null&&s.includes("timeout")||(n=d.message)!=null&&n.includes("canceled")){console.log("User canceled image selection or selection timed out");return}O("Failed to add image. Please try again.")}finally{k(d=>{const h=new Set(d);return h.delete(t),h})}},X=async(t,s,n)=>{const h={url:(await J.uploadItemImage(s,p,t)).url,alt:s.name,isPrimary:!0,uploadedAt:new Date,fileName:s.name,size:s.size,mimeType:s.type};if(await _.addItemImage(o,t,h),n&&n.indexOf(s)===n.length-1){const T=n.length>1?`${n.length} images uploaded successfully!`:"Image uploaded successfully!";E(T)}},q=async()=>{if(a.size===0)return;const t=`Are you sure you want to delete ${a.size} item(s)? This action cannot be undone.`;if(confirm(t))try{const s=Array.from(a).map(n=>_.deleteItem(o,n));await Promise.all(s),b(new Set),u(null)}catch(s){console.error("Failed to delete items:",s),u("Failed to delete some items. Please try again.")}},I=x.filter(t=>{const s=t.description.toLowerCase().includes(m.toLowerCase())||t.source.toLowerCase().includes(m.toLowerCase())||t.sku.toLowerCase().includes(m.toLowerCase())||t.payment_method.toLowerCase().includes(m.toLowerCase()),n=j==="all"||j==="bookmarked"&&t.bookmark;return s&&n});return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-2",children:e.jsxs(N,{to:`/project/${o}/item/add`,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 transition-colors duration-200 w-full sm:w-auto",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Add Item"]})}),e.jsx("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 pb-0 mb-2",children:e.jsxs("div",{className:"space-y-0",children:[e.jsxs("div",{className:"relative pt-2",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(le,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-base",placeholder:"Search items...",value:m,onChange:t=>f(t.target.value)})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 rounded-lg",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500 h-4 w-4",onChange:t=>z(t.target.checked),checked:a.size===x.length&&x.length>0}),e.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:"Select all"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[a.size>0&&e.jsxs("span",{className:"text-sm text-gray-500",children:[a.size," of ",x.length," selected"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>w(!P),className:`filter-button inline-flex items-center justify-center px-3 py-2 border text-sm font-medium rounded-md transition-colors duration-200 ${j==="all"?"border-gray-300 text-gray-700 bg-white hover:bg-gray-50":"border-primary-500 text-primary-600 bg-primary-50 hover:bg-primary-100"}`,title:"Filter items",children:e.jsx(ce,{className:"h-4 w-4"})}),P&&e.jsx("div",{className:"filter-menu absolute top-full left-0 mt-1 w-40 bg-white border border-gray-200 rounded-md shadow-lg z-10",children:e.jsxs("div",{className:"py-1",children:[e.jsx("button",{onClick:()=>{D("all"),w(!1)},className:`block w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${j==="all"?"bg-primary-50 text-primary-600":"text-gray-700"}`,children:"All Items"}),e.jsx("button",{onClick:()=>{D("bookmarked"),w(!1)},className:`block w-full text-left px-3 py-2 text-sm hover:bg-gray-50 ${j==="bookmarked"?"bg-primary-50 text-primary-600":"text-gray-700"}`,children:"Bookmarked Only"})]})})]}),e.jsx("button",{className:"inline-flex items-center justify-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 transition-colors duration-200",disabled:a.size===0,title:"Generate QR Codes",children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx("button",{onClick:q,className:"inline-flex items-center justify-center px-3 py-2 border border-red-300 text-sm font-medium rounded-md text-red-700 bg-red-50 hover:bg-red-100 disabled:opacity-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200",disabled:a.size===0,title:"Delete All",children:e.jsx(re,{className:"h-4 w-4"})})]})]})]})]})}),v&&e.jsxs("div",{className:"text-center py-12 px-4",children:[e.jsx("div",{className:"mx-auto h-16 w-16 text-gray-400 animate-spin mb-4",children:e.jsxs("svg",{fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Loading inventory..."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Fetching your project items."})]}),i&&e.jsxs("div",{className:"text-center py-12 px-4",children:[e.jsx("div",{className:"mx-auto h-16 w-16 text-red-400 mb-4",children:"‚ö†Ô∏è"}),e.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Error loading inventory"}),e.jsx("p",{className:"text-sm text-red-500 mb-6 max-w-sm mx-auto",children:i}),e.jsxs("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-red-600 hover:bg-red-700 transition-colors duration-200 w-full sm:w-auto max-w-xs",children:[e.jsx(me,{className:"h-5 w-5 mr-2"}),"Retry"]})]}),!v&&!i&&I.length===0?e.jsxs("div",{className:"text-center py-12 px-4",children:[e.jsx("div",{className:"mx-auto h-16 w-16 text-gray-400 -mb-1",children:"üì¶"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No items yet"})]}):!v&&!i&&e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:I.map(t=>e.jsxs("li",{className:"relative bg-gray-50 transition-colors duration-200 hover:bg-gray-100 active:bg-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-0 px-4 py-3",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500 h-4 w-4 flex-shrink-0",checked:a.has(t.item_id),onChange:s=>R(t.item_id,s.target.checked)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:s=>{s.preventDefault(),s.stopPropagation(),M(t.item_id)},className:`inline-flex items-center justify-center p-2 border text-sm font-medium rounded-md transition-colors ${t.bookmark?"border-red-300 text-red-700 bg-red-50 hover:bg-red-100":"border-gray-300 text-gray-700 bg-white hover:bg-gray-50"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500`,title:t.bookmark?"Remove Bookmark":"Add Bookmark",children:e.jsx(xe,{className:"h-4 w-4",fill:t.bookmark?"currentColor":"none"})}),e.jsx(N,{to:`/project/${o}/edit-item/${t.item_id}`,onClick:s=>s.stopPropagation(),className:"inline-flex items-center justify-center p-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors",title:"Edit item",children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsxs("div",{className:"relative ml-1",children:[e.jsxs("span",{onClick:s=>{s.preventDefault(),s.stopPropagation(),Q(t.item_id)},className:`disposition-badge ${$(t.disposition)}`,children:[t.disposition==="to return"?"To Return":t.disposition?t.disposition.charAt(0).toUpperCase()+t.disposition.slice(1):"Not Set",e.jsx(ue,{className:"h-3 w-3 ml-1"})]}),S===t.item_id&&e.jsx("div",{className:"disposition-menu absolute top-full left-0 mt-1 w-32 bg-white border border-gray-200 rounded-md shadow-lg z-10",children:e.jsx("div",{className:"py-1",children:["keep","to return","returned","inventory"].map(s=>e.jsx("button",{onClick:n=>{n.preventDefault(),n.stopPropagation(),U(t.item_id,s)},className:`block w-full text-left px-3 py-2 text-xs hover:bg-gray-50 ${t.disposition===s||s==="to return"&&t.disposition==="return"?"bg-gray-100 text-gray-900":"text-gray-700"}`,disabled:!t.disposition,children:s==="to return"?"To Return":s.charAt(0).toUpperCase()+s.slice(1)},s))})})]})]})]}),e.jsx(N,{to:`/item/${t.item_id}?project=${o}`,children:e.jsx("div",{className:"block bg-transparent",children:e.jsxs("div",{className:"px-4 pb-3 sm:px-6",children:[e.jsxs("div",{className:"flex items-center gap-3 py-3",children:[e.jsx("div",{className:"flex-shrink-0",children:t.images&&t.images.length>0?(()=>{const s=t.images.find(n=>n.isPrimary)||t.images[0];return e.jsx("div",{className:"w-16 h-16 rounded-lg overflow-hidden border-2 border-gray-200",children:e.jsx("img",{src:s.url,alt:s.alt||"Item image",className:"w-full h-full object-cover"})})})():e.jsx("button",{onClick:s=>{s.preventDefault(),s.stopPropagation(),W(t.item_id)},disabled:B.has(t.item_id),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:border-gray-400 transition-colors disabled:opacity-50",title:"Add image (camera or gallery)",children:e.jsx(ge,{className:"h-6 w-6"})})}),e.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-medium text-gray-900 line-clamp-2 break-words",children:t.description}),t.space&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.space})]})})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-sm text-gray-500",children:[t.price&&e.jsxs("span",{className:"font-medium text-gray-700",children:["$",t.price]}),t.source&&e.jsxs(e.Fragment,{children:[t.price&&e.jsx("span",{className:"hidden sm:inline",children:"‚Ä¢"}),e.jsx("span",{className:"font-medium text-gray-700",children:t.source})]}),t.sku&&e.jsxs(e.Fragment,{children:[(t.price||t.source)&&e.jsx("span",{className:"hidden sm:inline",children:"‚Ä¢"}),e.jsx("span",{className:"font-medium text-gray-700",children:t.sku})]})]})})]})})})]},t.item_id))})})]})}const H=()=>{document.querySelectorAll(".no-icon").forEach(p=>{Array.from(p.childNodes).forEach(f=>{f.nodeType!==Node.TEXT_NODE&&p.removeChild(f)})})};function ke({projectId:o}){const{id:p}=te(),m=o||p,[f,a]=l.useState([]),[b,x]=l.useState(!0),[g,v]=l.useState(!1);l.useEffect(()=>{(async()=>{if(!m){x(!1);return}try{const u=await A.getTransactions(m);a(u)}catch(u){console.error("Error loading transactions:",u),a([])}finally{x(!1)}})()},[m]),l.useEffect(()=>m?A.subscribeToTransactions(m,u=>{a(u)}):void 0,[m]);const y=g?f.filter(i=>i.status==="pending"):f;return l.useEffect(()=>{H();const i=setTimeout(H,100),u=setTimeout(H,500);return()=>{clearTimeout(i),clearTimeout(u)}},[f]),b?e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(N,{to:`/project/${m}/transaction/add`,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 transition-colors duration-200",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Add Transaction"]}),e.jsxs("button",{onClick:()=>v(!g),className:`inline-flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors ${g?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),g?"Show All":"Show Pending Only"]})]}),g&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",y.length," pending transaction",y.length!==1?"s":""]})]}),y.length===0?e.jsxs("div",{className:"text-center py-12 px-4",children:[e.jsx("div",{className:"mx-auto h-16 w-16 text-gray-400 -mb-1",children:"üßæ"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:g?"No pending transactions":"No transactions yet"}),g&&e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"All transactions have been completed or cancelled."})]}):e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:y.map(i=>e.jsx("li",{className:"relative",children:e.jsx(N,{to:`/project/${m}/transaction/${i.transaction_id}`,className:"block bg-gray-50 transition-colors duration-200 hover:bg-gray-100 active:bg-gray-200",children:e.jsxs("div",{className:"px-4 py-4 sm:px-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("h3",{className:"text-base font-medium text-gray-900",children:i.source})}),e.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[i.status==="pending"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[e.jsx(Y,{className:"h-3 w-3 mr-1"}),"Pending"]}),i.status==="completed"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(he,{className:"h-3 w-3 mr-1"}),"Completed"]}),i.status==="cancelled"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[e.jsx(pe,{className:"h-3 w-3 mr-1"}),"Cancelled"]}),i.reimbursement_type&&e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${i.reimbursement_type==="Client owes us"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:i.reimbursement_type}),i.budget_category&&e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${i.budget_category==="Design Fee"?"bg-amber-100 text-amber-800":i.budget_category==="Furnishings"?"bg-yellow-100 text-yellow-800":i.budget_category==="Property Management"?"bg-orange-100 text-orange-800":i.budget_category==="Kitchen"?"bg-amber-200 text-amber-900":i.budget_category==="Install"?"bg-yellow-200 text-yellow-900":i.budget_category==="Storage & Receiving"?"bg-orange-200 text-orange-900":i.budget_category==="Fuel"?"bg-amber-300 text-amber-900":"bg-gray-100 text-gray-800"}`,children:i.budget_category}),e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium no-icon ${i.transaction_type==="Purchase"?"bg-green-100 text-green-800":i.transaction_type==="Return"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:i.transaction_type})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center flex-wrap gap-x-4 gap-y-1 text-sm text-gray-500",children:[e.jsx("span",{className:"font-medium text-gray-700",children:be(i.amount)}),e.jsx("span",{className:"hidden sm:inline",children:"‚Ä¢"}),e.jsx("span",{className:"font-medium text-gray-700 capitalize",children:i.payment_method}),e.jsx("span",{className:"hidden sm:inline",children:"‚Ä¢"}),e.jsx("span",{className:"font-medium text-gray-700",children:je(i.transaction_date)})]}),i.notes&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:i.notes})]})]})})},i.transaction_id))})})]})}function Le(){var T;const{id:o}=te(),p=ne(),[m,f]=ie(),[a,b]=l.useState(null),[x,g]=l.useState([]),[v,y]=l.useState(!0),[i,u]=l.useState(null),[B,k]=l.useState(!1),[S,C]=l.useState(!1),[j,D]=l.useState(!1),{showError:P}=ee(),w=m.get("tab")||"transactions",[E,O]=l.useState("budget"),z=r=>{const c=new URLSearchParams(m);c.set("tab",r),f(c)},R=r=>{O(r)},M=()=>x.filter(r=>r.payment_method==="1584 Design").reduce((r,c)=>r+parseFloat(c.amount||"0"),0),U=()=>x.filter(r=>r.transaction_type==="To Inventory").reduce((r,c)=>r+parseFloat(c.amount||"0"),0),Q=()=>{const r=x.filter(F=>F.status==="pending");let c=0,K=0;return r.forEach(F=>{const V=parseFloat(F.amount||"0");F.reimbursement_type==="Client owes us"?c+=V:F.reimbursement_type==="We owe client"&&(K+=V)}),{clientOwesUs:c,weOweClient:K}},$=async()=>{if(!o){console.warn("No project ID provided, redirecting to projects"),p("/projects");return}y(!0);try{console.log("Loading project data for ID:",o);const r=await L.getProject(o);if(r){console.log("Project loaded successfully:",r.name),b(r);const c=await A.getTransactions(o);console.log("Transactions loaded:",c.length),g(c)}else console.warn("Project not found:",o),p("/projects")}catch(r){console.error("Error loading project:",r),u("Failed to load project. Please try again."),y(!1)}finally{y(!1)}};l.useEffect(()=>{$()},[o,p]);const W=()=>{u(null),$()};l.useEffect(()=>o?A.subscribeToTransactions(o,c=>{g(c)}):void 0,[o]);const X=async r=>{if(!(!a||!o))try{await L.updateProject(o,r);const c=await L.getProject(o);b(c),k(!1)}catch(c){throw console.error("Error updating project:",c),c}},q=()=>{k(!0)},I=()=>{k(!1)},t=()=>{C(!0)},s=()=>{C(!1)},n=async()=>{if(o){D(!0);try{await L.deleteProject(o),p("/projects")}catch(r){console.error("Error deleting project:",r),D(!1),C(!1),P("Failed to delete project. Please try again.")}}},d=[{id:"transactions",name:"Transactions",icon:Z},{id:"inventory",name:"Inventory",icon:fe}],h=[{id:"budget",name:"Budget",icon:Z},{id:"accounting",name:"Accounting",icon:ye}];return v?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Loading project..."})]})}):i?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto h-12 w-12 text-red-400",children:"‚ö†Ô∏è"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Error Loading Project"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:i}),e.jsxs("div",{className:"mt-6 flex justify-center space-x-3",children:[e.jsx("button",{onClick:W,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700",children:"Try Again"}),e.jsxs(N,{to:"/projects",className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Back to Projects"]})]})]}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(N,{to:"/projects",className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700",children:[e.jsx(G,{className:"h-4 w-4 mr-1"}),"Back"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:q,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs("button",{onClick:t,className:"inline-flex items-center px-3 py-2 border border-red-300 shadow-sm text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:a.name}),a.clientName&&e.jsx("p",{className:"text-lg text-gray-600 mb-6",children:a.clientName})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:h.map(r=>{const c=r.icon;return e.jsxs("button",{onClick:()=>R(r.id),className:`py-4 px-1 border-b-2 font-medium text-base flex items-center ${E===r.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),r.name]},r.id)})})}),e.jsxs("div",{className:"pt-6",children:[E==="budget"&&a&&e.jsx(we,{budget:a.budget,designFee:a.designFee,budgetCategories:a.budgetCategories,transactions:x}),E==="accounting"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-0.5",children:"Owed to 1584"}),e.jsxs("div",{className:"text-xl font-bold text-gray-900",children:["$",M().toFixed(2)]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-0.5",children:"Owed to Client"}),e.jsxs("div",{className:"text-xl font-bold text-gray-900",children:["$",U().toFixed(2)]})]})]}),(()=>{const r=Q();return r.clientOwesUs>0||r.weOweClient>0?e.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsx("div",{className:"text-sm font-medium text-yellow-800 mb-2",children:"Pending Transactions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.clientOwesUs>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-yellow-600",children:"Client owes us"}),e.jsxs("div",{className:"text-lg font-semibold text-yellow-900",children:["$",r.clientOwesUs.toFixed(2)]})]}),r.weOweClient>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-yellow-600",children:"We owe client"}),e.jsxs("div",{className:"text-lg font-semibold text-yellow-900",children:["$",r.weOweClient.toFixed(2)]})]})]})]}):null})()]})]})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8 px-6",children:d.map(r=>{const c=r.icon;return e.jsxs("button",{onClick:()=>z(r.id),className:`py-4 px-1 border-b-2 font-medium text-base flex items-center ${w===r.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),r.name]},r.id)})})}),e.jsxs("div",{className:"px-6 py-6",children:[w==="inventory"&&e.jsx(ve,{projectId:a.id,projectName:a.name}),w==="transactions"&&e.jsx(ke,{projectId:a.id})]})]}),B&&a&&e.jsx(Ne,{initialData:{name:a.name,description:a.description,clientName:a.clientName,budget:a.budget,designFee:a.designFee,budgetCategories:a.budgetCategories},onSubmit:X,onCancel:I}),S&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Delete"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Are you sure you want to delete the project ",e.jsxs("strong",{children:['"',a==null?void 0:a.name,'"']}),"? This action cannot be undone and will permanently delete the project and all associated data."]}),a&&((T=a.metadata)==null?void 0:T.totalItems)&&a.metadata.totalItems>0&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3 mb-4",children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3",children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"Warning"}),e.jsx("div",{className:"mt-1 text-sm text-yellow-700",children:e.jsxs("p",{children:["This project contains ",a.metadata.totalItems," item(s). Deleting the project will permanently remove all associated data."]})})]})})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:s,disabled:j,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:n,disabled:j,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:j?"Deleting...":"Delete"})]})]})]})})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto h-12 w-12 text-gray-400",children:"üìÅ"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Project not found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"The project you're looking for doesn't exist."}),e.jsx("div",{className:"mt-6",children:e.jsxs(N,{to:"/projects",className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Back to Projects"]})})]})}export{Le as default};
//# sourceMappingURL=ProjectDetail.js.map
