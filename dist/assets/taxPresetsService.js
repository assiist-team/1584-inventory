import{s as n}from"./index.js";const s=[{id:"nv",name:"NV",rate:8.375},{id:"ut",name:"UT",rate:7.1},{id:"ca",name:"CA",rate:7.25},{id:"tx",name:"TX",rate:6.25},{id:"az",name:"AZ",rate:8.6}];async function f(a){try{const{data:e,error:t}=await n.from("tax_presets").select("presets").eq("account_id",a).single();if(t){if(t.code==="PGRST116")return await d(a,s),s;throw t}return e.presets&&Array.isArray(e.presets)&&e.presets.length>0?e.presets:(await d(a,s),s)}catch(e){return console.error("Error fetching tax presets from Postgres:",e),s}}async function d(a,e){try{if(!Array.isArray(e)||e.length===0)throw new Error("Presets must be a non-empty array");if(e.length>5)throw new Error("Cannot have more than 5 tax presets");for(const r of e){if(!r.id||!r.name||typeof r.rate!="number")throw new Error("Each preset must have id, name, and rate fields");if(r.rate<0||r.rate>100)throw new Error("Tax rate must be between 0 and 100")}const t=e.map(r=>r.id);if(new Set(t).size!==t.length)throw new Error("Preset IDs must be unique");const{data:o,error:i}=await n.from("tax_presets").select("account_id").eq("account_id",a).single(),u=!o||i&&i.code==="PGRST116",c={account_id:a,presets:e,updated_at:new Date().toISOString()};if(u){const{error:r}=await n.from("tax_presets").insert(c);if(r)throw r}else{const{error:r}=await n.from("tax_presets").update(c).eq("account_id",a);if(r)throw r}console.log("Tax presets updated successfully")}catch(t){throw console.error("Error updating tax presets:",t),t}}async function w(a,e){return(await f(a)).find(o=>o.id===e)||null}export{w as a,f as g,d as u};
//# sourceMappingURL=taxPresetsService.js.map
