{"version":3,"file":"ProjectInvoice.js","sources":["../../src/pages/ProjectInvoice.tsx"],"sourcesContent":["import { useEffect, useMemo, useState } from 'react'\nimport { useParams } from 'react-router-dom'\nimport { useStackedNavigate } from '@/hooks/useStackedNavigate'\nimport { Button } from '@/components/ui/Button'\nimport type { Item, Project, Transaction } from '@/types'\nimport { formatDate } from '@/utils/dateUtils'\nimport { projectService, transactionService, unifiedItemsService } from '@/services/inventoryService'\nimport { useAccount } from '@/contexts/AccountContext'\nimport { useBusinessProfile } from '@/contexts/BusinessProfileContext'\nimport { COMPANY_INVENTORY_SALE, COMPANY_INVENTORY_PURCHASE, CLIENT_OWES_COMPANY, COMPANY_OWES_CLIENT, COMPANY_PROJECT_PORTAL_LOGO_ALT } from '@/constants/company'\n\ntype InvoiceItemLine = {\n  item: Item\n  amount: number\n  missingPrice: boolean\n}\n\ntype InvoiceTransactionLine = {\n  transaction: Transaction\n  items: InvoiceItemLine[]\n  hasItems: boolean\n  lineTotal: number\n}\n\nconst usd = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' })\n\nconst getCanonicalTransactionTitle = (transaction: Transaction): string => {\n  if (transaction.transactionId?.startsWith('INV_SALE_')) return COMPANY_INVENTORY_SALE\n  if (transaction.transactionId?.startsWith('INV_PURCHASE_')) return COMPANY_INVENTORY_PURCHASE\n  return transaction.source\n}\n\nfunction toNumber(value: string | number | null | undefined): number {\n  if (typeof value === 'number') return isNaN(value) ? 0 : value\n  if (typeof value === 'string') {\n    const n = parseFloat(value || '0')\n    return isNaN(n) ? 0 : n\n  }\n  return 0\n}\n\nexport default function ProjectInvoice() {\n  const { id: projectId } = useParams<{ id: string }>()\n  const navigate = useStackedNavigate()\n  const { currentAccountId } = useAccount()\n  const { businessName, businessLogoUrl } = useBusinessProfile()\n\n  const [project, setProject] = useState<Project | null>(null)\n  const [clientOwesLines, setClientOwesLines] = useState<InvoiceTransactionLine[]>([])\n  const [creditLines, setCreditLines] = useState<InvoiceTransactionLine[]>([])\n  const [isLoading, setIsLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n\n  const today = useMemo(() => new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' }), [])\n\n  useEffect(() => {\n    const load = async () => {\n      if (!projectId || !currentAccountId) {\n        if (!currentAccountId) return // Wait for account to load\n        navigate('/projects')\n        return\n      }\n\n      setIsLoading(true)\n      setError(null)\n      try {\n        const [proj, txs] = await Promise.all([\n          projectService.getProject(currentAccountId, projectId),\n          transactionService.getTransactions(currentAccountId, projectId)\n        ])\n\n        if (!proj) {\n          navigate('/projects')\n          return\n        }\n\n        setProject(proj)\n\n        const invoiceable = txs\n          .filter(t => t.status !== 'canceled')\n          .filter(t => (t.reimbursementType === CLIENT_OWES_COMPANY || t.reimbursementType === COMPANY_OWES_CLIENT))\n\n        // Sort by transaction_date ascending within each group later\n        // Fetch items for each transaction in parallel\n        const lines = await Promise.all(invoiceable.map(async (tx): Promise<InvoiceTransactionLine> => {\n        const items: Item[] = await unifiedItemsService.getItemsForTransaction(currentAccountId, projectId, tx.transactionId)\n\n          const itemLines: InvoiceItemLine[] = items.map((it) => {\n            const projectPriceValue = it.projectPrice\n            const hasPrice = !!projectPriceValue && String(projectPriceValue).trim() !== ''\n            const amt = hasPrice ? toNumber(projectPriceValue || '0') : 0\n            return { item: it, amount: amt, missingPrice: !hasPrice }\n          })\n\n          const hasItems = itemLines.length > 0\n          const lineTotal = hasItems\n            ? itemLines.reduce((sum, l) => sum + l.amount, 0)\n            : toNumber(tx.amount)\n\n          return { transaction: tx, items: itemLines, hasItems, lineTotal }\n        }))\n\n        const clientOwes = lines\n          .filter(l => l.transaction.reimbursementType === CLIENT_OWES_COMPANY)\n          .sort((a, b) => (a.transaction.transactionDate || '').localeCompare(b.transaction.transactionDate || ''))\n\n        const credits = lines\n          .filter(l => l.transaction.reimbursementType === COMPANY_OWES_CLIENT)\n          .sort((a, b) => (a.transaction.transactionDate || '').localeCompare(b.transaction.transactionDate || ''))\n\n        setClientOwesLines(clientOwes)\n        setCreditLines(credits)\n      } catch (e: any) {\n        console.error('Failed to load invoice data:', e)\n        setError('Failed to load invoice data. Please try again.')\n      } finally {\n        setIsLoading(false)\n      }\n    }\n\n    load()\n  }, [projectId, currentAccountId, navigate])\n\n  const clientOwesSubtotal = useMemo(() => clientOwesLines.reduce((sum, l) => sum + l.lineTotal, 0), [clientOwesLines])\n  const creditsSubtotal = useMemo(() => creditLines.reduce((sum, l) => sum + l.lineTotal, 0), [creditLines])\n  const netDue = useMemo(() => clientOwesSubtotal - creditsSubtotal, [clientOwesSubtotal, creditsSubtotal])\n\n  const handlePrint = () => window.print()\n  const handleBack = () => {\n    if (!projectId) return navigate('/projects')\n    navigate(`/project/${projectId}?tab=transactions&budgetTab=accounting`)\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"flex justify-center items-center h-64\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto\"></div>\n          <p className=\"mt-2 text-sm text-gray-600\">Building invoice...</p>\n        </div>\n      </div>\n    )\n  }\n\n  if (error) {\n    return (\n      <div className=\"text-center py-12\">\n        <div className=\"mx-auto h-12 w-12 text-red-400\">‚ö†Ô∏è</div>\n        <h3 className=\"mt-2 text-sm font-medium text-gray-900\">Error</h3>\n        <p className=\"mt-1 text-sm text-gray-500\">{error}</p>\n        <div className=\"mt-6\">\n          <Button onClick={handleBack}>Back</Button>\n        </div>\n      </div>\n    )\n  }\n\n  const hasAnyLines = clientOwesLines.length > 0 || creditLines.length > 0\n\n  return (\n    <div className=\"max-w-4xl mx-auto bg-white shadow rounded-lg p-8 print:shadow-none print:p-0\">\n      {/* Action bar */}\n      <div className=\"flex justify-end space-x-3 mb-6 print:hidden\">\n        <Button variant=\"secondary\" onClick={handleBack}>Back</Button>\n        <Button onClick={handlePrint}>Print</Button>\n      </div>\n\n      {/* Header */}\n      <div className=\"border-b pb-4 mb-6\">\n        <div className=\"flex items-start gap-4\">\n          {businessLogoUrl && (\n            <img\n              src={businessLogoUrl}\n              alt={businessName}\n              className=\"h-24 w-auto object-contain\"\n            />\n          )}\n          <div>\n            <h1 className=\"text-2xl font-bold text-gray-900\">Invoice</h1>\n            <div className=\"mt-1 text-sm text-gray-600\">\n              <div className=\"font-medium text-gray-800\">{project?.name || 'Project'}</div>\n              {project?.clientName && <div>Client: {project.clientName}</div>}\n              <div>Date: {today}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {!hasAnyLines && (\n        <div className=\"text-center py-12\">\n          <div className=\"mx-auto h-12 w-12 text-gray-400\">üßæ</div>\n          <h3 className=\"mt-2 text-sm font-medium text-gray-900\">No invoiceable items</h3>\n          <p className=\"mt-1 text-sm text-gray-500\">There are no qualifying transactions for this project.</p>\n        </div>\n      )}\n\n      {hasAnyLines && (\n        <div className=\"space-y-10\">\n          {/* Client Owes section */}\n          <section>\n            <div className=\"flex items-baseline justify-between mb-3\">\n              <h2 className=\"text-lg font-semibold text-gray-900\">Project Charges</h2>\n            </div>\n\n            <div className=\"rounded-lg border border-gray-100 overflow-hidden\">\n              <div className=\"divide-y\">\n                {clientOwesLines.map(line => {\n                const transactionTitle = getCanonicalTransactionTitle(line.transaction)\n                const formattedDate = formatDate(\n                  line.transaction.transactionDate,\n                  '',\n                  {\n                    year: undefined,\n                    month: 'short',\n                    day: 'numeric'\n                  }\n                )\n\n                return (\n                  <div key={line.transaction.transactionId} className=\"py-4 px-4\">\n                    <div className=\"flex items-start justify-between\">\n                      <div>\n                        <div className=\"flex flex-wrap items-center gap-x-2 gap-y-1 text-gray-900\">\n                          <span className=\"font-medium\">{transactionTitle}</span>\n                          {formattedDate && <span className=\"text-xs font-normal text-gray-500\">{formattedDate}</span>}\n                        </div>\n                        {line.transaction.notes && (\n                          <div className=\"text-sm text-gray-500\">{line.transaction.notes}</div>\n                        )}\n                      </div>\n                      <div className=\"text-right text-gray-700\">{usd.format(line.lineTotal)}</div>\n                    </div>\n\n                    {line.hasItems && (\n                      <div className=\"mt-2 ml-4\">\n                        <ul className=\"space-y-1\">\n                          {line.items.map((it) => (\n                            <li key={it.item.itemId} className=\"flex items-start justify-between text-sm\">\n                              <div className=\"text-gray-700\">\n                                {it.item.description || 'Item'}\n                                {it.missingPrice && (\n                                  <span className=\"ml-2 text-yellow-700 bg-yellow-50 border border-yellow-200 rounded px-1\">Missing project price</span>\n                                )}\n                              </div>\n                              <div className=\"pr-4 text-right text-gray-600\">{usd.format(it.amount)}</div>\n                            </li>\n                          ))}\n                        </ul>\n                      </div>\n                    )}\n                  </div>\n                )\n              })}\n              </div>\n              <div className=\"flex items-center justify-between px-4 py-3 bg-white border-t border-gray-100\">\n                <span className=\"text-base font-semibold text-gray-900\">Charges Total</span>\n                <span className=\"text-base font-semibold text-gray-900\">{usd.format(clientOwesSubtotal)}</span>\n              </div>\n            </div>\n          </section>\n\n          {/* Credits section */}\n          <section>\n            <div className=\"flex items-baseline justify-between mb-3\">\n              <h2 className=\"text-lg font-semibold text-gray-900\">Project Credits</h2>\n            </div>\n\n            <div className=\"rounded-lg border border-gray-100 overflow-hidden\">\n              <div className=\"divide-y\">\n                {creditLines.map(line => {\n                const transactionTitle = getCanonicalTransactionTitle(line.transaction)\n                const formattedDate = formatDate(\n                  line.transaction.transactionDate,\n                  '',\n                  {\n                    year: undefined,\n                    month: 'short',\n                    day: 'numeric'\n                  }\n                )\n\n                return (\n                  <div key={line.transaction.transactionId} className=\"py-4 px-4\">\n                    <div className=\"flex items-start justify-between\">\n                      <div>\n                        <div className=\"flex flex-wrap items-center gap-x-2 gap-y-1 text-gray-900\">\n                          <span className=\"font-medium\">{transactionTitle}</span>\n                          {formattedDate && <span className=\"text-xs font-normal text-gray-500\">{formattedDate}</span>}\n                        </div>\n                        {line.transaction.notes && (\n                          <div className=\"text-sm text-gray-500\">{line.transaction.notes}</div>\n                        )}\n                      </div>\n                      <div className=\"text-right text-gray-700\">{usd.format(line.lineTotal)}</div>\n                    </div>\n\n                    {line.hasItems && (\n                      <div className=\"mt-2 ml-4\">\n                        <ul className=\"space-y-1\">\n                          {line.items.map((it) => (\n                            <li key={it.item.itemId} className=\"flex items-start justify-between text-sm\">\n                              <div className=\"text-gray-700\">\n                                {it.item.description || 'Item'}\n                                {it.missingPrice && (\n                                  <span className=\"ml-2 text-yellow-700 bg-yellow-50 border border-yellow-200 rounded px-1\">Missing project price</span>\n                                )}\n                              </div>\n                              <div className=\"pr-4 text-right text-gray-600\">{usd.format(it.amount)}</div>\n                            </li>\n                          ))}\n                        </ul>\n                      </div>\n                    )}\n                  </div>\n                )\n              })}\n              </div>\n              <div className=\"flex items-center justify-between px-4 py-3 bg-white border-t border-gray-100\">\n                <span className=\"text-base font-semibold text-gray-900\">Credits Total</span>\n                <span className=\"text-base font-semibold text-gray-900\">{usd.format(creditsSubtotal)}</span>\n              </div>\n            </div>\n          </section>\n\n          {/* Net Due */}\n          <section className=\"border-t pt-4\">\n            <div className=\"flex items-baseline justify-between\">\n          <h2 className=\"text-xl font-semibold text-primary-600\">Net Amount Due</h2>\n          <div className=\"text-xl font-bold text-primary-600\">{usd.format(netDue)}</div>\n            </div>\n          </section>\n        </div>\n      )}\n    </div>\n  )\n}\n\n\n"],"names":["usd","getCanonicalTransactionTitle","transaction","_a","COMPANY_INVENTORY_SALE","_b","COMPANY_INVENTORY_PURCHASE","toNumber","value","ProjectInvoice","projectId","useParams","navigate","useStackedNavigate","currentAccountId","useAccount","businessName","businessLogoUrl","useBusinessProfile","project","setProject","useState","clientOwesLines","setClientOwesLines","creditLines","setCreditLines","isLoading","setIsLoading","error","setError","today","useMemo","useEffect","proj","txs","projectService","transactionService","invoiceable","t","CLIENT_OWES_COMPANY","COMPANY_OWES_CLIENT","lines","tx","itemLines","unifiedItemsService","it","projectPriceValue","hasPrice","amt","hasItems","lineTotal","sum","l","clientOwes","b","credits","e","clientOwesSubtotal","creditsSubtotal","netDue","handlePrint","handleBack","jsxs","jsx","Button","hasAnyLines","line","transactionTitle","formattedDate","formatDate"],"mappings":"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"}