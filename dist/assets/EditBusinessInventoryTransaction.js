import{j as e}from"./index.js";import{r as o}from"./vendor.js";import{b as C,c as F,L as g}from"./router.js";import{p as S,t as p}from"./inventoryService.js";import{e as I,b as P,r as T}from"./ui.js";import"./firebase.js";function q(){const{projectId:l,transactionId:c}=C(),m=F(),[y,b]=o.useState(!0),[u,x]=o.useState(!1),[j,f]=o.useState([]),[v,N]=o.useState(null),[a,h]=o.useState({project_id:"",transaction_date:"",source:"",transaction_type:"Reimbursement",payment_method:"Pending",amount:"",budget_category:"Furnishings",notes:"",status:"pending",reimbursement_type:"Client Owes",trigger_event:"Manual",receipt_emailed:!1}),[s,d]=o.useState({});o.useEffect(()=>{(async()=>{try{const[i,r]=await Promise.all([S.getProjects(),l&&c?p.getTransaction(l,c):null]);f(i),r&&(N(r),h({project_id:r.project_id,transaction_date:r.transaction_date,source:r.source,transaction_type:r.transaction_type,payment_method:r.payment_method,amount:r.amount,budget_category:r.budget_category||"Furnishings",notes:r.notes||"",status:r.status||"pending",reimbursement_type:r.reimbursement_type||"Client Owes",trigger_event:r.trigger_event||"Manual",receipt_emailed:r.receipt_emailed}))}catch(i){console.error("Error loading data:",i)}finally{b(!1)}})()},[l,c]);const n=(t,i)=>{h(r=>({...r,[t]:i})),s[t]&&d(r=>({...r,[t]:""}))},_=()=>{const t={};return a.project_id.trim()||(t.project_id="Project selection is required"),a.transaction_date.trim()||(t.transaction_date="Transaction date is required"),a.source.trim()||(t.source="Source is required"),a.amount.trim()||(t.amount="Amount is required"),d(t),Object.keys(t).length===0},w=async t=>{if(t.preventDefault(),!(!l||!c||!_())){x(!0);try{await p.updateTransaction(l,c,a),m("/business-inventory")}catch(i){console.error("Error updating transaction:",i),d({general:"Error updating transaction. Please try again."})}finally{x(!1)}}},k=()=>{m("/business-inventory")};return y?e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"})}):v?e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(g,{to:"/business-inventory",className:"mr-4 p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(I,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Business Inventory Transaction"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Update transaction details and information"})]})]})}),e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Project Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project_id",className:"block text-sm font-medium text-gray-700",children:"Project *"}),e.jsxs("select",{id:"project_id",value:a.project_id,onChange:t=>n("project_id",t.target.value),className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm ${s.project_id?"border-red-300":""}`,children:[e.jsx("option",{value:"",children:"Select a project..."}),j.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",t.clientName]},t.id))]}),s.project_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.project_id})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"transaction_date",className:"block text-sm font-medium text-gray-700",children:"Transaction Date *"}),e.jsx("input",{type:"date",id:"transaction_date",value:a.transaction_date,onChange:t=>n("transaction_date",t.target.value),className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm ${s.transaction_date?"border-red-300":""}`}),s.transaction_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.transaction_date})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Transaction Details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"source",className:"block text-sm font-medium text-gray-700",children:"Source *"}),e.jsx("input",{type:"text",id:"source",value:a.source,onChange:t=>n("source",t.target.value),className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm ${s.source?"border-red-300":""}`,placeholder:"e.g., Inventory Allocation, Client Purchase"}),s.source&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.source})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700",children:"Amount *"}),e.jsx("input",{type:"number",step:"0.01",id:"amount",value:a.amount,onChange:t=>n("amount",t.target.value),className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm ${s.amount?"border-red-300":""}`,placeholder:"0.00"}),s.amount&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.amount})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"budget_category",className:"block text-sm font-medium text-gray-700",children:"Budget Category"}),e.jsxs("select",{id:"budget_category",value:a.budget_category,onChange:t=>n("budget_category",t.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",children:[e.jsx("option",{value:"Furnishings",children:"Furnishings"}),e.jsx("option",{value:"Design Fee",children:"Design Fee"}),e.jsx("option",{value:"Property Management",children:"Property Management"}),e.jsx("option",{value:"Kitchen",children:"Kitchen"}),e.jsx("option",{value:"Install",children:"Install"}),e.jsx("option",{value:"Storage & Receiving",children:"Storage & Receiving"}),e.jsx("option",{value:"Fuel",children:"Fuel"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reimbursement_type",className:"block text-sm font-medium text-gray-700",children:"Reimbursement Type"}),e.jsxs("select",{id:"reimbursement_type",value:a.reimbursement_type,onChange:t=>n("reimbursement_type",t.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",children:[e.jsx("option",{value:"Client owes us",children:"Client owes us"}),e.jsx("option",{value:"We owe client",children:"We owe client"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{id:"status",value:a.status,onChange:t=>n("status",t.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notes"}),e.jsx("textarea",{id:"notes",rows:3,value:a.notes,onChange:t=>n("notes",t.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Additional notes about this transaction..."})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"receipt_emailed",checked:a.receipt_emailed,onChange:t=>n("receipt_emailed",t.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"receipt_emailed",className:"ml-2 block text-sm text-gray-700",children:"Receipt emailed to client"})]})]})]}),s.general&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsx("div",{className:"text-sm text-red-800",children:s.general})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-3 pt-6 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:k,className:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 transition-colors duration-200",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs("button",{type:"submit",disabled:u,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 transition-colors duration-200 disabled:opacity-50",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),u?"Updating Transaction...":"Update Transaction"]})]})]})]})})}):e.jsxs("div",{className:"text-center py-12 px-4",children:[e.jsx("div",{className:"mx-auto h-16 w-16 text-gray-400 -mb-1",children:"ðŸ§¾"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"Transaction not found"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"The transaction you're looking for doesn't exist or has been deleted."}),e.jsx(g,{to:"/business-inventory",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700",children:"Back to Business Inventory"})]})}export{q as default};
//# sourceMappingURL=EditBusinessInventoryTransaction.js.map
