import{j as e}from"./index.js";import{r as o}from"./vendor.js";import{b as _,c as w,L as p}from"./router.js";import{b}from"./inventoryService.js";import{e as I,b as S,s as C}from"./ui.js";import"./firebase.js";function B(){const{id:a}=_(),m=w(),[y,g]=o.useState(!0),[u,x]=o.useState(!1),[n,v]=o.useState(null),[r,h]=o.useState({description:"",source:"",sku:"",price:"",market_value:"",disposition:"keep",notes:"",bookmark:!1,business_inventory_location:"",inventory_status:"available"}),[t,l]=o.useState({});o.useEffect(()=>{a&&f()},[a]);const f=async()=>{if(a)try{const s=await b.getBusinessInventoryItem(a);s&&(v(s),h({description:s.description,source:s.source,sku:s.sku,price:s.price,market_value:s.market_value||"",disposition:s.disposition||"keep",notes:s.notes||"",bookmark:s.bookmark,business_inventory_location:s.business_inventory_location||"",inventory_status:s.inventory_status}))}catch(s){console.error("Error loading item:",s)}finally{g(!1)}},i=(s,c)=>{h(d=>({...d,[s]:c})),t[s]&&l(d=>({...d,[s]:""}))},j=()=>{const s={};return r.description.trim()||(s.description="Description is required"),r.source.trim()||(s.source="Source is required"),r.price.trim()||(s.price="Price is required"),r.business_inventory_location.trim()||(s.business_inventory_location="Location is required"),l(s),Object.keys(s).length===0},N=async s=>{if(s.preventDefault(),!(!a||!j())){x(!0);try{await b.updateBusinessInventoryItem(a,r),m(`/business-inventory/${a}`)}catch(c){console.error("Error updating item:",c),l({general:"Error updating item. Please try again."})}finally{x(!1)}}},k=()=>{m(`/business-inventory/${a}`)};return y?e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"})}):n?e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{to:`/business-inventory/${a}`,className:"mr-4 p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(I,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Business Inventory Item"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Update item details and information"})]})]})}),e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"General Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description *"}),e.jsx("input",{type:"text",id:"description",value:r.description,onChange:s=>i("description",s.target.value),className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm ${t.description?"border-red-300":""}`,placeholder:"e.g., Vintage leather armchair"}),t.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.description})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"source",className:"block text-sm font-medium text-gray-700",children:"Source *"}),e.jsx("input",{type:"text",id:"source",value:r.source,onChange:s=>i("source",s.target.value),className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm ${t.source?"border-red-300":""}`,placeholder:"e.g., purchased, found, donated"}),t.source&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.source})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sku",className:"block text-sm font-medium text-gray-700",children:"SKU"}),e.jsx("input",{type:"text",id:"sku",value:r.sku,onChange:s=>i("sku",s.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"e.g., CHR-001"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"business_inventory_location",className:"block text-sm font-medium text-gray-700",children:"Storage Location *"}),e.jsx("input",{type:"text",id:"business_inventory_location",value:r.business_inventory_location,onChange:s=>i("business_inventory_location",s.target.value),className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm ${t.business_inventory_location?"border-red-300":""}`,placeholder:"e.g., Warehouse A - Section 3 - Shelf 5"}),t.business_inventory_location&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.business_inventory_location})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:"Purchase Price *"}),e.jsx("input",{type:"number",step:"0.01",id:"price",value:r.price,onChange:s=>i("price",s.target.value),className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm ${t.price?"border-red-300":""}`,placeholder:"0.00"}),t.price&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.price})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"market_value",className:"block text-sm font-medium text-gray-700",children:"Market Value"}),e.jsx("input",{type:"number",step:"0.01",id:"market_value",value:r.market_value,onChange:s=>i("market_value",s.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"0.00"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Additional Details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notes"}),e.jsx("textarea",{id:"notes",rows:3,value:r.notes,onChange:s=>i("notes",s.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Additional notes about this item..."})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"bookmark",checked:r.bookmark,onChange:s=>i("bookmark",s.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"bookmark",className:"ml-2 block text-sm text-gray-700",children:"Bookmark this item"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Inventory Status"}),e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inventory_status",className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{id:"inventory_status",value:r.inventory_status,onChange:s=>i("inventory_status",s.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",children:[e.jsx("option",{value:"available",children:"Available"}),e.jsx("option",{value:"pending",children:"Allocated"}),e.jsx("option",{value:"sold",children:"Sold"})]})]})}),n.current_project_id&&e.jsx("div",{className:"mt-4 p-4 bg-yellow-50 rounded-md",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," This item is currently allocated to project ",n.current_project_id,". Changing the status may affect the pending transaction."]})})]}),t.general&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsx("div",{className:"text-sm text-red-800",children:t.general})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-3 pt-6 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:k,className:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 transition-colors duration-200",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs("button",{type:"submit",disabled:u,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 transition-colors duration-200 disabled:opacity-50",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),u?"Updating Item...":"Update Item"]})]})]})]})})}):e.jsxs("div",{className:"text-center py-12 px-4",children:[e.jsx("div",{className:"mx-auto h-16 w-16 text-gray-400 -mb-1",children:"ðŸ“¦"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"Item not found"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"The item you're looking for doesn't exist or has been deleted."}),e.jsx(p,{to:"/business-inventory",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700",children:"Back to Inventory"})]})}export{B as default};
//# sourceMappingURL=EditBusinessInventoryItem.js.map
