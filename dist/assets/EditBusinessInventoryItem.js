import{j as e}from"./index.js";import{r as l}from"./vendor.js";import{b as _,c as S,L as d}from"./router.js";import{b as h}from"./inventoryService.js";import{e as I,b,r as y}from"./ui.js";import"./firebase.js";function B(){const{id:o}=_(),f=S(),[g,v]=l.useState(!0),[c,x]=l.useState(!1),[m,j]=l.useState(null),[t,p]=l.useState({description:"",source:"",sku:"",price:"",market_value:"",disposition:"keep",notes:"",bookmark:!1,business_inventory_location:"",inventory_status:"available"}),[r,u]=l.useState({});l.useEffect(()=>{o&&N()},[o]);const N=async()=>{if(o)try{const s=await h.getBusinessInventoryItem(o);s&&(j(s),p({description:s.description,source:s.source,sku:s.sku,price:s.price,market_value:s.market_value||"",disposition:s.disposition||"keep",notes:s.notes||"",bookmark:s.bookmark,business_inventory_location:s.business_inventory_location||"",inventory_status:s.inventory_status}))}catch(s){console.error("Error loading item:",s)}finally{v(!1)}},i=(s,n)=>{p(a=>({...a,[s]:n})),r[s]&&u(a=>({...a,[s]:""}))},k=()=>{const s={};return t.description.trim()||(s.description="Description is required"),t.source.trim()||(s.source="Source is required"),t.price.trim()||(s.price="Price is required"),t.business_inventory_location.trim()||(s.business_inventory_location="Location is required"),u(s),Object.keys(s).length===0},w=async s=>{if(s.preventDefault(),!(!o||!k())){x(!0);try{await h.updateBusinessInventoryItem(o,t),f(`/business-inventory/${o}`)}catch(n){console.error("Error updating item:",n),u({general:"Error updating item. Please try again."})}finally{x(!1)}}};return g?e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"})}):m?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(d,{to:`/business-inventory/${o}`,className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700",children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),"Back"]})})}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Item"})}),e.jsx("div",{className:"px-6 py-4",children:e.jsxs("form",{onSubmit:w,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description *"}),e.jsx("input",{type:"text",id:"description",value:t.description,onChange:s=>i("description",s.target.value),placeholder:"e.g., Vintage leather armchair",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${r.description?"border-red-300":"border-gray-300"}`}),r.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.description})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"source",className:"block text-sm font-medium text-gray-700",children:"Source *"}),e.jsx("input",{type:"text",id:"source",value:t.source,onChange:s=>i("source",s.target.value),placeholder:"e.g., purchased, found, donated",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${r.source?"border-red-300":"border-gray-300"}`}),r.source&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.source})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sku",className:"block text-sm font-medium text-gray-700",children:"SKU"}),e.jsx("input",{type:"text",id:"sku",value:t.sku,onChange:s=>i("sku",s.target.value),placeholder:"e.g., CHR-001",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:"Purchase Price *"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"number",step:"0.01",id:"price",value:t.price,onChange:s=>i("price",s.target.value),placeholder:"0.00",className:`block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${r.price?"border-red-300":"border-gray-300"}`})]}),r.price&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.price})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"market_value",className:"block text-sm font-medium text-gray-700",children:"Market Value"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"number",step:"0.01",id:"market_value",value:t.market_value,onChange:s=>i("market_value",s.target.value),placeholder:"0.00",className:"mt-1 block w-full pl-8 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"business_inventory_location",className:"block text-sm font-medium text-gray-700",children:"Storage Location *"}),e.jsx("input",{type:"text",id:"business_inventory_location",value:t.business_inventory_location,onChange:s=>i("business_inventory_location",s.target.value),placeholder:"e.g., Warehouse A - Section 3 - Shelf 5",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${r.business_inventory_location?"border-red-300":"border-gray-300"}`}),r.business_inventory_location&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.business_inventory_location})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notes"}),e.jsx("textarea",{id:"notes",rows:3,value:t.notes,onChange:s=>i("notes",s.target.value),placeholder:"Additional notes about this item...",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inventory_status",className:"block text-sm font-medium text-gray-700",children:"Inventory Status"}),e.jsxs("select",{id:"inventory_status",value:t.inventory_status,onChange:s=>i("inventory_status",s.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",children:[e.jsx("option",{value:"available",children:"Available"}),e.jsx("option",{value:"pending",children:"Allocated"}),e.jsx("option",{value:"sold",children:"Sold"})]}),m.current_project_id&&e.jsx("div",{className:"mt-4 p-4 bg-yellow-50 rounded-md",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," This item is currently allocated to project ",m.current_project_id,". Changing the status may affect the pending transaction."]})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"bookmark",checked:t.bookmark,onChange:s=>i("bookmark",s.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"bookmark",className:"ml-2 block text-sm text-gray-700",children:"Bookmark this item"})]}),r.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsx("p",{className:"text-sm text-red-600",children:r.general})}),e.jsxs("div",{className:"hidden sm:flex justify-end sm:space-x-3 pt-4",children:[e.jsxs(d,{to:`/business-inventory/${o}`,className:"inline-flex justify-center items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs("button",{type:"submit",disabled:c,className:"inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),c?"Updating Item...":"Update Item"]})]})]})}),e.jsx("div",{className:"sm:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 z-50",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(d,{to:`/business-inventory/${o}`,className:"flex-1 inline-flex justify-center items-center px-4 py-3 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs("button",{type:"submit",disabled:c,onClick:s=>{var a;const n=(a=s.currentTarget.closest(".space-y-6"))==null?void 0:a.querySelector("form");n&&n.requestSubmit()},className:"flex-1 inline-flex justify-center items-center px-4 py-3 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),c?"Updating...":"Update"]})]})})]}),e.jsx("div",{className:"sm:hidden h-20"})]}):e.jsxs("div",{className:"text-center py-12 px-4",children:[e.jsx("div",{className:"mx-auto h-16 w-16 text-gray-400 -mb-1",children:"ðŸ“¦"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"Item not found"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"The item you're looking for doesn't exist or has been deleted."}),e.jsx(d,{to:"/business-inventory",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700",children:"Back to Inventory"})]})}export{B as default};
//# sourceMappingURL=EditBusinessInventoryItem.js.map
