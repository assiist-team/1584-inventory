import{u as b,U as a,d as p,j as e,b as U,f as W}from"./index.js";import{r as l}from"./vendor.js";import{y as C,w as G,x as O,m as V,A as $}from"./firebase.js";import{p as v,w as f,M as q,e as F,x as P,y as T}from"./ui.js";import"./router.js";function B({className:t}){const{user:r,hasRole:w}=b(),[E,I]=l.useState([]),[R,x]=l.useState(!0),[i,h]=l.useState(""),[c,u]=l.useState(a.VIEWER),[g,j]=l.useState(!1),[y,d]=l.useState(""),m=w(a.ADMIN);l.useEffect(()=>{m&&N()},[m]);const N=async()=>{try{x(!0);const s=C(G(p,"users")),n=(await O(s)).docs.map(k=>k.data());I(n)}catch(s){console.error("Error loading users:",s),d("Failed to load users")}finally{x(!1)}},D=async(s,o)=>{try{const n=V(p,"users",s);await $(n,{role:o}),await N()}catch(n){console.error("Error updating user role:",n),d("Failed to update user role")}},S=async()=>{if(i.trim())try{j(!0),d(""),await W(i.trim(),c,(r==null?void 0:r.id)||""),alert(`Invitation sent to ${i} with ${c} role. They can now sign up with Google and will be automatically assigned the ${c} role.`),h(""),u(a.VIEWER)}catch(s){console.error("Error inviting user:",s),d("Failed to send invitation")}finally{j(!1)}},M=s=>{switch(s){case a.OWNER:return e.jsx(P,{className:"h-4 w-4 text-yellow-500"});case a.ADMIN:return e.jsx(v,{className:"h-4 w-4 text-blue-500"});case a.DESIGNER:return e.jsx(F,{className:"h-4 w-4 text-green-500"});default:return e.jsx(f,{className:"h-4 w-4 text-gray-500"})}},A=s=>{switch(s){case a.OWNER:return"bg-yellow-100 text-yellow-800";case a.ADMIN:return"bg-blue-100 text-blue-800";case a.DESIGNER:return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return m?e.jsxs("div",{className:`p-6 ${t}`,children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(f,{className:"h-8 w-8 text-gray-400"})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"User Management"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Invite team members and manage user roles"})]})]}),y&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("div",{className:"text-sm text-red-600",children:y})}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Invite Team Member"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:i,onChange:s=>h(s.target.value),placeholder:"user@example.com",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Assign Role"}),e.jsxs("select",{value:c,onChange:s=>u(s.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",children:[e.jsx("option",{value:a.VIEWER,children:"Viewer"}),e.jsx("option",{value:a.DESIGNER,children:"Designer"}),e.jsx("option",{value:a.ADMIN,children:"Admin"}),e.jsx("option",{value:a.OWNER,children:"Owner"})]})]}),e.jsxs(U,{onClick:S,disabled:g||!i.trim(),className:"w-full flex items-center justify-center space-x-2",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx("span",{children:g?"Sending...":"Send Invitation"})]})]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Invited users can sign up with Google and will be automatically assigned the selected role."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Team Members"}),R?e.jsx("div",{className:"text-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600 mx-auto"})}):e.jsx("div",{className:"space-y-3",children:E.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[M(s.role),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.displayName}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${A(s.role)}`,children:s.role}),s.id!==(r==null?void 0:r.id)&&e.jsxs("select",{value:s.role,onChange:o=>D(s.id,o.target.value),className:"text-xs rounded border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500",children:[e.jsx("option",{value:a.VIEWER,children:"Viewer"}),e.jsx("option",{value:a.DESIGNER,children:"Designer"}),e.jsx("option",{value:a.ADMIN,children:"Admin"}),e.jsx("option",{value:a.OWNER,children:"Owner"})]})]})]},s.id))})]})]}):e.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Access Denied"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"You don't have permission to manage users."})]})})}function J(){const{user:t,hasRole:r}=b();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Manage your account settings and preferences."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(T,{className:"h-8 w-8 text-gray-400"})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Profile"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage your account settings and preferences"})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Profile Information"}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Display Name"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-50 rounded-md text-sm text-gray-900",children:t==null?void 0:t.displayName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-50 rounded-md text-sm text-gray-900",children:t==null?void 0:t.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-50 rounded-md text-sm text-gray-900 capitalize",children:t==null?void 0:t.role}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Contact an administrator to change your role."})]})]})]})})]})}),r(a.ADMIN)&&e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx(B,{})})]})]})}export{J as default};
//# sourceMappingURL=Settings.js.map
