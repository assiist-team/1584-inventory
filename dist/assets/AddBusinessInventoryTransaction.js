import{j as e}from"./index.js";import{r as i}from"./vendor.js";import{c as _,u as w,L as k}from"./router.js";import{p as S,t as F}from"./inventoryService.js";import{e as C,b as P,d as T}from"./ui.js";import"./firebase.js";function L(){const l=_(),d=w(),[m,u]=i.useState(!1),[x,g]=i.useState([]),[r,p]=i.useState({project_id:"",transaction_date:(()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`})(),source:"",transaction_type:"Reimbursement",payment_method:"",amount:"",budget_category:"Furnishings",notes:"",status:"pending",reimbursement_type:"",trigger_event:"Manual",receipt_emailed:!1}),[s,c]=i.useState({}),h=i.useMemo(()=>{const a=new URLSearchParams(d.search).get("returnTo");return a||"/business-inventory"},[d.search]);i.useEffect(()=>{(async()=>{try{const a=await S.getProjects();g(a)}catch(a){console.error("Error loading projects:",a)}})()},[]);const n=(t,a)=>{p(o=>({...o,[t]:a})),s[t]&&c(o=>({...o,[t]:""}))},j=()=>{const t={};return r.project_id||(t.project_id="Project selection is required"),r.transaction_date.trim()||(t.transaction_date="Transaction date is required"),r.source.trim()||(t.source="Source is required"),r.amount.trim()||(t.amount="Amount is required"),c(t),Object.keys(t).length===0},y=async t=>{var a;if(t.preventDefault(),!!j()){u(!0);try{const o=r.project_id==="business-inventory"?null:r.project_id,f=r.project_id==="business-inventory"?null:((a=x.find(N=>N.id===r.project_id))==null?void 0:a.name)||"",v={...r,project_id:o,project_name:f,created_by:"system"};await F.createTransaction(o,v),l("/business-inventory")}catch(o){console.error("Error creating transaction:",o),c({general:"Error creating transaction. Please try again."})}finally{u(!1)}}},b=()=>{l(h)};return e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{to:h,className:"mr-4 p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(C,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Add Business Inventory Transaction"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Add a new transaction related to business inventory management"})]})]})}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Project Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"project_id",className:"block text-sm font-medium text-gray-700",children:"Project *"}),e.jsxs("select",{id:"project_id",value:r.project_id,onChange:t=>n("project_id",t.target.value),className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm ${s.project_id?"border-red-300":""}`,children:[e.jsx("option",{value:"",children:"Select a project..."}),e.jsx("option",{value:"business-inventory",children:"Business Inventory (No Project)"}),x.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",t.clientName]},t.id))]}),s.project_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.project_id})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"transaction_date",className:"block text-sm font-medium text-gray-700",children:"Transaction Date *"}),e.jsx("input",{type:"date",id:"transaction_date",value:r.transaction_date,onChange:t=>n("transaction_date",t.target.value),className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm ${s.transaction_date?"border-red-300":""}`}),s.transaction_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.transaction_date})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Transaction Details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"source",className:"block text-sm font-medium text-gray-700",children:"Source *"}),e.jsx("input",{type:"text",id:"source",value:r.source,onChange:t=>n("source",t.target.value),className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm ${s.source?"border-red-300":""}`,placeholder:"e.g., Inventory Allocation, Client Purchase"}),s.source&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.source})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700",children:"Amount *"}),e.jsx("input",{type:"number",step:"0.01",id:"amount",value:r.amount,onChange:t=>n("amount",t.target.value),className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm ${s.amount?"border-red-300":""}`,placeholder:"0.00"}),s.amount&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.amount})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"budget_category",className:"block text-sm font-medium text-gray-700",children:"Budget Category"}),e.jsxs("select",{id:"budget_category",value:r.budget_category,onChange:t=>n("budget_category",t.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",children:[e.jsx("option",{value:"Furnishings",children:"Furnishings"}),e.jsx("option",{value:"Design Fee",children:"Design Fee"}),e.jsx("option",{value:"Property Management",children:"Property Management"}),e.jsx("option",{value:"Kitchen",children:"Kitchen"}),e.jsx("option",{value:"Install",children:"Install"}),e.jsx("option",{value:"Storage & Receiving",children:"Storage & Receiving"}),e.jsx("option",{value:"Fuel",children:"Fuel"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reimbursement_type",className:"block text-sm font-medium text-gray-700",children:"Reimbursement Type"}),e.jsxs("select",{id:"reimbursement_type",value:r.reimbursement_type,onChange:t=>n("reimbursement_type",t.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",children:[e.jsx("option",{value:"Client owes us",children:"Client owes us"}),e.jsx("option",{value:"We owe client",children:"We owe client"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notes"}),e.jsx("textarea",{id:"notes",rows:3,value:r.notes,onChange:t=>n("notes",t.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Additional notes about this transaction..."})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"receipt_emailed",checked:r.receipt_emailed,onChange:t=>n("receipt_emailed",t.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"receipt_emailed",className:"ml-2 block text-sm text-gray-700",children:"Receipt emailed to client"})]})]})]}),s.general&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsx("div",{className:"text-sm text-red-800",children:s.general})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-end gap-3 pt-6 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:b,className:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 transition-colors duration-200",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs("button",{type:"submit",disabled:m,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 transition-colors duration-200 disabled:opacity-50",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),m?"Adding Transaction...":"Add Transaction"]})]})]})]})})})}export{L as default};
//# sourceMappingURL=AddBusinessInventoryTransaction.js.map
