import{j as e}from"./index.js";import{r as h}from"./vendor.js";import{b as G,v as z,w as P,x as I,y as S,g as C,z as E,G as $,l as L,d as k}from"./ui.js";function D({images:s,initialIndex:d=0,onClose:x}){const[m,u]=h.useState(d),[w,f]=h.useState(!1);h.useEffect(()=>{const l=a=>{switch(a.key){case"Escape":x();break;case"ArrowLeft":a.preventDefault(),u(c=>c>0?c-1:s.length-1);break;case"ArrowRight":a.preventDefault(),u(c=>c<s.length-1?c+1:0);break}};return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)},[x,s.length]),h.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]);const n=s[m],j=()=>{u(l=>l>0?l-1:s.length-1),f(!1)},y=()=>{u(l=>l<s.length-1?l+1:0),f(!1)},g=l=>{if(l===0)return"0 Bytes";const a=1024,c=["Bytes","KB","MB","GB"],b=Math.floor(Math.log(l)/Math.log(a));return(l/Math.pow(a,b)).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})+" "+c[b]};return e.jsxs("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-90 flex items-center justify-center p-4",children:[e.jsx("button",{onClick:x,className:"absolute top-4 right-4 z-10 p-2 text-white hover:text-gray-300 transition-colors","aria-label":"Close gallery",children:e.jsx(G,{className:"h-6 w-6"})}),s.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:j,className:"absolute left-4 top-1/2 transform -translate-y-1/2 z-10 p-2 text-white hover:text-gray-300 transition-colors","aria-label":"Previous image",children:e.jsx(z,{className:"h-8 w-8"})}),e.jsx("button",{onClick:y,className:"absolute right-4 top-1/2 transform -translate-y-1/2 z-10 p-2 text-white hover:text-gray-300 transition-colors","aria-label":"Next image",children:e.jsx(P,{className:"h-8 w-8"})})]}),e.jsxs("div",{className:"relative max-w-full max-h-full flex items-center justify-center",children:[e.jsx("img",{src:n.url,alt:n.alt||n.fileName,className:"max-w-full max-h-full object-contain",onLoad:()=>f(!0),style:{opacity:w?1:0,transition:"opacity 0.3s ease"}}),!w&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"})})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-70 text-white p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium truncate",children:n.alt||n.fileName}),n.caption&&e.jsx("p",{className:"text-xs text-gray-300 mt-1",children:n.caption}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-400",children:[e.jsxs("span",{children:[m+1," of ",s.length]}),e.jsx("span",{children:g(n.size)}),e.jsx("span",{children:(()=>{try{return new Date(n.uploadedAt).toLocaleDateString()}catch(l){return console.warn("Invalid date for image:",n.uploadedAt,l),"Unknown date"}})()})]})]}),e.jsx("button",{onClick:()=>window.open(n.url,"_blank"),className:"p-2 text-white hover:text-gray-300 transition-colors ml-4","aria-label":"Download image",children:e.jsx(I,{className:"h-4 w-4"})})]})}),s.length>1&&e.jsx("div",{className:"absolute bottom-20 left-1/2 transform -translate-x-1/2 flex space-x-2",children:s.map((l,a)=>e.jsx("button",{onClick:()=>{u(a),f(!1)},className:`w-2 h-2 rounded-full transition-colors ${a===m?"bg-white":"bg-white bg-opacity-50"}`,"aria-label":`Go to image ${a+1}`},a))})]})}function B({images:s,onAddImage:d,onRemoveImage:x,onSetPrimary:m,maxImages:u=5,showControls:w=!0,size:f="md",className:n=""}){const[j,y]=h.useState(!1),[g,l]=h.useState(0),[a,c]=h.useState(null),b={sm:"w-20 h-20 sm:w-16 sm:h-16",md:"w-24 h-24 sm:w-20 sm:h-20",lg:"w-28 h-28 sm:w-24 sm:h-24"},N=t=>{l(t),y(!0)},v=()=>{y(!1)},r=(t,i)=>{t.stopPropagation(),c(a===i?null:i)},o=(t,i,p,M)=>{switch(t.stopPropagation(),c(null),i){case"open":N(M);break;case"setPrimary":m==null||m(p);break;case"delete":x==null||x(p);break}};return h.useEffect(()=>{const t=i=>{a!==null&&!i.target.closest(".image-menu-container")&&c(null)};return document.addEventListener("click",t),()=>document.removeEventListener("click",t)},[a]),s.length===0&&!d?null:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`space-y-3 ${n}`,children:[s.length>0&&e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3 sm:gap-4 md:gap-6",style:{width:"fit-content"},children:[s.map((t,i)=>e.jsxs("div",{className:`${b[f]} relative group cursor-pointer rounded-lg overflow-visible border-2 ${t.isPrimary?"border-primary-500 ring-2 ring-primary-200":"border-gray-200"}`,onClick:()=>N(i),children:[e.jsx("img",{src:t.url,alt:t.alt||t.fileName,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),t.isPrimary&&e.jsx("div",{className:"absolute top-1 left-1 bg-yellow-500 text-white text-xs p-1 rounded flex items-center justify-center",children:e.jsx(S,{className:"h-3 w-3 fill-current"})}),w&&e.jsx("div",{className:"absolute inset-0 bg-transparent transition-all duration-200",children:e.jsxs("div",{className:"absolute top-1 right-1 image-menu-container",children:[e.jsx("button",{onClick:p=>r(p,i),className:"p-1.5 bg-primary-500 bg-opacity-40 rounded-full text-white border border-white hover:bg-primary-500 hover:bg-opacity-50 hover:text-white transition-colors",title:"Image options",children:e.jsx(C,{className:"h-3 w-3"})}),a===i&&e.jsxs("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-1 w-32 bg-white rounded-md shadow-lg border border-gray-200 py-1 z-50",style:{transform:"translateY(0)",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("button",{onClick:p=>o(p,"open",t.url,i),className:"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center transition-colors",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Open"})]}),!t.isPrimary&&m&&e.jsxs("button",{onClick:p=>o(p,"setPrimary",t.url,i),className:"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center transition-colors",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Primary"})]}),x&&e.jsxs("button",{onClick:p=>o(p,"delete",t.url,i),className:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center transition-colors",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Delete"})]})]})]})})]},t.url)),d&&s.length<u&&e.jsx("button",{onClick:d,className:`${b[f]} border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center text-gray-400 hover:text-gray-600 hover:border-gray-400 transition-colors`,title:"Add image",children:e.jsx(k,{className:"h-5 w-5"})})]}),!s.length&&d&&e.jsx("button",{onClick:d,className:`${b[f]} border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center text-gray-400 hover:text-gray-600 hover:border-gray-400 transition-colors w-full`,title:"Add image",children:e.jsx(k,{className:"h-5 w-5"})}),s.length>0&&e.jsxs("p",{className:"text-xs text-gray-500",children:[s.length," image",s.length!==1?"s":"",u&&` (max ${u})`]})]}),j&&e.jsx(D,{images:s,initialIndex:g,onClose:v})]})}function T({images:s,onRemoveImage:d,showControls:x=!0,size:m="md",className:u="",onImageClick:w}){const[f,n]=h.useState(!1),[j,y]=h.useState(0),[g,l]=h.useState(null),a={sm:"w-20 h-20 sm:w-16 sm:h-16",md:"w-24 h-24 sm:w-20 sm:h-20",lg:"w-28 h-28 sm:w-24 sm:h-24"},c=r=>{w?w(r):(y(r),n(!0))},b=()=>{n(!1)},N=(r,o)=>{r.stopPropagation(),l(g===o?null:o)},v=(r,o,t,i)=>{switch(r.stopPropagation(),l(null),o){case"open":c(i);break;case"delete":d==null||d(t);break}};return h.useEffect(()=>{const r=o=>{g!==null&&!o.target.closest(".image-menu-container")&&l(null)};return document.addEventListener("click",r),()=>document.removeEventListener("click",r)},[g]),s.length===0?null:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`space-y-3 ${u}`,children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3 sm:gap-4 md:gap-6",style:{width:"fit-content"},children:s.map((r,o)=>e.jsxs("div",{className:`${a[m]} relative group cursor-pointer rounded-lg overflow-visible border-2 border-gray-200`,onClick:()=>c(o),children:[e.jsx("img",{src:r.url,alt:r.fileName,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),x&&e.jsx("div",{className:"absolute inset-0 bg-transparent transition-all duration-200",children:e.jsxs("div",{className:"absolute top-1 right-1 image-menu-container",children:[e.jsx("button",{onClick:t=>N(t,o),className:"p-1.5 bg-primary-500 bg-opacity-40 rounded-full text-white border border-white hover:bg-primary-500 hover:bg-opacity-50 hover:text-white transition-colors",title:"Image options",children:e.jsx(C,{className:"h-3 w-3"})}),g===o&&e.jsxs("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-1 w-32 bg-white rounded-md shadow-lg border border-gray-200 py-1 z-50",style:{transform:"translateY(0)",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("button",{onClick:t=>v(t,"open",r.url,o),className:"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center transition-colors",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Open"})]}),d&&e.jsxs("button",{onClick:t=>v(t,"delete",r.url,o),className:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center transition-colors",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Delete"})]})]})]})})]},r.url))})}),f&&e.jsx(D,{images:s.map(r=>({url:r.url,alt:r.fileName,isPrimary:!1,uploadedAt:new Date,fileName:r.fileName,size:0,mimeType:"image/jpeg"})),initialIndex:j,onClose:b})]})}export{B as I,T,D as a};
//# sourceMappingURL=ImagePreview.js.map
