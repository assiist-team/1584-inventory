import{j as e,u as we,U as ke}from"./index.js";import{b as Ie,c as Se,L as B}from"./router.js";import{r as g}from"./vendor.js";import{T as K}from"./transactionSources.js";import{p as Ce,t as V,u as ue}from"./inventoryService.js";import{I as F}from"./imageService.js";import{I as ge}from"./ImageUpload.js";import{T as Fe}from"./TransactionItemForm.js";import{f as Te,b as pe,d as Pe,o as $e,e as Ee,p as Re}from"./ui.js";import"./firebase.js";import"./ImagePreview.js";function De({items:c,onItemsChange:_,projectId:q,projectName:j,onImageFilesChange:w}){const[s,y]=g.useState(!1),[p,k]=g.useState(null),b=r=>{if(p){const m=c.map(a=>a.id===p?r:a);_(m)}else _([...c,r]);r.imageFiles&&r.imageFiles.length>0&&w&&w(r.id,r.imageFiles),y(!1),k(null)},L=()=>{y(!1),k(null)},N=r=>{k(r),y(!1)},T=r=>{const m=c.filter(a=>a.id!==r);_(m)},P=()=>p&&c.find(r=>r.id===p)||null,$=r=>{const m=parseFloat(r);return isNaN(m)?"$0.00":`$${m.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`};if(s||p){const r=P();return e.jsx(Fe,{item:r||void 0,onSave:b,onCancel:L,isEditing:!!r,projectId:q,projectName:j,onImageFilesChange:w})}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Transaction Items"})}),e.jsxs("div",{className:"space-y-3",children:[c.map((r,m)=>e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800",children:["Item ",m+1]}),e.jsx("span",{className:"text-sm text-gray-500",children:$(r.project_price||r.purchase_price||"")})]}),e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:r.description||"No description"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[r.sku&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"SKU:"})," ",r.sku]}),r.market_value&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Market Value:"})," $",r.market_value]})]}),r.notes&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Notes:"})," ",r.notes]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),N(r.id)},className:"text-primary-600 hover:text-primary-900 p-1",title:"Edit item",children:e.jsx(Te,{className:"h-4 w-4"})}),e.jsx("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),T(r.id)},className:"text-red-600 hover:text-red-900 p-1",title:"Delete item",children:e.jsx(pe,{className:"h-4 w-4"})})]})]})},r.id)),e.jsx("div",{className:"text-center py-8 border-2 border-dashed border-gray-300 rounded-lg",children:e.jsxs("button",{onClick:()=>y(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",title:"Add new item",children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Add Item"]})}),c.length>0&&e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Total Items: ",c.length]}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["Total: ",$(c.reduce((r,m)=>r+(parseFloat(m.project_price||m.purchase_price||"0")||0),0).toString())]})]})]})]})}function Xe(){const{id:c}=Ie(),_=Se(),{hasRole:q}=we();if(!q(ke.DESIGNER))return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 text-center",children:[e.jsx("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-red-100",children:e.jsx($e,{className:"h-6 w-6 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600",children:"You don't have permission to add transactions. Please contact an administrator if you need access."}),e.jsx(B,{to:`/project/${c}`,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700",children:"Back to Project"})]})});const[j,w]=g.useState("");g.useEffect(()=>{(async()=>{if(c)try{const i=await Ce.getProject(c);i&&w(i.name)}catch(i){console.error("Failed to fetch project:",i)}})()},[c]);const[s,y]=g.useState({transaction_date:(()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`})(),source:"",transaction_type:"Purchase",payment_method:"",amount:"",budget_category:"Furnishings",notes:"",status:"completed",reimbursement_type:"",trigger_event:"Manual",transaction_images:[],receipt_images:[],other_images:[],items:[]}),[p,k]=g.useState(void 0),[b,L]=g.useState(""),[N,T]=g.useState([]),[P,$]=g.useState(new Map),[r,m]=g.useState(!1);g.useEffect(()=>{s.source&&!K.includes(s.source)?m(!0):s.source&&K.includes(s.source)&&m(!1)},[s.source]);const[a,f]=g.useState({}),[E,R]=g.useState(!1),[D,v]=g.useState(!1),xe=()=>{var i;const t={};return s.source.trim()||(t.source="Source is required"),s.transaction_type.trim()||(t.transaction_type="Transaction type is required"),(i=s.budget_category)!=null&&i.trim()||(t.budget_category="Budget category is required"),s.amount.trim()?(isNaN(Number(s.amount))||Number(s.amount)<=0)&&(t.amount="Amount must be a positive number"):t.amount="Amount is required",p==="Other"&&(!b.trim()||isNaN(Number(b))||Number(b)<=0?t.general="Subtotal must be provided and greater than 0 when Tax state is Other.":Number(s.amount)<Number(b)&&(t.general="Subtotal cannot exceed the total amount.")),s.transaction_date||(t.transaction_date="Transaction date is required"),f(t),Object.keys(t).length===0},he=async t=>{var i,x,h,Y,G,X,H,J,Q,Z,ee,te,se,ae,re,ie,ne,le;if(t.preventDefault(),!(!xe()||!c)){R(!0);try{const{transaction_images:U,receipt_images:Ue,other_images:Oe,...je}=s,O={...je,project_id:c,project_name:j,created_by:"system",tax_state:p,receipt_emailed:s.receipt_emailed??!1,subtotal:p==="Other"?b:""};console.log("Attempting to create transaction with data:",O),console.log("Transaction date value:",O.transaction_date),console.log("Transaction date type:",typeof O.transaction_date),console.log("Transaction items:",N);const I=await V.createTransaction(c,O,N);if(s.receipt_images&&s.receipt_images.length>0){v(!0);try{const l=await F.uploadMultipleReceiptImages(s.receipt_images,j,I,W),n=F.convertFilesToReceiptImages(l);if(console.log("Receipt images uploaded successfully:",n.length,"images"),console.log("Receipt images to save:",n),n&&n.length>0){console.log("Updating transaction with receipt images...");try{await V.updateTransaction(c,I,{receipt_images:n}),console.log("Transaction updated successfully with receipt images")}catch(u){console.error("Failed to update transaction with receipt images:",u)}}await new Promise(u=>setTimeout(u,500))}catch(l){console.error("Error uploading receipt images:",l);let n="Failed to upload receipt images. Please try again.";(i=l.message)!=null&&i.includes("Storage service is not available")?n="Storage service is unavailable. Please check your internet connection.":(x=l.message)!=null&&x.includes("Network error")||(h=l.message)!=null&&h.includes("offline")?n="Network connection issue. Please check your internet and try again.":(Y=l.message)!=null&&Y.includes("quota exceeded")?n="Storage quota exceeded. Please contact support.":(G=l.message)!=null&&G.includes("Unauthorized")?n="Permission denied. Please check your account permissions.":((X=l.message)!=null&&X.includes("CORS")||(H=l.message)!=null&&H.includes("Access-Control")||(J=l.message)!=null&&J.includes("ERR_FAILED")||(Q=l.message)!=null&&Q.includes("preflight"))&&(n="Upload blocked by browser security policy. Please check Firebase Storage configuration or try refreshing the page."),f({receipt_images:n}),R(!1),v(!1);return}v(!1)}if(s.other_images&&s.other_images.length>0){v(!0);try{const l=await F.uploadMultipleOtherImages(s.other_images,j,I,W),n=F.convertFilesToOtherImages(l);if(console.log("Other images uploaded successfully:",n.length,"images"),console.log("Other images to save:",n),n&&n.length>0){console.log("Updating transaction with other images...");try{await V.updateTransaction(c,I,{other_images:n}),console.log("Transaction updated successfully with other images")}catch(u){console.error("Failed to update transaction with other images:",u)}}await new Promise(u=>setTimeout(u,500))}catch(l){console.error("Error uploading other images:",l);let n="Failed to upload other images. Please try again.";(Z=l.message)!=null&&Z.includes("Storage service is not available")?n="Storage service is unavailable. Please check your internet connection.":(ee=l.message)!=null&&ee.includes("Network error")||(te=l.message)!=null&&te.includes("offline")?n="Network connection issue. Please check your internet and try again.":(se=l.message)!=null&&se.includes("quota exceeded")?n="Storage quota exceeded. Please contact support.":(ae=l.message)!=null&&ae.includes("Unauthorized")?n="Permission denied. Please check your account permissions.":((re=l.message)!=null&&re.includes("CORS")||(ie=l.message)!=null&&ie.includes("Access-Control")||(ne=l.message)!=null&&ne.includes("ERR_FAILED")||(le=l.message)!=null&&le.includes("preflight"))&&(n="Upload blocked by browser security policy. Please check Firebase Storage configuration or try refreshing the page."),f({other_images:n}),R(!1),v(!1);return}v(!1)}if(P.size>0)try{console.log("Starting image upload process...");const n=(await ue.getItemsForTransaction(c,I)).map(u=>u.item_id);console.log("Created item IDs:",n);for(let u=0;u<N.length&&u<n.length;u++){const oe=N[u],A=n[u],S=P.get(oe.id);if(S&&S.length>0){console.log(`Uploading ${S.length} images for item ${A}`);const Ne=S.map(async(d,ve)=>{var ce,me;try{console.log(`Uploading file ${ve+1}/${S.length}: ${d.name}`);const C=await F.uploadItemImage(d,j,A);console.log(`Upload successful for ${d.name}:`,C),console.log(`Upload result URL: ${C.url}`);const de={url:C.url,alt:d.name,isPrimary:((me=(ce=oe.images)==null?void 0:ce.find(_e=>_e.fileName===d.name))==null?void 0:me.isPrimary)||!1,uploadedAt:new Date,fileName:d.name,size:d.size,mimeType:d.type};return console.log("Created ItemImage object:",de),de}catch(C){return console.error(`Failed to upload ${d.name}:`,C),{url:"",alt:d.name,isPrimary:!1,uploadedAt:new Date,fileName:d.name,size:d.size,mimeType:d.type}}}),z=await Promise.all(Ne);console.log("All uploads completed, updating item with images:",z);const M=z.filter(d=>d.url&&d.url.trim()!=="");console.log(`Valid images to save: ${M.length}/${z.length}`),M.length>0&&(await ue.updateItem(A,{images:M}),console.log(`Successfully updated item ${A} with ${M.length} images`))}}}catch(l){console.error("Error in image upload process:",l)}_(`/project/${c}?tab=transactions`)}catch(U){console.error("Error creating transaction:",U),f({general:U instanceof Error?U.message:"Failed to create transaction. Please try again."})}finally{R(!1)}}},o=(t,i)=>{y(x=>({...x,[t]:i})),a[t]&&f(x=>({...x,[t]:void 0}))},ye=t=>{y(i=>({...i,receipt_images:t})),a.receipt_images&&f(i=>({...i,receipt_images:void 0}))},be=t=>{y(i=>({...i,other_images:t})),a.other_images&&f(i=>({...i,other_images:void 0}))},fe=(t,i)=>{$(x=>{const h=new Map(x);return h.set(t,i),h}),T(x=>x.map(h=>h.id===t?{...h,imageFiles:i}:h))},W=(t,i)=>{console.log(`Upload progress for file ${t}: ${i.percentage}%`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(B,{to:`/project/${c}?tab=transactions`,className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700",children:[e.jsx(Ee,{className:"h-4 w-4 mr-1"}),"Back"]})})}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Add Transaction"})}),e.jsxs("form",{onSubmit:he,className:"space-y-8 p-8",children:[a.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsx("p",{children:a.general})})]})})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Transaction Source *"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-3",children:K.map(t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:`source_${t.toLowerCase().replace(/\s+/g,"_")}`,name:"source",value:t,checked:s.source===t,onChange:i=>{o("source",i.target.value),m(!1)},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:`source_${t.toLowerCase().replace(/\s+/g,"_")}`,className:"ml-2 block text-sm text-gray-900",children:t})]},t))}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"source_custom",name:"source",value:"custom",checked:r,onChange:()=>{m(!0),o("source","")},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"source_custom",className:"ml-2 block text-sm text-gray-900",children:"Other"})]}),r&&e.jsx("input",{type:"text",id:"source_custom_input",value:s.source,onChange:t=>o("source",t.target.value),placeholder:"Enter custom source...",className:`mt-3 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${a.source?"border-red-300":"border-gray-300"}`}),a.source&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.source})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Budget Category *"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"budget_design_fee",name:"budget_category",value:"Design Fee",checked:s.budget_category==="Design Fee",onChange:t=>o("budget_category",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"budget_design_fee",className:"ml-2 block text-sm text-gray-900",children:"Design Fee"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"budget_furnishings",name:"budget_category",value:"Furnishings",checked:s.budget_category==="Furnishings",onChange:t=>o("budget_category",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"budget_furnishings",className:"ml-2 block text-sm text-gray-900",children:"Furnishings"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"budget_property_management",name:"budget_category",value:"Property Management",checked:s.budget_category==="Property Management",onChange:t=>o("budget_category",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"budget_property_management",className:"ml-2 block text-sm text-gray-900",children:"Property Management"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"budget_kitchen",name:"budget_category",value:"Kitchen",checked:s.budget_category==="Kitchen",onChange:t=>o("budget_category",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"budget_kitchen",className:"ml-2 block text-sm text-gray-900",children:"Kitchen"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"budget_install",name:"budget_category",value:"Install",checked:s.budget_category==="Install",onChange:t=>o("budget_category",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"budget_install",className:"ml-2 block text-sm text-gray-900",children:"Install"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"budget_storage_receiving",name:"budget_category",value:"Storage & Receiving",checked:s.budget_category==="Storage & Receiving",onChange:t=>o("budget_category",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"budget_storage_receiving",className:"ml-2 block text-sm text-gray-900",children:"Storage & Receiving"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"budget_fuel",name:"budget_category",value:"Fuel",checked:s.budget_category==="Fuel",onChange:t=>o("budget_category",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"budget_fuel",className:"ml-2 block text-sm text-gray-900",children:"Fuel"})]})]}),a.budget_category&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.budget_category})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Transaction Type *"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"type_purchase",name:"transaction_type",value:"Purchase",checked:s.transaction_type==="Purchase",onChange:t=>o("transaction_type",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"type_purchase",className:"ml-2 block text-sm text-gray-900",children:"Purchase"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"type_to_inventory",name:"transaction_type",value:"To Inventory",checked:s.transaction_type==="To Inventory",onChange:t=>o("transaction_type",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"type_to_inventory",className:"ml-2 block text-sm text-gray-900",children:"To Inventory"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"type_return",name:"transaction_type",value:"Return",checked:s.transaction_type==="Return",onChange:t=>o("transaction_type",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"type_return",className:"ml-2 block text-sm text-gray-900",children:"Return"})]})]}),a.transaction_type&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.transaction_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Status"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"status_pending",name:"status",value:"pending",checked:s.status==="completed",onChange:t=>o("status",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"status_pending",className:"ml-2 block text-sm text-gray-900",children:"Pending"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"status_completed",name:"status",value:"completed",checked:s.status==="completed",onChange:t=>o("status",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"status_completed",className:"ml-2 block text-sm text-gray-900",children:"Completed"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"status_cancelled",name:"status",value:"canceled",checked:s.status==="canceled",onChange:t=>o("status",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"status_cancelled",className:"ml-2 block text-sm text-gray-900",children:"Canceled"})]})]}),a.status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Reimbursement Type"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"reimbursement_client_owes",name:"reimbursement_type",value:"Client Owes",checked:s.reimbursement_type==="Client Owes",onChange:t=>o("reimbursement_type",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"reimbursement_client_owes",className:"ml-2 block text-sm text-gray-900",children:"Client Owes"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"reimbursement_we_owe",name:"reimbursement_type",value:"We Owe",checked:s.reimbursement_type==="We Owe",onChange:t=>o("reimbursement_type",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"reimbursement_we_owe",className:"ml-2 block text-sm text-gray-900",children:"We Owe"})]})]}),a.reimbursement_type&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.reimbursement_type})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700",children:"Amount *"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"text",id:"amount",value:s.amount,onChange:t=>o("amount",t.target.value),placeholder:"0.00",className:`block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${a.amount?"border-red-300":"border-gray-300"}`})]}),a.amount&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Tax State"}),e.jsxs("select",{id:"tax_state",value:p||"",onChange:t=>k(t.target.value),className:"mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 border-gray-300",children:[e.jsx("option",{value:"",children:"None"}),e.jsx("option",{value:"NV",children:"NV"}),e.jsx("option",{value:"UT",children:"UT"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),p==="Other"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subtotal"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"text",id:"subtotal",value:b,onChange:t=>L(t.target.value),placeholder:"0.00",className:"block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 border-gray-300"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"This will be used to calculate the tax rate."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"transaction_date",className:"block text-sm font-medium text-gray-700",children:"Transaction Date *"}),e.jsx("input",{type:"date",id:"transaction_date",value:s.transaction_date,onChange:t=>{o("transaction_date",t.target.value)},className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${a.transaction_date?"border-red-300":"border-gray-300"}`}),a.transaction_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.transaction_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Transaction Method"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"method_client_card",name:"payment_method",value:"Client Card",checked:s.payment_method==="Client Card",onChange:t=>o("payment_method",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"method_client_card",className:"ml-2 block text-sm text-gray-900",children:"Client Card"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"method_1584_card",name:"payment_method",value:"1584 Design",checked:s.payment_method==="1584 Design",onChange:t=>o("payment_method",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"method_1584_card",className:"ml-2 block text-sm text-gray-900",children:"1584 Design"})]})]}),a.payment_method&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.payment_method})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Receipt Email Copy"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"receipt_yes",name:"receipt_emailed",checked:s.receipt_emailed===!0,onChange:()=>o("receipt_emailed",!0),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"receipt_yes",className:"ml-2 block text-sm text-gray-900",children:"Yes"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"receipt_no",name:"receipt_emailed",checked:s.receipt_emailed===!1,onChange:()=>o("receipt_emailed",!1),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"receipt_no",className:"ml-2 block text-sm text-gray-900",children:"No"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notes"}),e.jsx("textarea",{id:"notes",rows:3,value:s.notes,onChange:t=>o("notes",t.target.value),placeholder:"Additional notes about this transaction...",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${a.notes?"border-red-300":"border-gray-300"}`}),a.notes&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.notes})]}),e.jsxs("div",{children:[e.jsx(De,{items:N,onItemsChange:t=>{T(t),a.items&&t.length>0&&f(i=>({...i,items:void 0}))},projectId:c,projectName:j,onImageFilesChange:fe}),a.items&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.items})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Receipt Images"}),e.jsx(ge,{onImagesChange:ye,maxImages:5,maxFileSize:10,disabled:E||D,className:"mb-2"}),a.receipt_images&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.receipt_images})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Other Images"}),e.jsx(ge,{onImagesChange:be,maxImages:5,maxFileSize:10,disabled:E||D,className:"mb-2"}),a.other_images&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.other_images})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsxs(B,{to:`/project/${c}?tab=transactions`,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs("button",{type:"submit",disabled:E||D,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),E?"Creating...":D?"Uploading Images...":"Create Transaction"]})]})]})]})]})}export{Xe as default};
//# sourceMappingURL=AddTransaction.js.map
