import{a as be,j as e,u as je,U as ve}from"./index.js";import{u as Ne,b as _e,L as G}from"./router.js";import{r as u}from"./vendor.js";import{T as V}from"./transactionSources.js";import{p as we,t as Y,i as ge}from"./inventoryService.js";import{I as D}from"./imageService.js";import{I as pe}from"./ImageUpload.js";import{I as ke}from"./ImagePreview.js";import{b as W,n as Ie,e as Fe,P as Se,q as Ce,d as Pe,r as $e}from"./ui.js";import"./firebase.js";function Te({item:r,onSave:P,onCancel:E,isEditing:v=!1,onImageFilesChange:F}){const[s,b]=u.useState(r||{id:`temp_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,description:"",sku:"",price:"",market_value:"",notes:""}),[h,j]=u.useState((r==null?void 0:r.images)||[]),[w,$]=u.useState((r==null?void 0:r.imageFiles)||[]),[T,k]=u.useState(!1),[a,f]=u.useState({}),{showError:n}=be();u.useEffect(()=>{var i,y;r&&(console.log("TransactionItemForm: Editing item with images:",((i=r.images)==null?void 0:i.length)||0,"imageFiles:",((y=r.imageFiles)==null?void 0:y.length)||0),j(r.images||[]),$(r.imageFiles||[]),b({id:r.id,description:r.description,sku:r.sku||"",price:r.price,market_value:r.market_value||"",notes:r.notes||""}))},[r]);const g=async()=>{var i,y;try{k(!0);const m=await D.selectFromGallery();if(m&&m.length>0){console.log("Selected",m.length,"files from gallery"),$(t=>[...t,...m]);const C=m.map((t,o)=>({url:"",alt:t.name,isPrimary:h.length===0&&o===0,uploadedAt:new Date,fileName:t.name,size:t.size,mimeType:t.type}));j(t=>[...t,...C]),console.log("Added",C.length,"preview images")}else console.log("No files selected from gallery")}catch(m){if(console.error("Error selecting from gallery:",m),(i=m.message)!=null&&i.includes("timeout")||(y=m.message)!=null&&y.includes("canceled")){console.log("User canceled image selection or selection timed out");return}n("Failed to select images from gallery. Please try again.")}finally{k(!1)}},p=i=>{const y=h.findIndex(m=>m.url===i);y!==-1&&y<w.length&&(j(m=>m.filter(C=>C.url!==i)),$(m=>m.filter((C,t)=>t!==y)))},S=i=>{j(y=>y.map(m=>({...m,isPrimary:m.url===i})))},L=()=>{const i={};return s.description.trim()||(i.description="Description is required"),s.price.trim()?(isNaN(Number(s.price))||Number(s.price)<=0)&&(i.price="Price must be a positive number"):i.price="Price is required",f(i),Object.keys(i).length===0},K=()=>{if(!L())return;const i={...s,images:h,imageFiles:w};F&&w.length>0&&F(s.id,w),P(i)},d=(i,y)=>{b(m=>({...m,[i]:y})),a[i]&&f(m=>({...m,[i]:void 0}))};return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:v?"Edit Item":"Add Item"}),e.jsx("button",{onClick:E,className:"text-gray-400 hover:text-gray-600",type:"button",children:e.jsx(W,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description *"}),e.jsx("input",{type:"text",id:"description",value:s.description,onChange:i=>d("description",i.target.value),placeholder:"Item description",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${a.description?"border-red-300":"border-gray-300"}`}),a.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.description})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sku",className:"block text-sm font-medium text-gray-700",children:"SKU"}),e.jsx("input",{type:"text",id:"sku",value:s.sku,onChange:i=>d("sku",i.target.value),placeholder:"Stock keeping unit",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${a.sku?"border-red-300":"border-gray-300"}`}),a.sku&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.sku})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:"Price *"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"text",id:"price",value:s.price,onChange:i=>d("price",i.target.value),placeholder:"0.00",className:`block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${a.price?"border-red-300":"border-gray-300"}`})]}),a.price&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.price})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"market_value",className:"block text-sm font-medium text-gray-700",children:"Market Value"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"text",id:"market_value",value:s.market_value,onChange:i=>d("market_value",i.target.value),placeholder:"0.00",className:`block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${a.market_value?"border-red-300":"border-gray-300"}`})]}),a.market_value&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.market_value})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notes"}),e.jsx("textarea",{id:"notes",rows:2,value:s.notes,onChange:i=>d("notes",i.target.value),placeholder:"Additional notes about this item",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${a.notes?"border-red-300":"border-gray-300"}`}),a.notes&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.notes})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Item Images"}),e.jsxs("button",{type:"button",onClick:g,disabled:T,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 mb-3",title:"Add images from gallery or camera",children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),T?"Uploading...":"Add Images"]}),e.jsx(ke,{images:h,onRemoveImage:p,onSetPrimary:S,maxImages:3,size:"md"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:i=>{i.preventDefault(),i.stopPropagation(),E()},className:"px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Cancel"}),e.jsx("button",{type:"button",onClick:i=>{i.preventDefault(),i.stopPropagation(),K()},className:"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:v?"Update Item":"Add Item"})]})]})]})}function Ee({items:r,onItemsChange:P,projectId:E,projectName:v,onImageFilesChange:F}){const[s,b]=u.useState(!1),[h,j]=u.useState(null),w=n=>{if(h){const g=r.map(p=>p.id===h?n:p);P(g)}else P([...r,n]);n.imageFiles&&n.imageFiles.length>0&&F&&F(n.id,n.imageFiles),b(!1),j(null)},$=()=>{b(!1),j(null)},T=n=>{j(n),b(!1)},k=n=>{const g=r.filter(p=>p.id!==n);P(g)},a=()=>h&&r.find(n=>n.id===h)||null,f=n=>{const g=parseFloat(n);return isNaN(g)?"$0.00":`$${g.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`};if(s||h){const n=a();return e.jsx(Te,{item:n||void 0,onSave:w,onCancel:$,isEditing:!!n,projectId:E,projectName:v,onImageFilesChange:F})}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Transaction Items"})}),e.jsxs("div",{className:"space-y-3",children:[r.map((n,g)=>e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800",children:["Item ",g+1]}),e.jsx("span",{className:"text-sm text-gray-500",children:f(n.price)})]}),e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:n.description||"No description"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[n.sku&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"SKU:"})," ",n.sku]}),n.market_value&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Market Value:"})," $",n.market_value]})]}),n.notes&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Notes:"})," ",n.notes]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation(),T(n.id)},className:"text-primary-600 hover:text-primary-900 p-1",title:"Edit item",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation(),k(n.id)},className:"text-red-600 hover:text-red-900 p-1",title:"Delete item",children:e.jsx(W,{className:"h-4 w-4"})})]})]})},n.id)),e.jsx("div",{className:"text-center py-8 border-2 border-dashed border-gray-300 rounded-lg",children:e.jsxs("button",{onClick:()=>b(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",title:"Add new item",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Add Item"]})}),r.length>0&&e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Total Items: ",r.length]}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["Total: ",f(r.reduce((n,g)=>n+(parseFloat(g.price)||0),0).toString())]})]})]})]})}function Ve(){const{id:r}=Ne(),P=_e(),{hasRole:E}=je();if(!E(ve.DESIGNER))return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 text-center",children:[e.jsx("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-red-100",children:e.jsx(Ce,{className:"h-6 w-6 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600",children:"You don't have permission to add transactions. Please contact an administrator if you need access."}),e.jsx(G,{to:`/project/${r}`,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700",children:"Back to Project"})]})});const[v,F]=u.useState("");u.useEffect(()=>{(async()=>{if(r)try{const o=await we.getProject(r);o&&F(o.name)}catch(o){console.error("Failed to fetch project:",o)}})()},[r]);const[s,b]=u.useState({transaction_date:(()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`})(),source:"",transaction_type:"Purchase",payment_method:"",amount:"",budget_category:"Furnishings",notes:"",transaction_images:[],receipt_images:[],other_images:[],receipt_emailed:!1,items:[]}),[h,j]=u.useState([]),[w,$]=u.useState(new Map),[T,k]=u.useState(!1);u.useEffect(()=>{s.source&&!V.includes(s.source)?k(!0):s.source&&V.includes(s.source)&&k(!1)},[s.source]);const[a,f]=u.useState({}),[n,g]=u.useState(!1),[p,S]=u.useState(!1),L=()=>{var o;const t={};return s.source.trim()||(t.source="Source is required"),s.transaction_type.trim()||(t.transaction_type="Transaction type is required"),s.payment_method.trim()||(t.payment_method="Payment method is required"),(o=s.budget_category)!=null&&o.trim()||(t.budget_category="Budget category is required"),s.amount.trim()?(isNaN(Number(s.amount))||Number(s.amount)<=0)&&(t.amount="Amount must be a positive number"):t.amount="Amount is required",s.transaction_date||(t.transaction_date="Transaction date is required"),f(t),Object.keys(t).length===0},K=async t=>{var o,N,I,X,H,J,Q,Z,ee,te,se,ae,re,ie,ne,oe,le,ce;if(t.preventDefault(),!(!L()||!r)){g(!0);try{const{transaction_images:M,receipt_images:De,other_images:Re,...he}=s,q={...he,project_id:r,project_name:v,created_by:"system"};console.log("Attempting to create transaction with data:",q),console.log("Transaction date value:",q.transaction_date),console.log("Transaction date type:",typeof q.transaction_date),console.log("Transaction items:",h);const R=await Y.createTransaction(r,q,h);if(s.receipt_images&&s.receipt_images.length>0){S(!0);try{const l=await D.uploadMultipleReceiptImages(s.receipt_images,v,R,C),c=D.convertFilesToReceiptImages(l);if(console.log("Receipt images uploaded successfully:",c.length,"images"),console.log("Receipt images to save:",c),c&&c.length>0){console.log("Updating transaction with receipt images...");try{await Y.updateTransaction(r,R,{receipt_images:c}),console.log("Transaction updated successfully with receipt images")}catch(_){console.error("Failed to update transaction with receipt images:",_)}}await new Promise(_=>setTimeout(_,500))}catch(l){console.error("Error uploading receipt images:",l);let c="Failed to upload receipt images. Please try again.";(o=l.message)!=null&&o.includes("Storage service is not available")?c="Storage service is unavailable. Please check your internet connection.":(N=l.message)!=null&&N.includes("Network error")||(I=l.message)!=null&&I.includes("offline")?c="Network connection issue. Please check your internet and try again.":(X=l.message)!=null&&X.includes("quota exceeded")?c="Storage quota exceeded. Please contact support.":(H=l.message)!=null&&H.includes("Unauthorized")?c="Permission denied. Please check your account permissions.":((J=l.message)!=null&&J.includes("CORS")||(Q=l.message)!=null&&Q.includes("Access-Control")||(Z=l.message)!=null&&Z.includes("ERR_FAILED")||(ee=l.message)!=null&&ee.includes("preflight"))&&(c="Upload blocked by browser security policy. Please check Firebase Storage configuration or try refreshing the page."),f({receipt_images:c}),g(!1),S(!1);return}S(!1)}if(s.other_images&&s.other_images.length>0){S(!0);try{const l=await D.uploadMultipleOtherImages(s.other_images,v,R,C),c=D.convertFilesToOtherImages(l);if(console.log("Other images uploaded successfully:",c.length,"images"),console.log("Other images to save:",c),c&&c.length>0){console.log("Updating transaction with other images...");try{await Y.updateTransaction(r,R,{other_images:c}),console.log("Transaction updated successfully with other images")}catch(_){console.error("Failed to update transaction with other images:",_)}}await new Promise(_=>setTimeout(_,500))}catch(l){console.error("Error uploading other images:",l);let c="Failed to upload other images. Please try again.";(te=l.message)!=null&&te.includes("Storage service is not available")?c="Storage service is unavailable. Please check your internet connection.":(se=l.message)!=null&&se.includes("Network error")||(ae=l.message)!=null&&ae.includes("offline")?c="Network connection issue. Please check your internet and try again.":(re=l.message)!=null&&re.includes("quota exceeded")?c="Storage quota exceeded. Please contact support.":(ie=l.message)!=null&&ie.includes("Unauthorized")?c="Permission denied. Please check your account permissions.":((ne=l.message)!=null&&ne.includes("CORS")||(oe=l.message)!=null&&oe.includes("Access-Control")||(le=l.message)!=null&&le.includes("ERR_FAILED")||(ce=l.message)!=null&&ce.includes("preflight"))&&(c="Upload blocked by browser security policy. Please check Firebase Storage configuration or try refreshing the page."),f({other_images:c}),g(!1),S(!1);return}S(!1)}if(w.size>0)try{console.log("Starting image upload process...");const l=await ge.getTransactionItems(r,R);console.log("Created item IDs:",l);for(let c=0;c<h.length&&c<l.length;c++){const _=h[c],O=l[c],A=w.get(_.id);if(A&&A.length>0){console.log(`Uploading ${A.length} images for item ${O}`);const xe=A.map(async(x,ye)=>{var de,me;try{console.log(`Uploading file ${ye+1}/${A.length}: ${x.name}`);const U=await D.uploadItemImage(x,v,O);console.log(`Upload successful for ${x.name}:`,U),console.log(`Upload result URL: ${U.url}`);const ue={url:U.url,alt:x.name,isPrimary:((me=(de=_.images)==null?void 0:de.find(fe=>fe.fileName===x.name))==null?void 0:me.isPrimary)||!1,uploadedAt:new Date,fileName:x.name,size:x.size,mimeType:x.type};return console.log("Created ItemImage object:",ue),ue}catch(U){return console.error(`Failed to upload ${x.name}:`,U),{url:"",alt:x.name,isPrimary:!1,uploadedAt:new Date,fileName:x.name,size:x.size,mimeType:x.type}}}),B=await Promise.all(xe);console.log("All uploads completed, updating item with images:",B);const z=B.filter(x=>x.url&&x.url.trim()!=="");console.log(`Valid images to save: ${z.length}/${B.length}`),z.length>0&&(await ge.updateItemImages(r,O,z),console.log(`Successfully updated item ${O} with ${z.length} images`))}}}catch(l){console.error("Error in image upload process:",l)}P(`/project/${r}?tab=transactions`)}catch(M){console.error("Error creating transaction:",M),f({general:M instanceof Error?M.message:"Failed to create transaction. Please try again."})}finally{g(!1)}}},d=(t,o)=>{b(N=>({...N,[t]:o})),a[t]&&f(N=>({...N,[t]:void 0}))},i=t=>{b(o=>({...o,receipt_images:t})),a.receipt_images&&f(o=>({...o,receipt_images:void 0}))},y=t=>{b(o=>({...o,other_images:t})),a.other_images&&f(o=>({...o,other_images:void 0}))},m=(t,o)=>{$(N=>{const I=new Map(N);return I.set(t,o),I}),j(N=>N.map(I=>I.id===t?{...I,imageFiles:o}:I))},C=(t,o)=>{console.log(`Upload progress for file ${t}: ${o.percentage}%`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(G,{to:`/project/${r}?tab=transactions`,className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700",children:[e.jsx(Pe,{className:"h-4 w-4 mr-1"}),"Back"]})})}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Add Transaction"})}),e.jsxs("form",{onSubmit:K,className:"space-y-8 p-8",children:[a.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsx("p",{children:a.general})})]})})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Transaction Source *"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mb-3",children:V.map(t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:`source_${t.toLowerCase().replace(/\s+/g,"_")}`,name:"source",value:t,checked:s.source===t,onChange:o=>{d("source",o.target.value),k(!1)},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:`source_${t.toLowerCase().replace(/\s+/g,"_")}`,className:"ml-2 block text-sm text-gray-900",children:t})]},t))}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"source_custom",name:"source",value:"custom",checked:T,onChange:()=>{k(!0),d("source","")},className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"source_custom",className:"ml-2 block text-sm text-gray-900",children:"Other"})]}),T&&e.jsx("input",{type:"text",id:"source_custom_input",value:s.source,onChange:t=>d("source",t.target.value),placeholder:"Enter custom source...",className:`mt-3 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${a.source?"border-red-300":"border-gray-300"}`}),a.source&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.source})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Budget Category *"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"budget_design_fee",name:"budget_category",value:"Design Fee",checked:s.budget_category==="Design Fee",onChange:t=>d("budget_category",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"budget_design_fee",className:"ml-2 block text-sm text-gray-900",children:"Design Fee"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"budget_furnishings",name:"budget_category",value:"Furnishings",checked:s.budget_category==="Furnishings",onChange:t=>d("budget_category",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"budget_furnishings",className:"ml-2 block text-sm text-gray-900",children:"Furnishings"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"budget_property_management",name:"budget_category",value:"Property Management",checked:s.budget_category==="Property Management",onChange:t=>d("budget_category",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"budget_property_management",className:"ml-2 block text-sm text-gray-900",children:"Property Management"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"budget_kitchen",name:"budget_category",value:"Kitchen",checked:s.budget_category==="Kitchen",onChange:t=>d("budget_category",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"budget_kitchen",className:"ml-2 block text-sm text-gray-900",children:"Kitchen"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"budget_install",name:"budget_category",value:"Install",checked:s.budget_category==="Install",onChange:t=>d("budget_category",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"budget_install",className:"ml-2 block text-sm text-gray-900",children:"Install"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"budget_storage_receiving",name:"budget_category",value:"Storage & Receiving",checked:s.budget_category==="Storage & Receiving",onChange:t=>d("budget_category",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"budget_storage_receiving",className:"ml-2 block text-sm text-gray-900",children:"Storage & Receiving"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"budget_fuel",name:"budget_category",value:"Fuel",checked:s.budget_category==="Fuel",onChange:t=>d("budget_category",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"budget_fuel",className:"ml-2 block text-sm text-gray-900",children:"Fuel"})]})]}),a.budget_category&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.budget_category})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Transaction Type *"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"type_purchase",name:"transaction_type",value:"Purchase",checked:s.transaction_type==="Purchase",onChange:t=>d("transaction_type",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"type_purchase",className:"ml-2 block text-sm text-gray-900",children:"Purchase"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"type_return",name:"transaction_type",value:"Return",checked:s.transaction_type==="Return",onChange:t=>d("transaction_type",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"type_return",className:"ml-2 block text-sm text-gray-900",children:"Return"})]})]}),a.transaction_type&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.transaction_type})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700",children:"Amount *"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),e.jsx("input",{type:"text",id:"amount",value:s.amount,onChange:t=>d("amount",t.target.value),placeholder:"0.00",className:`block w-full pl-8 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${a.amount?"border-red-300":"border-gray-300"}`})]}),a.amount&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.amount})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"transaction_date",className:"block text-sm font-medium text-gray-700",children:"Transaction Date *"}),e.jsx("input",{type:"date",id:"transaction_date",value:s.transaction_date,onChange:t=>{d("transaction_date",t.target.value)},className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${a.transaction_date?"border-red-300":"border-gray-300"}`}),a.transaction_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.transaction_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Transaction Method *"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"method_client_card",name:"payment_method",value:"Client Card",checked:s.payment_method==="Client Card",onChange:t=>d("payment_method",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"method_client_card",className:"ml-2 block text-sm text-gray-900",children:"Client Card"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"method_1584_card",name:"payment_method",value:"1584 Design",checked:s.payment_method==="1584 Design",onChange:t=>d("payment_method",t.target.value),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"method_1584_card",className:"ml-2 block text-sm text-gray-900",children:"1584 Design"})]})]}),a.payment_method&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.payment_method})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Receipt Email Copy"}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"receipt_yes",name:"receipt_emailed",checked:s.receipt_emailed===!0,onChange:()=>d("receipt_emailed",!0),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"receipt_yes",className:"ml-2 block text-sm text-gray-900",children:"Yes"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"receipt_no",name:"receipt_emailed",checked:s.receipt_emailed===!1,onChange:()=>d("receipt_emailed",!1),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300"}),e.jsx("label",{htmlFor:"receipt_no",className:"ml-2 block text-sm text-gray-900",children:"No"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notes"}),e.jsx("textarea",{id:"notes",rows:3,value:s.notes,onChange:t=>d("notes",t.target.value),placeholder:"Additional notes about this transaction...",className:`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${a.notes?"border-red-300":"border-gray-300"}`}),a.notes&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.notes})]}),e.jsxs("div",{children:[e.jsx(Ee,{items:h,onItemsChange:t=>{j(t),a.items&&t.length>0&&f(o=>({...o,items:void 0}))},projectId:r,projectName:v,onImageFilesChange:m}),a.items&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.items})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Receipt Images"}),e.jsx(pe,{onImagesChange:i,maxImages:5,maxFileSize:10,disabled:n||p,className:"mb-2"}),a.receipt_images&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.receipt_images})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Other Images"}),e.jsx(pe,{onImagesChange:y,maxImages:5,maxFileSize:10,disabled:n||p,className:"mb-2"}),a.other_images&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.other_images})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsxs(G,{to:`/project/${r}?tab=transactions`,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs("button",{type:"submit",disabled:n||p,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),n?"Creating...":p?"Uploading Images...":"Create Transaction"]})]})]})]})]})}export{Ve as default};
//# sourceMappingURL=AddTransaction.js.map
