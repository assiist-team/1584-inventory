{"version":3,"file":"ImagePreview.js","sources":["../../src/components/ui/ImageGallery.tsx","../../src/components/ui/ImagePreview.tsx"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport { X, ChevronLeft, ChevronRight, Download } from 'lucide-react'\nimport { ItemImage } from '@/types'\n\ninterface ImageGalleryProps {\n  images: ItemImage[]\n  initialIndex?: number\n  onClose: () => void\n}\n\nexport default function ImageGallery({ images, initialIndex = 0, onClose }: ImageGalleryProps) {\n  const [currentIndex, setCurrentIndex] = useState(initialIndex)\n  const [isLoaded, setIsLoaded] = useState(false)\n\n  // Handle keyboard navigation\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      switch (e.key) {\n        case 'Escape':\n          onClose()\n          break\n        case 'ArrowLeft':\n          e.preventDefault()\n          setCurrentIndex(prev => (prev > 0 ? prev - 1 : images.length - 1))\n          break\n        case 'ArrowRight':\n          e.preventDefault()\n          setCurrentIndex(prev => (prev < images.length - 1 ? prev + 1 : 0))\n          break\n      }\n    }\n\n    document.addEventListener('keydown', handleKeyDown)\n    return () => document.removeEventListener('keydown', handleKeyDown)\n  }, [onClose, images.length])\n\n  // Prevent body scroll when gallery is open\n  useEffect(() => {\n    document.body.style.overflow = 'hidden'\n    return () => {\n      document.body.style.overflow = 'unset'\n    }\n  }, [])\n\n  const currentImage = images[currentIndex]\n\n  const handlePrevious = () => {\n    setCurrentIndex(prev => (prev > 0 ? prev - 1 : images.length - 1))\n    setIsLoaded(false)\n  }\n\n  const handleNext = () => {\n    setCurrentIndex(prev => (prev < images.length - 1 ? prev + 1 : 0))\n    setIsLoaded(false)\n  }\n\n  const formatFileSize = (bytes: number): string => {\n    if (bytes === 0) return '0 Bytes'\n    const k = 1024\n    const sizes = ['Bytes', 'KB', 'MB', 'GB']\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\n    return (bytes / Math.pow(k, i)).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' ' + sizes[i]\n  }\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-black bg-opacity-90 flex items-center justify-center p-4\">\n      {/* Close button */}\n      <button\n        onClick={onClose}\n        className=\"absolute top-4 right-4 z-10 p-2 text-white hover:text-gray-300 transition-colors\"\n        aria-label=\"Close gallery\"\n      >\n        <X className=\"h-6 w-6\" />\n      </button>\n\n      {/* Navigation arrows */}\n      {images.length > 1 && (\n        <>\n          <button\n            onClick={handlePrevious}\n            className=\"absolute left-4 top-1/2 transform -translate-y-1/2 z-10 p-2 text-white hover:text-gray-300 transition-colors\"\n            aria-label=\"Previous image\"\n          >\n            <ChevronLeft className=\"h-8 w-8\" />\n          </button>\n          <button\n            onClick={handleNext}\n            className=\"absolute right-4 top-1/2 transform -translate-y-1/2 z-10 p-2 text-white hover:text-gray-300 transition-colors\"\n            aria-label=\"Next image\"\n          >\n            <ChevronRight className=\"h-8 w-8\" />\n          </button>\n        </>\n      )}\n\n      {/* Main image container */}\n      <div className=\"relative max-w-full max-h-full flex items-center justify-center\">\n        <img\n          src={currentImage.url}\n          alt={currentImage.alt || currentImage.fileName}\n          className=\"max-w-full max-h-full object-contain\"\n          onLoad={() => setIsLoaded(true)}\n          style={{ opacity: isLoaded ? 1 : 0, transition: 'opacity 0.3s ease' }}\n        />\n\n        {/* Loading placeholder */}\n        {!isLoaded && (\n          <div className=\"absolute inset-0 flex items-center justify-center\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-white\"></div>\n          </div>\n        )}\n      </div>\n\n      {/* Image info bar */}\n      <div className=\"absolute bottom-0 left-0 right-0 bg-black bg-opacity-70 text-white p-4\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex-1\">\n            <h3 className=\"text-sm font-medium truncate\">\n              {currentImage.alt || currentImage.fileName}\n            </h3>\n            {currentImage.caption && (\n              <p className=\"text-xs text-gray-300 mt-1\">{currentImage.caption}</p>\n            )}\n            <div className=\"flex items-center space-x-4 mt-1 text-xs text-gray-400\">\n              <span>{currentIndex + 1} of {images.length}</span>\n              <span>{formatFileSize(currentImage.size)}</span>\n              <span>\n                {(() => {\n                  try {\n                    return new Date(currentImage.uploadedAt).toLocaleDateString()\n                  } catch (error) {\n                    console.warn('Invalid date for image:', currentImage.uploadedAt, error)\n                    return 'Unknown date'\n                  }\n                })()}\n              </span>\n            </div>\n          </div>\n\n          {/* Download button */}\n          <button\n            onClick={() => window.open(currentImage.url, '_blank')}\n            className=\"p-2 text-white hover:text-gray-300 transition-colors ml-4\"\n            aria-label=\"Download image\"\n          >\n            <Download className=\"h-4 w-4\" />\n          </button>\n        </div>\n      </div>\n\n      {/* Image indicators */}\n      {images.length > 1 && (\n        <div className=\"absolute bottom-20 left-1/2 transform -translate-x-1/2 flex space-x-2\">\n          {images.map((_, index) => (\n            <button\n              key={index}\n              onClick={() => {\n                setCurrentIndex(index)\n                setIsLoaded(false)\n              }}\n              className={`w-2 h-2 rounded-full transition-colors ${\n                index === currentIndex ? 'bg-white' : 'bg-white bg-opacity-50'\n              }`}\n              aria-label={`Go to image ${index + 1}`}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}\n","import React, { useState, useEffect } from 'react'\nimport { Plus, ChevronDown, Trash2, Star, ExternalLink, Crown } from 'lucide-react'\nimport { ItemImage, TransactionImage } from '@/types'\nimport ImageGallery from './ImageGallery'\n\ninterface ImagePreviewProps {\n  images: ItemImage[]\n  onAddImage?: () => void\n  onRemoveImage?: (imageUrl: string) => void\n  onSetPrimary?: (imageUrl: string) => void\n  maxImages?: number\n  showControls?: boolean\n  size?: 'sm' | 'md' | 'lg'\n  className?: string\n}\n\ninterface TransactionImagePreviewProps {\n  images: TransactionImage[]\n  onRemoveImage?: (imageUrl: string) => void\n  maxImages?: number\n  showControls?: boolean\n  size?: 'sm' | 'md' | 'lg'\n  className?: string\n  onImageClick?: (index: number) => void\n}\n\nexport default function ImagePreview({\n  images,\n  onAddImage,\n  onRemoveImage,\n  onSetPrimary,\n  maxImages = 5,\n  showControls = true,\n  size = 'md',\n  className = ''\n}: ImagePreviewProps) {\n  const [showGallery, setShowGallery] = useState(false)\n  const [galleryInitialIndex, setGalleryInitialIndex] = useState(0)\n  const [openMenuIndex, setOpenMenuIndex] = useState<number | null>(null)\n\n  const sizeClasses = {\n    sm: 'w-20 h-20 sm:w-16 sm:h-16',\n    md: 'w-24 h-24 sm:w-20 sm:h-20',\n    lg: 'w-28 h-28 sm:w-24 sm:h-24'\n  }\n\n  const handleImageClick = (index: number) => {\n    setGalleryInitialIndex(index)\n    setShowGallery(true)\n  }\n\n  const handleGalleryClose = () => {\n    setShowGallery(false)\n  }\n\n\n  const toggleMenu = (e: React.MouseEvent, index: number) => {\n    e.stopPropagation()\n    setOpenMenuIndex(openMenuIndex === index ? null : index)\n  }\n\n  const handleMenuAction = (e: React.MouseEvent, action: string, imageUrl: string, index: number) => {\n    e.stopPropagation()\n    setOpenMenuIndex(null)\n\n    switch (action) {\n      case 'open':\n        handleImageClick(index)\n        break\n      case 'setPrimary':\n        onSetPrimary?.(imageUrl)\n        break\n      case 'delete':\n        onRemoveImage?.(imageUrl)\n        break\n    }\n  }\n\n  // Close menu when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (e: MouseEvent) => {\n      if (openMenuIndex !== null && !(e.target as Element).closest('.image-menu-container')) {\n        setOpenMenuIndex(null)\n      }\n    }\n\n    document.addEventListener('click', handleClickOutside)\n    return () => document.removeEventListener('click', handleClickOutside)\n  }, [openMenuIndex])\n\n  if (images.length === 0 && !onAddImage) {\n    return null\n  }\n\n  return (\n    <>\n      <div className={`space-y-3 ${className}`}>\n        {/* Images grid */}\n        {images.length > 0 && (\n          <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3 sm:gap-4 md:gap-6\" style={{width: 'fit-content'}}>\n            {images.map((image, index) => (\n              <div\n                key={image.url}\n                className={`${sizeClasses[size]} relative group cursor-pointer rounded-lg overflow-visible border-2 ${\n                  image.isPrimary ? 'border-primary-500 ring-2 ring-primary-200' : 'border-gray-200'\n                }`}\n                onClick={() => handleImageClick(index)}\n              >\n                <img\n                  src={image.url}\n                  alt={image.alt || image.fileName}\n                  className=\"w-full h-full object-cover transition-transform group-hover:scale-105\"\n                />\n\n                {/* Primary indicator */}\n                {image.isPrimary && (\n                  <div className=\"absolute top-1 left-1 bg-yellow-500 text-white text-xs p-1 rounded flex items-center justify-center\">\n                    <Crown className=\"h-3 w-3 fill-current\" />\n                  </div>\n                )}\n\n                {/* Controls overlay - Mobile-first design with chevron menu */}\n                {showControls && (\n                  <div className=\"absolute inset-0 bg-transparent transition-all duration-200\">\n                    {/* Chevron menu button - Upper right corner */}\n                    <div className=\"absolute top-1 right-1 image-menu-container\">\n                      <button\n                        onClick={(e) => toggleMenu(e, index)}\n                        className=\"p-1.5 bg-primary-500 bg-opacity-40 rounded-full text-white border border-white hover:bg-primary-500 hover:bg-opacity-50 hover:text-white transition-colors\"\n                        title=\"Image options\"\n                      >\n                        <ChevronDown className=\"h-3 w-3\" />\n                      </button>\n\n                      {/* Dropdown menu */}\n                      {openMenuIndex === index && (\n                        <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 mt-1 w-32 bg-white rounded-md shadow-lg border border-gray-200 py-1 z-50\" style={{\n                          transform: 'translateY(0)',\n                          maxHeight: 'calc(100vh - 100px)',\n                          overflowY: 'auto'\n                        }}>\n                          <button\n                            onClick={(e) => handleMenuAction(e, 'open', image.url, index)}\n                            className=\"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center transition-colors\"\n                          >\n                            <ExternalLink className=\"h-4 w-4 mr-2\" />\n                            <span>Open</span>\n                          </button>\n                          {!image.isPrimary && onSetPrimary && (\n                            <button\n                              onClick={(e) => handleMenuAction(e, 'setPrimary', image.url, index)}\n                              className=\"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center transition-colors\"\n                            >\n                              <Star className=\"h-4 w-4 mr-2\" />\n                              <span>Primary</span>\n                            </button>\n                          )}\n                          {onRemoveImage && (\n                            <button\n                              onClick={(e) => handleMenuAction(e, 'delete', image.url, index)}\n                              className=\"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center transition-colors\"\n                            >\n                              <Trash2 className=\"h-4 w-4 mr-2\" />\n                              <span>Delete</span>\n                            </button>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                )}\n\n              </div>\n            ))}\n\n            {/* Add image button */}\n            {onAddImage && images.length < maxImages && (\n              <button\n                onClick={onAddImage}\n                className={`${sizeClasses[size]} border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center text-gray-400 hover:text-gray-600 hover:border-gray-400 transition-colors`}\n                title=\"Add image\"\n              >\n                <Plus className=\"h-5 w-5\" />\n              </button>\n            )}\n          </div>\n        )}\n\n        {/* Add image button when no images exist */}\n        {!images.length && onAddImage && (\n          <button\n            onClick={onAddImage}\n            className={`${sizeClasses[size]} border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center text-gray-400 hover:text-gray-600 hover:border-gray-400 transition-colors w-full`}\n            title=\"Add image\"\n          >\n            <Plus className=\"h-5 w-5\" />\n          </button>\n        )}\n\n        {/* Image count */}\n        {images.length > 0 && (\n          <p className=\"text-xs text-gray-500\">\n            {images.length} image{images.length !== 1 ? 's' : ''}\n            {maxImages && ` (max ${maxImages})`}\n          </p>\n        )}\n      </div>\n\n      {/* Image gallery modal */}\n      {showGallery && (\n        <ImageGallery\n          images={images}\n          initialIndex={galleryInitialIndex}\n          onClose={handleGalleryClose}\n        />\n      )}\n    </>\n  )\n}\n\n// Transaction Image Preview Component - for receipt and other transaction images\n// This component is similar to ImagePreview but without the Primary option\nexport function TransactionImagePreview({\n  images,\n  onRemoveImage,\n  showControls = true,\n  size = 'md',\n  className = '',\n  onImageClick\n}: TransactionImagePreviewProps) {\n  const [showGallery, setShowGallery] = useState(false)\n  const [galleryInitialIndex, setGalleryInitialIndex] = useState(0)\n  const [openMenuIndex, setOpenMenuIndex] = useState<number | null>(null)\n\n  const sizeClasses = {\n    sm: 'w-20 h-20 sm:w-16 sm:h-16',\n    md: 'w-24 h-24 sm:w-20 sm:h-20',\n    lg: 'w-28 h-28 sm:w-24 sm:h-24'\n  }\n\n  const handleImageClick = (index: number) => {\n    if (onImageClick) {\n      onImageClick(index)\n    } else {\n      setGalleryInitialIndex(index)\n      setShowGallery(true)\n    }\n  }\n\n  const handleGalleryClose = () => {\n    setShowGallery(false)\n  }\n\n  const toggleMenu = (e: React.MouseEvent, index: number) => {\n    e.stopPropagation()\n    setOpenMenuIndex(openMenuIndex === index ? null : index)\n  }\n\n  const handleMenuAction = (e: React.MouseEvent, action: string, imageUrl: string, index: number) => {\n    e.stopPropagation()\n    setOpenMenuIndex(null)\n\n    switch (action) {\n      case 'open':\n        handleImageClick(index)\n        break\n      case 'delete':\n        onRemoveImage?.(imageUrl)\n        break\n    }\n  }\n\n  // Close menu when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (e: MouseEvent) => {\n      if (openMenuIndex !== null && !(e.target as Element).closest('.image-menu-container')) {\n        setOpenMenuIndex(null)\n      }\n    }\n\n    document.addEventListener('click', handleClickOutside)\n    return () => document.removeEventListener('click', handleClickOutside)\n  }, [openMenuIndex])\n\n  if (images.length === 0) {\n    return null\n  }\n\n  return (\n    <>\n      <div className={`space-y-3 ${className}`}>\n        {/* Images grid */}\n        <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3 sm:gap-4 md:gap-6\" style={{width: 'fit-content'}}>\n          {images.map((image, index) => (\n            <div\n              key={image.url}\n              className={`${sizeClasses[size]} relative group cursor-pointer rounded-lg overflow-visible border-2 border-gray-200`}\n              onClick={() => handleImageClick(index)}\n            >\n              <img\n                src={image.url}\n                alt={image.fileName}\n                className=\"w-full h-full object-cover transition-transform group-hover:scale-105\"\n              />\n\n              {/* Controls overlay - Mobile-first design with chevron menu */}\n              {showControls && (\n                <div className=\"absolute inset-0 bg-transparent transition-all duration-200\">\n                  {/* Chevron menu button - Upper right corner */}\n                  <div className=\"absolute top-1 right-1 image-menu-container\">\n                    <button\n                      onClick={(e) => toggleMenu(e, index)}\n                      className=\"p-1.5 bg-primary-500 bg-opacity-40 rounded-full text-white border border-white hover:bg-primary-500 hover:bg-opacity-50 hover:text-white transition-colors\"\n                      title=\"Image options\"\n                    >\n                      <ChevronDown className=\"h-3 w-3\" />\n                    </button>\n\n                    {/* Dropdown menu */}\n                    {openMenuIndex === index && (\n                      <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 mt-1 w-32 bg-white rounded-md shadow-lg border border-gray-200 py-1 z-50\" style={{\n                        transform: 'translateY(0)',\n                        maxHeight: 'calc(100vh - 100px)',\n                        overflowY: 'auto'\n                      }}>\n                        <button\n                          onClick={(e) => handleMenuAction(e, 'open', image.url, index)}\n                          className=\"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center transition-colors\"\n                        >\n                          <ExternalLink className=\"h-4 w-4 mr-2\" />\n                          <span>Open</span>\n                        </button>\n                        {onRemoveImage && (\n                          <button\n                            onClick={(e) => handleMenuAction(e, 'delete', image.url, index)}\n                            className=\"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center transition-colors\"\n                          >\n                            <Trash2 className=\"h-4 w-4 mr-2\" />\n                            <span>Delete</span>\n                          </button>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Image gallery modal */}\n      {showGallery && (\n        <ImageGallery\n          images={images.map(img => ({\n            url: img.url,\n            alt: img.fileName,\n            isPrimary: false,\n            uploadedAt: new Date(),\n            fileName: img.fileName,\n            size: 0,\n            mimeType: 'image/jpeg'\n          }))}\n          initialIndex={galleryInitialIndex}\n          onClose={handleGalleryClose}\n        />\n      )}\n    </>\n  )\n}\n"],"names":["ImageGallery","images","initialIndex","onClose","currentIndex","setCurrentIndex","useState","isLoaded","setIsLoaded","useEffect","handleKeyDown","e","prev","currentImage","handlePrevious","handleNext","formatFileSize","bytes","k","sizes","i","jsxs","jsx","X","Fragment","ChevronLeft","ChevronRight","error","Download","_","index","ImagePreview","onAddImage","onRemoveImage","onSetPrimary","maxImages","showControls","size","className","showGallery","setShowGallery","galleryInitialIndex","setGalleryInitialIndex","openMenuIndex","setOpenMenuIndex","sizeClasses","handleImageClick","handleGalleryClose","toggleMenu","handleMenuAction","action","imageUrl","handleClickOutside","image","Crown","ChevronDown","ExternalLink","Star","Trash2","Plus","TransactionImagePreview","onImageClick","img"],"mappings":"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"}