{"version":3,"file":"ImagePreview.js","sources":["../../src/components/ui/ImageGallery.tsx","../../src/components/ui/ImagePreview.tsx"],"sourcesContent":["import { useState, useEffect, useRef, useCallback } from 'react'\nimport { X, ChevronLeft, ChevronRight, Download, ZoomIn, ZoomOut, RotateCcw } from 'lucide-react'\nimport { ItemImage } from '@/types'\n\ninterface ImageGalleryProps {\n  images: ItemImage[]\n  initialIndex?: number\n  onClose: () => void\n}\n\nexport default function ImageGallery({ images, initialIndex = 0, onClose }: ImageGalleryProps) {\n  const [currentIndex, setCurrentIndex] = useState(initialIndex)\n  const [isLoaded, setIsLoaded] = useState(false)\n  const [zoom, setZoom] = useState(1)\n  const [panX, setPanX] = useState(0)\n  const [panY, setPanY] = useState(0)\n  const [isDragging, setIsDragging] = useState(false)\n  const [dragStart, setDragStart] = useState({ x: 0, y: 0 })\n  const imageContainerRef = useRef<HTMLDivElement>(null)\n  const imageRef = useRef<HTMLImageElement>(null)\n\n  // Reset zoom and pan when image changes\n  useEffect(() => {\n    setZoom(1)\n    setPanX(0)\n    setPanY(0)\n  }, [currentIndex])\n\n  const handleZoomIn = useCallback(() => {\n    setZoom(prev => Math.min(prev + 0.5, 5))\n  }, [])\n\n  const handleZoomOut = useCallback(() => {\n    setZoom(prev => {\n      const newZoom = Math.max(prev - 0.5, 1)\n      if (newZoom === 1) {\n        setPanX(0)\n        setPanY(0)\n      }\n      return newZoom\n    })\n  }, [])\n\n  const handleResetZoom = useCallback(() => {\n    setZoom(1)\n    setPanX(0)\n    setPanY(0)\n  }, [])\n\n  // Handle keyboard navigation\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      // If zoomed, allow panning with arrow keys\n      if (zoom > 1) {\n        switch (e.key) {\n          case 'ArrowLeft':\n            e.preventDefault()\n            setPanX(prev => Math.min(0, prev + 50))\n            return\n          case 'ArrowRight':\n            e.preventDefault()\n            setPanX(prev => Math.max(0, prev - 50))\n            return\n          case 'ArrowUp':\n            e.preventDefault()\n            setPanY(prev => Math.min(0, prev + 50))\n            return\n          case 'ArrowDown':\n            e.preventDefault()\n            setPanY(prev => Math.max(0, prev - 50))\n            return\n        }\n      }\n\n      switch (e.key) {\n        case 'Escape':\n          if (zoom > 1) {\n            // Reset zoom first\n            handleResetZoom()\n          } else {\n            onClose()\n          }\n          break\n        case 'ArrowLeft':\n          e.preventDefault()\n          setCurrentIndex(prev => (prev > 0 ? prev - 1 : images.length - 1))\n          break\n        case 'ArrowRight':\n          e.preventDefault()\n          setCurrentIndex(prev => (prev < images.length - 1 ? prev + 1 : 0))\n          break\n        case '+':\n        case '=':\n          e.preventDefault()\n          handleZoomIn()\n          break\n        case '-':\n        case '_':\n          e.preventDefault()\n          handleZoomOut()\n          break\n        case '0':\n          e.preventDefault()\n          handleResetZoom()\n          break\n      }\n    }\n\n    document.addEventListener('keydown', handleKeyDown)\n    return () => document.removeEventListener('keydown', handleKeyDown)\n  }, [onClose, images.length, zoom, handleZoomIn, handleZoomOut, handleResetZoom])\n\n  // Prevent body scroll when gallery is open\n  useEffect(() => {\n    document.body.style.overflow = 'hidden'\n    return () => {\n      document.body.style.overflow = 'unset'\n    }\n  }, [])\n\n  const currentImage = images[currentIndex]\n\n  const handlePrevious = () => {\n    setCurrentIndex(prev => (prev > 0 ? prev - 1 : images.length - 1))\n    setIsLoaded(false)\n  }\n\n  const handleNext = () => {\n    setCurrentIndex(prev => (prev < images.length - 1 ? prev + 1 : 0))\n    setIsLoaded(false)\n  }\n\n  const handleWheel = (e: React.WheelEvent) => {\n    e.preventDefault()\n    const delta = e.deltaY > 0 ? -0.2 : 0.2\n    const newZoom = Math.max(1, Math.min(5, zoom + delta))\n    setZoom(newZoom)\n    if (newZoom === 1) {\n      setPanX(0)\n      setPanY(0)\n    }\n  }\n\n  const handleMouseDown = (e: React.MouseEvent) => {\n    if (zoom > 1) {\n      setIsDragging(true)\n      setDragStart({ x: e.clientX - panX, y: e.clientY - panY })\n    }\n  }\n\n  const handleMouseMove = (e: React.MouseEvent) => {\n    if (isDragging && zoom > 1) {\n      setPanX(e.clientX - dragStart.x)\n      setPanY(e.clientY - dragStart.y)\n    }\n  }\n\n  const handleMouseUp = () => {\n    setIsDragging(false)\n  }\n\n  // Touch handlers for pinch-to-zoom and pan\n  const touchStartRef = useRef<{ distance: number; centerX: number; centerY: number } | null>(null)\n\n  const getTouchDistance = (touches: React.TouchList): number => {\n    const touch1 = touches[0]\n    const touch2 = touches[1]\n    return Math.hypot(touch2.clientX - touch1.clientX, touch2.clientY - touch1.clientY)\n  }\n\n  const getTouchCenter = (touches: React.TouchList): { x: number; y: number } => {\n    const touch1 = touches[0]\n    const touch2 = touches[1]\n    return {\n      x: (touch1.clientX + touch2.clientX) / 2,\n      y: (touch1.clientY + touch2.clientY) / 2\n    }\n  }\n\n  const handleTouchStart = (e: React.TouchEvent) => {\n    if (e.touches.length === 2) {\n      const distance = getTouchDistance(e.touches)\n      const center = getTouchCenter(e.touches)\n      touchStartRef.current = { distance, centerX: center.x, centerY: center.y }\n    } else if (e.touches.length === 1 && zoom > 1) {\n      setIsDragging(true)\n      setDragStart({ x: e.touches[0].clientX - panX, y: e.touches[0].clientY - panY })\n    }\n  }\n\n  const handleTouchMove = (e: React.TouchEvent) => {\n    if (e.touches.length === 2 && touchStartRef.current) {\n      e.preventDefault()\n      const currentDistance = getTouchDistance(e.touches)\n      const startDistance = touchStartRef.current.distance\n      const scale = currentDistance / startDistance\n      const newZoom = Math.max(1, Math.min(5, zoom * scale))\n      setZoom(newZoom)\n      if (newZoom === 1) {\n        setPanX(0)\n        setPanY(0)\n      }\n    } else if (e.touches.length === 1 && isDragging && zoom > 1) {\n      e.preventDefault()\n      setPanX(e.touches[0].clientX - dragStart.x)\n      setPanY(e.touches[0].clientY - dragStart.y)\n    }\n  }\n\n  const handleTouchEnd = () => {\n    touchStartRef.current = null\n    setIsDragging(false)\n  }\n\n  const formatFileSize = (bytes: number): string => {\n    if (bytes === 0) return '0 Bytes'\n    const k = 1024\n    const sizes = ['Bytes', 'KB', 'MB', 'GB']\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\n    return (bytes / Math.pow(k, i)).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' ' + sizes[i]\n  }\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-black bg-opacity-90 flex items-center justify-center p-4\">\n      {/* Close button */}\n      <button\n        onClick={onClose}\n        className=\"absolute top-4 right-4 z-10 p-2 text-white hover:text-gray-300 transition-colors\"\n        aria-label=\"Close gallery\"\n      >\n        <X className=\"h-6 w-6\" />\n      </button>\n\n      {/* Navigation arrows */}\n      {images.length > 1 && (\n        <>\n          <button\n            onClick={handlePrevious}\n            className=\"absolute left-4 top-1/2 transform -translate-y-1/2 z-10 p-2 text-white hover:text-gray-300 transition-colors\"\n            aria-label=\"Previous image\"\n          >\n            <ChevronLeft className=\"h-8 w-8\" />\n          </button>\n          <button\n            onClick={handleNext}\n            className=\"absolute right-4 top-1/2 transform -translate-y-1/2 z-10 p-2 text-white hover:text-gray-300 transition-colors\"\n            aria-label=\"Next image\"\n          >\n            <ChevronRight className=\"h-8 w-8\" />\n          </button>\n        </>\n      )}\n\n      {/* Zoom controls */}\n      <div className=\"absolute top-4 left-4 z-10 flex flex-col gap-2\">\n        <button\n          onClick={handleZoomIn}\n          className=\"p-2 bg-black bg-opacity-50 text-white hover:bg-opacity-70 transition-colors rounded\"\n          aria-label=\"Zoom in\"\n          title=\"Zoom in (+)\"\n        >\n          <ZoomIn className=\"h-5 w-5\" />\n        </button>\n        <button\n          onClick={handleZoomOut}\n          disabled={zoom <= 1}\n          className=\"p-2 bg-black bg-opacity-50 text-white hover:bg-opacity-70 transition-colors rounded disabled:opacity-50 disabled:cursor-not-allowed\"\n          aria-label=\"Zoom out\"\n          title=\"Zoom out (-)\"\n        >\n          <ZoomOut className=\"h-5 w-5\" />\n        </button>\n        {zoom > 1 && (\n          <button\n            onClick={handleResetZoom}\n            className=\"p-2 bg-black bg-opacity-50 text-white hover:bg-opacity-70 transition-colors rounded\"\n            aria-label=\"Reset zoom\"\n            title=\"Reset zoom (0)\"\n          >\n            <RotateCcw className=\"h-5 w-5\" />\n          </button>\n        )}\n      </div>\n\n      {/* Main image container */}\n      <div\n        ref={imageContainerRef}\n        className=\"relative w-full h-full flex items-center justify-center overflow-hidden cursor-grab active:cursor-grabbing\"\n        onWheel={handleWheel}\n        onMouseDown={handleMouseDown}\n        onMouseMove={handleMouseMove}\n        onMouseUp={handleMouseUp}\n        onMouseLeave={handleMouseUp}\n        onTouchStart={handleTouchStart}\n        onTouchMove={handleTouchMove}\n        onTouchEnd={handleTouchEnd}\n      >\n        <img\n          ref={imageRef}\n          src={currentImage.url}\n          alt={currentImage.alt || currentImage.fileName}\n          className=\"max-w-full max-h-full object-contain select-none\"\n          onLoad={() => setIsLoaded(true)}\n          style={{\n            opacity: isLoaded ? 1 : 0,\n            transition: zoom === 1 ? 'opacity 0.3s ease' : 'none',\n            transform: `scale(${zoom}) translate(${panX / zoom}px, ${panY / zoom}px)`,\n            cursor: zoom > 1 ? 'grab' : 'default'\n          }}\n          draggable={false}\n        />\n\n        {/* Loading placeholder */}\n        {!isLoaded && (\n          <div className=\"absolute inset-0 flex items-center justify-center\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-white\"></div>\n          </div>\n        )}\n      </div>\n\n      {/* Image info bar */}\n      <div className=\"absolute bottom-0 left-0 right-0 bg-black bg-opacity-70 text-white p-4\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex-1\">\n            <h3 className=\"text-sm font-medium truncate\">\n              {currentImage.alt || currentImage.fileName}\n            </h3>\n            {currentImage.caption && (\n              <p className=\"text-xs text-gray-300 mt-1\">{currentImage.caption}</p>\n            )}\n            <div className=\"flex items-center space-x-4 mt-1 text-xs text-gray-400\">\n              <span>{currentIndex + 1} of {images.length}</span>\n              <span>{formatFileSize(currentImage.size)}</span>\n              <span>\n                {(() => {\n                  try {\n                    return new Date(currentImage.uploadedAt).toLocaleDateString()\n                  } catch (error) {\n                    console.warn('Invalid date for image:', currentImage.uploadedAt, error)\n                    return 'Unknown date'\n                  }\n                })()}\n              </span>\n            </div>\n          </div>\n\n          {/* Download button */}\n          <button\n            onClick={() => window.open(currentImage.url, '_blank')}\n            className=\"p-2 text-white hover:text-gray-300 transition-colors ml-4\"\n            aria-label=\"Download image\"\n          >\n            <Download className=\"h-4 w-4\" />\n          </button>\n        </div>\n      </div>\n\n      {/* Image indicators */}\n      {images.length > 1 && (\n        <div className=\"absolute bottom-20 left-1/2 transform -translate-x-1/2 flex space-x-2\">\n          {images.map((_, index) => (\n            <button\n              key={index}\n              onClick={() => {\n                setCurrentIndex(index)\n                setIsLoaded(false)\n              }}\n              className={`w-2 h-2 rounded-full transition-colors ${\n                index === currentIndex ? 'bg-white' : 'bg-white bg-opacity-50'\n              }`}\n              aria-label={`Go to image ${index + 1}`}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}\n","import React, { useState, useEffect } from 'react'\nimport { Plus, ChevronDown, Trash2, Star, ExternalLink, Crown } from 'lucide-react'\nimport { ItemImage, TransactionImage } from '@/types'\nimport ImageGallery from './ImageGallery'\n\ninterface ImagePreviewProps {\n  images: ItemImage[]\n  onAddImage?: () => void\n  onRemoveImage?: (imageUrl: string) => void\n  onSetPrimary?: (imageUrl: string) => void\n  maxImages?: number\n  showControls?: boolean\n  size?: 'sm' | 'md' | 'lg'\n  className?: string\n}\n\ninterface TransactionImagePreviewProps {\n  images: TransactionImage[]\n  onRemoveImage?: (imageUrl: string) => void\n  maxImages?: number\n  showControls?: boolean\n  size?: 'sm' | 'md' | 'lg'\n  className?: string\n  onImageClick?: (index: number) => void\n}\n\nexport default function ImagePreview({\n  images,\n  onAddImage,\n  onRemoveImage,\n  onSetPrimary,\n  maxImages = 5,\n  showControls = true,\n  size = 'md',\n  className = ''\n}: ImagePreviewProps) {\n  const [showGallery, setShowGallery] = useState(false)\n  const [galleryInitialIndex, setGalleryInitialIndex] = useState(0)\n  const [openMenuIndex, setOpenMenuIndex] = useState<number | null>(null)\n\n  const sizeClasses = {\n    sm: 'w-20 h-20 sm:w-16 sm:h-16',\n    md: 'w-24 h-24 sm:w-20 sm:h-20',\n    lg: 'w-28 h-28 sm:w-24 sm:h-24'\n  }\n\n  const handleImageClick = (index: number) => {\n    setGalleryInitialIndex(index)\n    setShowGallery(true)\n  }\n\n  const handleGalleryClose = () => {\n    setShowGallery(false)\n  }\n\n\n  const toggleMenu = (e: React.MouseEvent, index: number) => {\n    e.stopPropagation()\n    setOpenMenuIndex(openMenuIndex === index ? null : index)\n  }\n\n  const handleMenuAction = (e: React.MouseEvent, action: string, imageUrl: string, index: number) => {\n    e.stopPropagation()\n    setOpenMenuIndex(null)\n\n    switch (action) {\n      case 'open':\n        handleImageClick(index)\n        break\n      case 'setPrimary':\n        onSetPrimary?.(imageUrl)\n        break\n      case 'delete':\n        onRemoveImage?.(imageUrl)\n        break\n    }\n  }\n\n  // Close menu when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (e: MouseEvent) => {\n      if (openMenuIndex !== null && !(e.target as Element).closest('.image-menu-container')) {\n        setOpenMenuIndex(null)\n      }\n    }\n\n    document.addEventListener('click', handleClickOutside)\n    return () => document.removeEventListener('click', handleClickOutside)\n  }, [openMenuIndex])\n\n  if (images.length === 0 && !onAddImage) {\n    return null\n  }\n\n  return (\n    <>\n      <div className={`space-y-3 ${className}`}>\n        {/* Images grid */}\n        {images.length > 0 && (\n          <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3 sm:gap-4 md:gap-6\" style={{width: 'fit-content'}}>\n            {images.map((image, index) => (\n              <div\n                key={image.url}\n                className={`${sizeClasses[size]} relative group cursor-pointer rounded-lg overflow-visible border-2 ${\n                  image.isPrimary ? 'border-primary-500 ring-2 ring-primary-200' : 'border-gray-200'\n                }`}\n                onClick={() => handleImageClick(index)}\n              >\n                <img\n                  src={image.url}\n                  alt={image.alt || image.fileName}\n                  className=\"w-full h-full object-cover transition-transform group-hover:scale-105\"\n                />\n\n                {/* Primary indicator */}\n                {image.isPrimary && (\n                  <div className=\"absolute top-1 left-1 bg-primary-500 bg-opacity-40 text-white text-xs p-1 rounded flex items-center justify-center border border-white\">\n                    <Crown className=\"h-3 w-3 fill-current\" />\n                  </div>\n                )}\n\n                {/* Controls overlay - Mobile-first design with chevron menu */}\n                {showControls && (\n                  <div className=\"absolute inset-0 bg-transparent transition-all duration-200\">\n                    {/* Chevron menu button - Upper right corner */}\n                    <div className=\"absolute top-1 right-1 image-menu-container\">\n                      <button\n                        onClick={(e) => toggleMenu(e, index)}\n                        className=\"p-1.5 bg-primary-500 bg-opacity-40 rounded-full text-white border border-white hover:bg-primary-500 hover:bg-opacity-50 hover:text-white transition-colors\"\n                        title=\"Image options\"\n                      >\n                        <ChevronDown className=\"h-3 w-3\" />\n                      </button>\n\n                      {/* Dropdown menu */}\n                      {openMenuIndex === index && (\n                        <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 mt-1 w-32 bg-white rounded-md shadow-lg border border-gray-200 py-1 z-50\" style={{\n                          transform: 'translateY(0)',\n                          maxHeight: 'calc(100vh - 100px)',\n                          overflowY: 'auto'\n                        }}>\n                          <button\n                            onClick={(e) => handleMenuAction(e, 'open', image.url, index)}\n                            className=\"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center transition-colors\"\n                          >\n                            <ExternalLink className=\"h-4 w-4 mr-2\" />\n                            <span>Open</span>\n                          </button>\n                          {!image.isPrimary && onSetPrimary && (\n                            <button\n                              onClick={(e) => handleMenuAction(e, 'setPrimary', image.url, index)}\n                              className=\"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center transition-colors\"\n                            >\n                              <Star className=\"h-4 w-4 mr-2\" />\n                              <span>Primary</span>\n                            </button>\n                          )}\n                          {onRemoveImage && (\n                            <button\n                              onClick={(e) => handleMenuAction(e, 'delete', image.url, index)}\n                              className=\"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center transition-colors\"\n                            >\n                              <Trash2 className=\"h-4 w-4 mr-2\" />\n                              <span>Delete</span>\n                            </button>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                )}\n\n              </div>\n            ))}\n\n            {/* Add image button */}\n            {onAddImage && images.length < maxImages && (\n              <button\n                onClick={onAddImage}\n                className={`${sizeClasses[size]} border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center text-gray-400 hover:text-gray-600 hover:border-gray-400 transition-colors`}\n                title=\"Add image\"\n              >\n                <Plus className=\"h-5 w-5\" />\n              </button>\n            )}\n          </div>\n        )}\n\n        {/* Add image button when no images exist */}\n        {!images.length && onAddImage && (\n          <button\n            onClick={onAddImage}\n            className={`${sizeClasses[size]} border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center text-gray-400 hover:text-gray-600 hover:border-gray-400 transition-colors w-full`}\n            title=\"Add image\"\n          >\n            <Plus className=\"h-5 w-5\" />\n          </button>\n        )}\n\n        {/* Image count */}\n        {images.length > 0 && (\n          <p className=\"text-xs text-gray-500\">\n            {images.length} image{images.length !== 1 ? 's' : ''}\n            {maxImages && ` (max ${maxImages})`}\n          </p>\n        )}\n      </div>\n\n      {/* Image gallery modal */}\n      {showGallery && (\n        <ImageGallery\n          images={images}\n          initialIndex={galleryInitialIndex}\n          onClose={handleGalleryClose}\n        />\n      )}\n    </>\n  )\n}\n\n// Transaction Image Preview Component - for receipt and other transaction images\n// This component is similar to ImagePreview but without the Primary option\nexport function TransactionImagePreview({\n  images,\n  onRemoveImage,\n  showControls = true,\n  size = 'md',\n  className = '',\n  onImageClick\n}: TransactionImagePreviewProps) {\n  const [showGallery, setShowGallery] = useState(false)\n  const [galleryInitialIndex, setGalleryInitialIndex] = useState(0)\n  const [openMenuIndex, setOpenMenuIndex] = useState<number | null>(null)\n\n  const sizeClasses = {\n    sm: 'w-20 h-20 sm:w-16 sm:h-16',\n    md: 'w-24 h-24 sm:w-20 sm:h-20',\n    lg: 'w-28 h-28 sm:w-24 sm:h-24'\n  }\n\n  const handleImageClick = (index: number) => {\n    if (onImageClick) {\n      onImageClick(index)\n    } else {\n      setGalleryInitialIndex(index)\n      setShowGallery(true)\n    }\n  }\n\n  const handleGalleryClose = () => {\n    setShowGallery(false)\n  }\n\n  const toggleMenu = (e: React.MouseEvent, index: number) => {\n    e.stopPropagation()\n    setOpenMenuIndex(openMenuIndex === index ? null : index)\n  }\n\n  const handleMenuAction = (e: React.MouseEvent, action: string, imageUrl: string, index: number) => {\n    e.stopPropagation()\n    setOpenMenuIndex(null)\n\n    switch (action) {\n      case 'open':\n        handleImageClick(index)\n        break\n      case 'delete':\n        onRemoveImage?.(imageUrl)\n        break\n    }\n  }\n\n  // Close menu when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (e: MouseEvent) => {\n      if (openMenuIndex !== null && !(e.target as Element).closest('.image-menu-container')) {\n        setOpenMenuIndex(null)\n      }\n    }\n\n    document.addEventListener('click', handleClickOutside)\n    return () => document.removeEventListener('click', handleClickOutside)\n  }, [openMenuIndex])\n\n  if (images.length === 0) {\n    return null\n  }\n\n  return (\n    <>\n      <div className={`space-y-3 ${className}`}>\n        {/* Images grid */}\n        <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3 sm:gap-4 md:gap-6\" style={{width: 'fit-content'}}>\n          {images.map((image, index) => (\n            <div\n              key={image.url}\n              className={`${sizeClasses[size]} relative group cursor-pointer rounded-lg overflow-visible border-2 border-gray-200`}\n              onClick={() => handleImageClick(index)}\n            >\n              <img\n                src={image.url}\n                alt={image.fileName}\n                className=\"w-full h-full object-cover transition-transform group-hover:scale-105\"\n              />\n\n              {/* Controls overlay - Mobile-first design with chevron menu */}\n              {showControls && (\n                <div className=\"absolute inset-0 bg-transparent transition-all duration-200\">\n                  {/* Chevron menu button - Upper right corner */}\n                  <div className=\"absolute top-1 right-1 image-menu-container\">\n                    <button\n                      onClick={(e) => toggleMenu(e, index)}\n                      className=\"p-1.5 bg-primary-500 bg-opacity-40 rounded-full text-white border border-white hover:bg-primary-500 hover:bg-opacity-50 hover:text-white transition-colors\"\n                      title=\"Image options\"\n                    >\n                      <ChevronDown className=\"h-3 w-3\" />\n                    </button>\n\n                    {/* Dropdown menu */}\n                    {openMenuIndex === index && (\n                      <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 mt-1 w-32 bg-white rounded-md shadow-lg border border-gray-200 py-1 z-50\" style={{\n                        transform: 'translateY(0)',\n                        maxHeight: 'calc(100vh - 100px)',\n                        overflowY: 'auto'\n                      }}>\n                        <button\n                          onClick={(e) => handleMenuAction(e, 'open', image.url, index)}\n                          className=\"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center transition-colors\"\n                        >\n                          <ExternalLink className=\"h-4 w-4 mr-2\" />\n                          <span>Open</span>\n                        </button>\n                        {onRemoveImage && (\n                          <button\n                            onClick={(e) => handleMenuAction(e, 'delete', image.url, index)}\n                            className=\"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center transition-colors\"\n                          >\n                            <Trash2 className=\"h-4 w-4 mr-2\" />\n                            <span>Delete</span>\n                          </button>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Image gallery modal */}\n      {showGallery && (\n        <ImageGallery\n          images={images.map(img => ({\n            url: img.url,\n            alt: img.fileName,\n            isPrimary: false,\n            uploadedAt: new Date(),\n            fileName: img.fileName,\n            size: 0,\n            mimeType: 'image/jpeg'\n          }))}\n          initialIndex={galleryInitialIndex}\n          onClose={handleGalleryClose}\n        />\n      )}\n    </>\n  )\n}\n"],"names":["ImageGallery","images","initialIndex","onClose","currentIndex","setCurrentIndex","useState","isLoaded","setIsLoaded","zoom","setZoom","panX","setPanX","panY","setPanY","isDragging","setIsDragging","dragStart","setDragStart","imageContainerRef","useRef","imageRef","useEffect","handleZoomIn","useCallback","prev","handleZoomOut","newZoom","handleResetZoom","handleKeyDown","e","currentImage","handlePrevious","handleNext","handleWheel","delta","handleMouseDown","handleMouseMove","handleMouseUp","touchStartRef","getTouchDistance","touches","touch1","touch2","getTouchCenter","handleTouchStart","distance","center","handleTouchMove","currentDistance","startDistance","scale","handleTouchEnd","formatFileSize","bytes","k","sizes","i","jsxs","jsx","X","Fragment","ChevronLeft","ChevronRight","ZoomIn","ZoomOut","RotateCcw","error","Download","_","index","ImagePreview","onAddImage","onRemoveImage","onSetPrimary","maxImages","showControls","size","className","showGallery","setShowGallery","galleryInitialIndex","setGalleryInitialIndex","openMenuIndex","setOpenMenuIndex","sizeClasses","handleImageClick","handleGalleryClose","toggleMenu","handleMenuAction","action","imageUrl","handleClickOutside","image","Crown","ChevronDown","ExternalLink","Star","Trash2","Plus","TransactionImagePreview","onImageClick","img"],"mappings":"6KAUA,SAAwBA,EAAa,CAAE,OAAAC,EAAQ,aAAAC,EAAe,EAAG,QAAAC,GAA8B,CAC7F,KAAM,CAACC,EAAcC,CAAe,EAAIC,EAAAA,SAASJ,CAAY,EACvD,CAACK,EAAUC,CAAW,EAAIF,EAAAA,SAAS,EAAK,EACxC,CAACG,EAAMC,CAAO,EAAIJ,EAAAA,SAAS,CAAC,EAC5B,CAACK,EAAMC,CAAO,EAAIN,EAAAA,SAAS,CAAC,EAC5B,CAACO,EAAMC,CAAO,EAAIR,EAAAA,SAAS,CAAC,EAC5B,CAACS,EAAYC,CAAa,EAAIV,EAAAA,SAAS,EAAK,EAC5C,CAACW,EAAWC,CAAY,EAAIZ,EAAAA,SAAS,CAAE,EAAG,EAAG,EAAG,EAAG,EACnDa,EAAoBC,EAAAA,OAAuB,IAAI,EAC/CC,EAAWD,EAAAA,OAAyB,IAAI,EAG9CE,EAAAA,UAAU,IAAM,CACdZ,EAAQ,CAAC,EACTE,EAAQ,CAAC,EACTE,EAAQ,CAAC,CACX,EAAG,CAACV,CAAY,CAAC,EAEjB,MAAMmB,EAAeC,EAAAA,YAAY,IAAM,CACrCd,KAAgB,KAAK,IAAIe,EAAO,GAAK,CAAC,CAAC,CACzC,EAAG,CAAA,CAAE,EAECC,EAAgBF,EAAAA,YAAY,IAAM,CACtCd,EAAQe,GAAQ,CACd,MAAME,EAAU,KAAK,IAAIF,EAAO,GAAK,CAAC,EACtC,OAAIE,IAAY,IACdf,EAAQ,CAAC,EACTE,EAAQ,CAAC,GAEJa,CACT,CAAC,CACH,EAAG,CAAA,CAAE,EAECC,EAAkBJ,EAAAA,YAAY,IAAM,CACxCd,EAAQ,CAAC,EACTE,EAAQ,CAAC,EACTE,EAAQ,CAAC,CACX,EAAG,CAAA,CAAE,EAGLQ,EAAAA,UAAU,IAAM,CACd,MAAMO,EAAiBC,GAAqB,CAE1C,GAAIrB,EAAO,EACT,OAAQqB,EAAE,IAAA,CACR,IAAK,YACHA,EAAE,eAAA,EACFlB,KAAgB,KAAK,IAAI,EAAGa,EAAO,EAAE,CAAC,EACtC,OACF,IAAK,aACHK,EAAE,eAAA,EACFlB,KAAgB,KAAK,IAAI,EAAGa,EAAO,EAAE,CAAC,EACtC,OACF,IAAK,UACHK,EAAE,eAAA,EACFhB,KAAgB,KAAK,IAAI,EAAGW,EAAO,EAAE,CAAC,EACtC,OACF,IAAK,YACHK,EAAE,eAAA,EACFhB,KAAgB,KAAK,IAAI,EAAGW,EAAO,EAAE,CAAC,EACtC,MAAA,CAIN,OAAQK,EAAE,IAAA,CACR,IAAK,SACCrB,EAAO,EAETmB,EAAA,EAEAzB,EAAA,EAEF,MACF,IAAK,YACH2B,EAAE,eAAA,EACFzB,KAAyBoB,EAAO,EAAIA,EAAO,EAAIxB,EAAO,OAAS,CAAE,EACjE,MACF,IAAK,aACH6B,EAAE,eAAA,EACFzB,KAAyBoB,EAAOxB,EAAO,OAAS,EAAIwB,EAAO,EAAI,CAAE,EACjE,MACF,IAAK,IACL,IAAK,IACHK,EAAE,eAAA,EACFP,EAAA,EACA,MACF,IAAK,IACL,IAAK,IACHO,EAAE,eAAA,EACFJ,EAAA,EACA,MACF,IAAK,IACHI,EAAE,eAAA,EACFF,EAAA,EACA,KAAA,CAEN,EAEA,gBAAS,iBAAiB,UAAWC,CAAa,EAC3C,IAAM,SAAS,oBAAoB,UAAWA,CAAa,CACpE,EAAG,CAAC1B,EAASF,EAAO,OAAQQ,EAAMc,EAAcG,EAAeE,CAAe,CAAC,EAG/EN,EAAAA,UAAU,KACR,SAAS,KAAK,MAAM,SAAW,SACxB,IAAM,CACX,SAAS,KAAK,MAAM,SAAW,OACjC,GACC,CAAA,CAAE,EAEL,MAAMS,EAAe9B,EAAOG,CAAY,EAElC4B,EAAiB,IAAM,CAC3B3B,KAAyBoB,EAAO,EAAIA,EAAO,EAAIxB,EAAO,OAAS,CAAE,EACjEO,EAAY,EAAK,CACnB,EAEMyB,EAAa,IAAM,CACvB5B,KAAyBoB,EAAOxB,EAAO,OAAS,EAAIwB,EAAO,EAAI,CAAE,EACjEjB,EAAY,EAAK,CACnB,EAEM0B,EAAeJ,GAAwB,CAC3CA,EAAE,eAAA,EACF,MAAMK,EAAQL,EAAE,OAAS,EAAI,IAAO,GAC9BH,EAAU,KAAK,IAAI,EAAG,KAAK,IAAI,EAAGlB,EAAO0B,CAAK,CAAC,EACrDzB,EAAQiB,CAAO,EACXA,IAAY,IACdf,EAAQ,CAAC,EACTE,EAAQ,CAAC,EAEb,EAEMsB,EAAmBN,GAAwB,CAC3CrB,EAAO,IACTO,EAAc,EAAI,EAClBE,EAAa,CAAE,EAAGY,EAAE,QAAUnB,EAAM,EAAGmB,EAAE,QAAUjB,EAAM,EAE7D,EAEMwB,EAAmBP,GAAwB,CAC3Cf,GAAcN,EAAO,IACvBG,EAAQkB,EAAE,QAAUb,EAAU,CAAC,EAC/BH,EAAQgB,EAAE,QAAUb,EAAU,CAAC,EAEnC,EAEMqB,EAAgB,IAAM,CAC1BtB,EAAc,EAAK,CACrB,EAGMuB,EAAgBnB,EAAAA,OAAsE,IAAI,EAE1FoB,EAAoBC,GAAqC,CAC7D,MAAMC,EAASD,EAAQ,CAAC,EAClBE,EAASF,EAAQ,CAAC,EACxB,OAAO,KAAK,MAAME,EAAO,QAAUD,EAAO,QAASC,EAAO,QAAUD,EAAO,OAAO,CACpF,EAEME,EAAkBH,GAAuD,CAC7E,MAAMC,EAASD,EAAQ,CAAC,EAClBE,EAASF,EAAQ,CAAC,EACxB,MAAO,CACL,GAAIC,EAAO,QAAUC,EAAO,SAAW,EACvC,GAAID,EAAO,QAAUC,EAAO,SAAW,CAAA,CAE3C,EAEME,EAAoBf,GAAwB,CAChD,GAAIA,EAAE,QAAQ,SAAW,EAAG,CAC1B,MAAMgB,EAAWN,EAAiBV,EAAE,OAAO,EACrCiB,EAASH,EAAed,EAAE,OAAO,EACvCS,EAAc,QAAU,CAAE,SAAAO,EAAU,QAASC,EAAO,EAAG,QAASA,EAAO,CAAA,CACzE,MAAWjB,EAAE,QAAQ,SAAW,GAAKrB,EAAO,IAC1CO,EAAc,EAAI,EAClBE,EAAa,CAAE,EAAGY,EAAE,QAAQ,CAAC,EAAE,QAAUnB,EAAM,EAAGmB,EAAE,QAAQ,CAAC,EAAE,QAAUjB,EAAM,EAEnF,EAEMmC,EAAmBlB,GAAwB,CAC/C,GAAIA,EAAE,QAAQ,SAAW,GAAKS,EAAc,QAAS,CACnDT,EAAE,eAAA,EACF,MAAMmB,EAAkBT,EAAiBV,EAAE,OAAO,EAC5CoB,EAAgBX,EAAc,QAAQ,SACtCY,EAAQF,EAAkBC,EAC1BvB,EAAU,KAAK,IAAI,EAAG,KAAK,IAAI,EAAGlB,EAAO0C,CAAK,CAAC,EACrDzC,EAAQiB,CAAO,EACXA,IAAY,IACdf,EAAQ,CAAC,EACTE,EAAQ,CAAC,EAEb,MAAWgB,EAAE,QAAQ,SAAW,GAAKf,GAAcN,EAAO,IACxDqB,EAAE,eAAA,EACFlB,EAAQkB,EAAE,QAAQ,CAAC,EAAE,QAAUb,EAAU,CAAC,EAC1CH,EAAQgB,EAAE,QAAQ,CAAC,EAAE,QAAUb,EAAU,CAAC,EAE9C,EAEMmC,EAAiB,IAAM,CAC3Bb,EAAc,QAAU,KACxBvB,EAAc,EAAK,CACrB,EAEMqC,EAAkBC,GAA0B,CAChD,GAAIA,IAAU,EAAG,MAAO,UACxB,MAAMC,EAAI,KACJC,EAAQ,CAAC,QAAS,KAAM,KAAM,IAAI,EAClCC,EAAI,KAAK,MAAM,KAAK,IAAIH,CAAK,EAAI,KAAK,IAAIC,CAAC,CAAC,EAClD,OAAQD,EAAQ,KAAK,IAAIC,EAAGE,CAAC,GAAG,eAAe,QAAS,CAAE,sBAAuB,EAAG,sBAAuB,CAAA,CAAG,EAAI,IAAMD,EAAMC,CAAC,CACjI,EAEA,OACEC,EAAAA,KAAC,MAAA,CAAI,UAAU,iFAEb,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACC,QAASxD,EACT,UAAU,mFACV,aAAW,gBAEX,SAAAwD,EAAAA,IAACC,EAAA,CAAE,UAAU,SAAA,CAAU,CAAA,CAAA,EAIxB3D,EAAO,OAAS,GACfyD,EAAAA,KAAAG,EAAAA,SAAA,CACE,SAAA,CAAAF,EAAAA,IAAC,SAAA,CACC,QAAS3B,EACT,UAAU,+GACV,aAAW,iBAEX,SAAA2B,EAAAA,IAACG,EAAA,CAAY,UAAU,SAAA,CAAU,CAAA,CAAA,EAEnCH,EAAAA,IAAC,SAAA,CACC,QAAS1B,EACT,UAAU,gHACV,aAAW,aAEX,SAAA0B,EAAAA,IAACI,EAAA,CAAa,UAAU,SAAA,CAAU,CAAA,CAAA,CACpC,EACF,EAIFL,EAAAA,KAAC,MAAA,CAAI,UAAU,iDACb,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACC,QAASpC,EACT,UAAU,sFACV,aAAW,UACX,MAAM,cAEN,SAAAoC,EAAAA,IAACK,EAAA,CAAO,UAAU,SAAA,CAAU,CAAA,CAAA,EAE9BL,EAAAA,IAAC,SAAA,CACC,QAASjC,EACT,SAAUjB,GAAQ,EAClB,UAAU,sIACV,aAAW,WACX,MAAM,eAEN,SAAAkD,EAAAA,IAACM,EAAA,CAAQ,UAAU,SAAA,CAAU,CAAA,CAAA,EAE9BxD,EAAO,GACNkD,EAAAA,IAAC,SAAA,CACC,QAAS/B,EACT,UAAU,sFACV,aAAW,aACX,MAAM,iBAEN,SAAA+B,EAAAA,IAACO,EAAA,CAAU,UAAU,SAAA,CAAU,CAAA,CAAA,CACjC,EAEJ,EAGAR,EAAAA,KAAC,MAAA,CACC,IAAKvC,EACL,UAAU,6GACV,QAASe,EACT,YAAaE,EACb,YAAaC,EACb,UAAWC,EACX,aAAcA,EACd,aAAcO,EACd,YAAaG,EACb,WAAYI,EAEZ,SAAA,CAAAO,EAAAA,IAAC,MAAA,CACC,IAAKtC,EACL,IAAKU,EAAa,IAClB,IAAKA,EAAa,KAAOA,EAAa,SACtC,UAAU,mDACV,OAAQ,IAAMvB,EAAY,EAAI,EAC9B,MAAO,CACL,QAASD,EAAW,EAAI,EACxB,WAAYE,IAAS,EAAI,oBAAsB,OAC/C,UAAW,SAASA,CAAI,eAAeE,EAAOF,CAAI,OAAOI,EAAOJ,CAAI,MACpE,OAAQA,EAAO,EAAI,OAAS,SAAA,EAE9B,UAAW,EAAA,CAAA,EAIZ,CAACF,GACAoD,EAAAA,IAAC,MAAA,CAAI,UAAU,oDACb,SAAAA,EAAAA,IAAC,MAAA,CAAI,UAAU,6DAAA,CAA8D,CAAA,CAC/E,CAAA,CAAA,CAAA,QAKH,MAAA,CAAI,UAAU,yEACb,SAAAD,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,SACb,SAAA,CAAAC,MAAC,MAAG,UAAU,+BACX,SAAA5B,EAAa,KAAOA,EAAa,SACpC,EACCA,EAAa,SACZ4B,EAAAA,IAAC,KAAE,UAAU,6BAA8B,WAAa,QAAQ,EAElED,EAAAA,KAAC,MAAA,CAAI,UAAU,yDACb,SAAA,CAAAA,OAAC,OAAA,CAAM,SAAA,CAAAtD,EAAe,EAAE,OAAKH,EAAO,MAAA,EAAO,EAC3C0D,EAAAA,IAAC,OAAA,CAAM,SAAAN,EAAetB,EAAa,IAAI,EAAE,EACzC4B,EAAAA,IAAC,QACG,UAAA,IAAM,CACN,GAAI,CACF,OAAO,IAAI,KAAK5B,EAAa,UAAU,EAAE,mBAAA,CAC3C,OAASoC,EAAO,CACd,eAAQ,KAAK,0BAA2BpC,EAAa,WAAYoC,CAAK,EAC/D,cACT,CACF,IAAG,CACL,CAAA,CAAA,CACF,CAAA,EACF,EAGAR,EAAAA,IAAC,SAAA,CACC,QAAS,IAAM,OAAO,KAAK5B,EAAa,IAAK,QAAQ,EACrD,UAAU,4DACV,aAAW,iBAEX,SAAA4B,EAAAA,IAACS,GAAA,CAAS,UAAU,SAAA,CAAU,CAAA,CAAA,CAChC,CAAA,CACF,CAAA,CACF,EAGCnE,EAAO,OAAS,GACf0D,EAAAA,IAAC,MAAA,CAAI,UAAU,wEACZ,SAAA1D,EAAO,IAAI,CAACoE,EAAGC,IACdX,EAAAA,IAAC,SAAA,CAEC,QAAS,IAAM,CACbtD,EAAgBiE,CAAK,EACrB9D,EAAY,EAAK,CACnB,EACA,UAAW,0CACT8D,IAAUlE,EAAe,WAAa,wBACxC,GACA,aAAY,eAAekE,EAAQ,CAAC,EAAA,EAR/BA,CAAA,CAUR,CAAA,CACH,CAAA,EAEJ,CAEJ,CC/VA,SAAwBC,GAAa,CACnC,OAAAtE,EACA,WAAAuE,EACA,cAAAC,EACA,aAAAC,EACA,UAAAC,EAAY,EACZ,aAAAC,EAAe,GACf,KAAAC,EAAO,KACP,UAAAC,EAAY,EACd,EAAsB,CACpB,KAAM,CAACC,EAAaC,CAAc,EAAI1E,EAAAA,SAAS,EAAK,EAC9C,CAAC2E,EAAqBC,CAAsB,EAAI5E,EAAAA,SAAS,CAAC,EAC1D,CAAC6E,EAAeC,CAAgB,EAAI9E,EAAAA,SAAwB,IAAI,EAEhE+E,EAAc,CAClB,GAAI,4BACJ,GAAI,4BACJ,GAAI,2BAAA,EAGAC,EAAoBhB,GAAkB,CAC1CY,EAAuBZ,CAAK,EAC5BU,EAAe,EAAI,CACrB,EAEMO,EAAqB,IAAM,CAC/BP,EAAe,EAAK,CACtB,EAGMQ,EAAa,CAAC1D,EAAqBwC,IAAkB,CACzDxC,EAAE,gBAAA,EACFsD,EAAiBD,IAAkBb,EAAQ,KAAOA,CAAK,CACzD,EAEMmB,EAAmB,CAAC3D,EAAqB4D,EAAgBC,EAAkBrB,IAAkB,CAIjG,OAHAxC,EAAE,gBAAA,EACFsD,EAAiB,IAAI,EAEbM,EAAA,CACN,IAAK,OACHJ,EAAiBhB,CAAK,EACtB,MACF,IAAK,aACHI,GAAA,MAAAA,EAAeiB,GACf,MACF,IAAK,SACHlB,GAAA,MAAAA,EAAgBkB,GAChB,KAAA,CAEN,EAcA,OAXArE,EAAAA,UAAU,IAAM,CACd,MAAMsE,EAAsB9D,GAAkB,CACxCqD,IAAkB,MAAQ,CAAErD,EAAE,OAAmB,QAAQ,uBAAuB,GAClFsD,EAAiB,IAAI,CAEzB,EAEA,gBAAS,iBAAiB,QAASQ,CAAkB,EAC9C,IAAM,SAAS,oBAAoB,QAASA,CAAkB,CACvE,EAAG,CAACT,CAAa,CAAC,EAEdlF,EAAO,SAAW,GAAK,CAACuE,EACnB,KAIPd,EAAAA,KAAAG,WAAA,CACE,SAAA,CAAAH,EAAAA,KAAC,MAAA,CAAI,UAAW,aAAaoB,CAAS,GAEnC,SAAA,CAAA7E,EAAO,OAAS,GACfyD,EAAAA,KAAC,MAAA,CAAI,UAAU,wFAAwF,MAAO,CAAC,MAAO,aAAA,EACnH,SAAA,CAAAzD,EAAO,IAAI,CAAC4F,EAAOvB,IAClBZ,EAAAA,KAAC,MAAA,CAEC,UAAW,GAAG2B,EAAYR,CAAI,CAAC,uEAC7BgB,EAAM,UAAY,6CAA+C,iBACnE,GACA,QAAS,IAAMP,EAAiBhB,CAAK,EAErC,SAAA,CAAAX,EAAAA,IAAC,MAAA,CACC,IAAKkC,EAAM,IACX,IAAKA,EAAM,KAAOA,EAAM,SACxB,UAAU,uEAAA,CAAA,EAIXA,EAAM,WACLlC,EAAAA,IAAC,MAAA,CAAI,UAAU,yIACb,SAAAA,EAAAA,IAACmC,GAAA,CAAM,UAAU,sBAAA,CAAuB,CAAA,CAC1C,EAIDlB,SACE,MAAA,CAAI,UAAU,8DAEb,SAAAlB,EAAAA,KAAC,MAAA,CAAI,UAAU,8CACb,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACC,QAAU7B,GAAM0D,EAAW1D,EAAGwC,CAAK,EACnC,UAAU,6JACV,MAAM,gBAEN,SAAAX,EAAAA,IAACoC,EAAA,CAAY,UAAU,SAAA,CAAU,CAAA,CAAA,EAIlCZ,IAAkBb,GACjBZ,OAAC,MAAA,CAAI,UAAU,iIAAiI,MAAO,CACrJ,UAAW,gBACX,UAAW,sBACX,UAAW,MAAA,EAEX,SAAA,CAAAA,EAAAA,KAAC,SAAA,CACC,QAAU5B,GAAM2D,EAAiB3D,EAAG,OAAQ+D,EAAM,IAAKvB,CAAK,EAC5D,UAAU,yGAEV,SAAA,CAAAX,EAAAA,IAACqC,EAAA,CAAa,UAAU,cAAA,CAAe,EACvCrC,EAAAA,IAAC,QAAK,SAAA,MAAA,CAAI,CAAA,CAAA,CAAA,EAEX,CAACkC,EAAM,WAAanB,GACnBhB,EAAAA,KAAC,SAAA,CACC,QAAU5B,GAAM2D,EAAiB3D,EAAG,aAAc+D,EAAM,IAAKvB,CAAK,EAClE,UAAU,yGAEV,SAAA,CAAAX,EAAAA,IAACsC,GAAA,CAAK,UAAU,cAAA,CAAe,EAC/BtC,EAAAA,IAAC,QAAK,SAAA,SAAA,CAAO,CAAA,CAAA,CAAA,EAGhBc,GACCf,EAAAA,KAAC,SAAA,CACC,QAAU5B,GAAM2D,EAAiB3D,EAAG,SAAU+D,EAAM,IAAKvB,CAAK,EAC9D,UAAU,sGAEV,SAAA,CAAAX,EAAAA,IAACuC,EAAA,CAAO,UAAU,cAAA,CAAe,EACjCvC,EAAAA,IAAC,QAAK,SAAA,QAAA,CAAM,CAAA,CAAA,CAAA,CACd,CAAA,CAEJ,CAAA,CAAA,CAEJ,CAAA,CACF,CAAA,CAAA,EAnEGkC,EAAM,GAAA,CAuEd,EAGArB,GAAcvE,EAAO,OAAS0E,GAC7BhB,EAAAA,IAAC,SAAA,CACC,QAASa,EACT,UAAW,GAAGa,EAAYR,CAAI,CAAC,gKAC/B,MAAM,YAEN,SAAAlB,EAAAA,IAACwC,EAAA,CAAK,UAAU,SAAA,CAAU,CAAA,CAAA,CAC5B,EAEJ,EAID,CAAClG,EAAO,QAAUuE,GACjBb,EAAAA,IAAC,SAAA,CACC,QAASa,EACT,UAAW,GAAGa,EAAYR,CAAI,CAAC,uKAC/B,MAAM,YAEN,SAAAlB,EAAAA,IAACwC,EAAA,CAAK,UAAU,SAAA,CAAU,CAAA,CAAA,EAK7BlG,EAAO,OAAS,GACfyD,EAAAA,KAAC,IAAA,CAAE,UAAU,wBACV,SAAA,CAAAzD,EAAO,OAAO,SAAOA,EAAO,SAAW,EAAI,IAAM,GACjD0E,GAAa,SAASA,CAAS,GAAA,CAAA,CAClC,CAAA,EAEJ,EAGCI,GACCpB,EAAAA,IAAC3D,EAAA,CACC,OAAAC,EACA,aAAcgF,EACd,QAASM,CAAA,CAAA,CACX,EAEJ,CAEJ,CAIO,SAASa,GAAwB,CACtC,OAAAnG,EACA,cAAAwE,EACA,aAAAG,EAAe,GACf,KAAAC,EAAO,KACP,UAAAC,EAAY,GACZ,aAAAuB,CACF,EAAiC,CAC/B,KAAM,CAACtB,EAAaC,CAAc,EAAI1E,EAAAA,SAAS,EAAK,EAC9C,CAAC2E,EAAqBC,CAAsB,EAAI5E,EAAAA,SAAS,CAAC,EAC1D,CAAC6E,EAAeC,CAAgB,EAAI9E,EAAAA,SAAwB,IAAI,EAEhE+E,EAAc,CAClB,GAAI,4BACJ,GAAI,4BACJ,GAAI,2BAAA,EAGAC,EAAoBhB,GAAkB,CACtC+B,EACFA,EAAa/B,CAAK,GAElBY,EAAuBZ,CAAK,EAC5BU,EAAe,EAAI,EAEvB,EAEMO,EAAqB,IAAM,CAC/BP,EAAe,EAAK,CACtB,EAEMQ,EAAa,CAAC1D,EAAqBwC,IAAkB,CACzDxC,EAAE,gBAAA,EACFsD,EAAiBD,IAAkBb,EAAQ,KAAOA,CAAK,CACzD,EAEMmB,EAAmB,CAAC3D,EAAqB4D,EAAgBC,EAAkBrB,IAAkB,CAIjG,OAHAxC,EAAE,gBAAA,EACFsD,EAAiB,IAAI,EAEbM,EAAA,CACN,IAAK,OACHJ,EAAiBhB,CAAK,EACtB,MACF,IAAK,SACHG,GAAA,MAAAA,EAAgBkB,GAChB,KAAA,CAEN,EAcA,OAXArE,EAAAA,UAAU,IAAM,CACd,MAAMsE,EAAsB9D,GAAkB,CACxCqD,IAAkB,MAAQ,CAAErD,EAAE,OAAmB,QAAQ,uBAAuB,GAClFsD,EAAiB,IAAI,CAEzB,EAEA,gBAAS,iBAAiB,QAASQ,CAAkB,EAC9C,IAAM,SAAS,oBAAoB,QAASA,CAAkB,CACvE,EAAG,CAACT,CAAa,CAAC,EAEdlF,EAAO,SAAW,EACb,KAIPyD,EAAAA,KAAAG,WAAA,CACE,SAAA,CAAAF,EAAAA,IAAC,OAAI,UAAW,aAAamB,CAAS,GAEpC,SAAAnB,MAAC,OAAI,UAAU,wFAAwF,MAAO,CAAC,MAAO,eACnH,WAAO,IAAI,CAACkC,EAAOvB,IAClBZ,EAAAA,KAAC,MAAA,CAEC,UAAW,GAAG2B,EAAYR,CAAI,CAAC,sFAC/B,QAAS,IAAMS,EAAiBhB,CAAK,EAErC,SAAA,CAAAX,EAAAA,IAAC,MAAA,CACC,IAAKkC,EAAM,IACX,IAAKA,EAAM,SACX,UAAU,uEAAA,CAAA,EAIXjB,SACE,MAAA,CAAI,UAAU,8DAEb,SAAAlB,EAAAA,KAAC,MAAA,CAAI,UAAU,8CACb,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACC,QAAU7B,GAAM0D,EAAW1D,EAAGwC,CAAK,EACnC,UAAU,6JACV,MAAM,gBAEN,SAAAX,EAAAA,IAACoC,EAAA,CAAY,UAAU,SAAA,CAAU,CAAA,CAAA,EAIlCZ,IAAkBb,GACjBZ,OAAC,MAAA,CAAI,UAAU,iIAAiI,MAAO,CACrJ,UAAW,gBACX,UAAW,sBACX,UAAW,MAAA,EAEX,SAAA,CAAAA,EAAAA,KAAC,SAAA,CACC,QAAU5B,GAAM2D,EAAiB3D,EAAG,OAAQ+D,EAAM,IAAKvB,CAAK,EAC5D,UAAU,yGAEV,SAAA,CAAAX,EAAAA,IAACqC,EAAA,CAAa,UAAU,cAAA,CAAe,EACvCrC,EAAAA,IAAC,QAAK,SAAA,MAAA,CAAI,CAAA,CAAA,CAAA,EAEXc,GACCf,EAAAA,KAAC,SAAA,CACC,QAAU5B,GAAM2D,EAAiB3D,EAAG,SAAU+D,EAAM,IAAKvB,CAAK,EAC9D,UAAU,sGAEV,SAAA,CAAAX,EAAAA,IAACuC,EAAA,CAAO,UAAU,cAAA,CAAe,EACjCvC,EAAAA,IAAC,QAAK,SAAA,QAAA,CAAM,CAAA,CAAA,CAAA,CACd,CAAA,CAEJ,CAAA,CAAA,CAEJ,CAAA,CACF,CAAA,CAAA,EAjDGkC,EAAM,GAAA,CAoDd,EACH,CAAA,CACF,EAGCd,GACCpB,EAAAA,IAAC3D,EAAA,CACC,OAAQC,EAAO,IAAIqG,IAAQ,CACzB,IAAKA,EAAI,IACT,IAAKA,EAAI,SACT,UAAW,GACX,eAAgB,KAChB,SAAUA,EAAI,SACd,KAAM,EACN,SAAU,YAAA,EACV,EACF,aAAcrB,EACd,QAASM,CAAA,CAAA,CACX,EAEJ,CAEJ"}